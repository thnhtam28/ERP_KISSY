@using Erp.BackOffice.App_GlobalResources
@using Erp.BackOffice.Helpers
@using Erp.BackOffice.Areas.Administration.Models
@using Erp.BackOffice.Staff.Models
@{
    Layout = null;
    IEnumerable<SelectListItem> GroupPrice = Erp.BackOffice.Helpers.SelectListHelper.GetSelectList_Category("GroupPrice", null,null);
}
<style>
    .box {
        padding-top: 0px !important;
        padding-bottom: 0px !important;
        margin-top: 0px !important;
    }
</style>

<div id="GroupPrice" class="widget-box widget-color-blue" style="opacity: 1;">
    <div class="widget-header">
        <h5 class="widget-title bigger lighter" style="color:white;">
            <i class="ace-icon fa fa-list"></i> Nhóm giá
        </h5>

        <div class="widget-toolbar">
            <a href="#" data-action="collapse">
                <i class="ace-icon fa fa-chevron-up"></i>
            </a>
        </div>

    </div>
    <div class="widget-body">
        <div class="widget-main clearfix">
            <div class="box box-height-max">
                @*<h4><span>Chọn nhà thuốc quản lý:</span></h4>*@

                <div class="product-cate">
                    @*<div class="widget-box">
                        <div class="widget-header">
                            <h5 class="widget-title">
                                <i class="ace-icon fa fa-search"></i> Tìm kiếm
                            </h5>

                            <div class="widget-toolbar">
                                <a href="#" data-action="collapse">
                                    <i class="ace-icon fa fa-chevron-up"></i>
                                </a>
                            </div>

                        </div>
                        <div class="widget-body">
                            <div class="widget-main clearfix">
                                <div class="category-content search-view">
                                    <p>
                                        <select id="productCategory">
                                          @foreach (var cate in ProvinceList)
                                          {
                                            <option value="@cate.Value">@cate.Text</option>
                                            }
                                        </select>
                                        <select id="District_Id">
                                            <option value="">@Wording.District</option>
                                        </select>

                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>*@
                    <div class="products-by-cate clearfix">
                        @{ var listDepartmentNoneChoose = GroupPrice.Where(x => ("," + ViewData["GroupPrice"] + ",").Contains("," + x.Text + ",") == false).OrderBy(x => x.Text).ToList(); }
                        @for (int i = 0; i < listDepartmentNoneChoose.Count; i++)
                        {
                        <label class="product-item">
                            <i class="fa fa-plus"></i>
                            <input type="checkbox" name="GroupPrice" class="" value="@listDepartmentNoneChoose[i].Text" />
                            <span class="">@listDepartmentNoneChoose[i].Text (@Common.PhanCachHangNgan2(listDepartmentNoneChoose[i].Value))</span>
                        </label>
                        }
                    </div>
                </div>
            </div>
            <div class="box box-height-max" style="margin-top:10px">
                <h4><span>Danh sách nhóm giá:</span></h4>
                <div class="product-chosen">
                    @{ var listDepartmentChoose = GroupPrice.Where(x => ("," + ViewData["GroupPrice"] + ",").Contains("," + x.Text + ",") == true).OrderBy(x => x.Text).ToList(); }
                    @for (int i = 0; i < listDepartmentChoose.Count; i++)
                    {
                    <label class="product-item">
                        <i class="fa fa-minus"></i>
                        <input checked type="checkbox" name="GroupPrice" class="" value="@listDepartmentChoose[i].Text" />
                        <span class="">@listDepartmentChoose[i].Text (@Common.PhanCachHangNgan2(listDepartmentChoose[i].Value))</span>
                    </label>
                    }
                </div>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">
        $(document).ready(function () {
            //$('#productCategory').change(function () {
            //    SearchDrugStore();
            //});

            $('#GroupPrice .product-item input').change(function () {
                var $this = $(this);
                $parent = $this.closest('label');

                if ($parent.find('i.fa-plus').length > 0) { //thêm
                    $parent.find('input').prop('checked', true);
                    $parent.find('i').removeClass('fa-plus').addClass('fa-minus');

                    $parent.prependTo('.product-chosen');
                    console.log('.product-chosen');
                } else { // xóa
                    $parent.find('input').prop('checked', false);
                    $parent.find('i').removeClass('fa-minus').addClass('fa-plus');

                    if ($('#productCategory').val() != $parent.data('category'))
                        $parent.hide();

                    $parent.prependTo('.products-by-cate');
                    console.log('.products-by-cate');
                }
            });

            //$('.accordion-section-content').hide();
            $('.accordion-section-title').click(function () {
                var $i = $(this).find('i');
                if ($i.hasClass('fa-angle-double-right')) {
                    $i.removeClass('fa-angle-double-right').addClass('fa-angle-double-down');
                } else {
                    $i.removeClass('fa-angle-double-down').addClass('fa-angle-double-right');
                }

                var $nextDiv = $(this).next();
                var $visibleSiblings = $nextDiv.siblings('div:visible');

                if ($visibleSiblings.length) {
                    $visibleSiblings.slideUp('fast', function () {
                        $nextDiv.slideToggle('fast');
                    });
                } else {
                    $nextDiv.slideToggle('fast');
                }
            });

            setTimeout(function () {
                //$('.accordion-section:first-child .accordion-section-title').trigger('click');
            }, 500);
        });
     
</script>
