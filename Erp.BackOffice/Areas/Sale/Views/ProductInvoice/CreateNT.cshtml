@using Erp.BackOffice.App_GlobalResources
@using Erp.BackOffice.Helpers
@using Erp.BackOffice.Sale.Models
@using Erp.BackOffice.Account.Models

@model ProductInvoiceViewModel

@{

    var isallow_edit_price_POS = Erp.BackOffice.Helpers.Common.GetSetting("isallow_edit_price_POS");
    var serializer = new System.Web.Script.Serialization.JavaScriptSerializer();
    if (Model.Id > 0)
    {
        ViewBag.Title = Wording.PageEdit_ProductInvoice;
    }
    else
    {
        ViewBag.Title = Wording.PageCreate_ProductInvoice;
    }

    Layout = "~/Views/Shared/_LayoutPos.cshtml";

    IEnumerable<SelectListItem> categoryList = (IEnumerable<SelectListItem>)ViewBag.categoryList;

    Erp.BackOffice.Models.PageSetting pageSetting = new Erp.BackOffice.Models.PageSetting
    {
        ModuleName = "ProductInvoice",
        ActionName = "CreateNT",
        PageTitle = ViewBag.Title,
        DisplaySearchPanel = false,
        IsPopup = false,
        DisplayBackButton = true
    };
    List<InventoryViewModel> productList = (List<InventoryViewModel>)ViewBag.productList;
    //IEnumerable<SelectListItem> drugStoreList = Erp.BackOffice.Helpers.SelectListHelper.GetSelectList_DepartmentAllNew(null, Wording.Empty);
    var setting = Erp.BackOffice.Helpers.Common.GetSetting("hide_discount_product_invoice");
    var user_type_onl = Erp.BackOffice.Helpers.Common.CurrentUser.UserTypeCode;
    var setting_readonly = Erp.BackOffice.Helpers.Common.GetSetting("readonly_discount_product_invoice");
    var _readonly = ("," + setting_readonly + ",").Contains("," + user_type_onl + ",") == false ? "true" : "false";
    var _hiden = ("," + setting + ",").Contains("," + user_type_onl + ",") == false ? "false" : "true";
    var _disabled = ("," + setting_readonly + ",").Contains("," + user_type_onl + ",") == false ? "disabled" : "";


}
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="~/assets/css/ResponsivePOS.css" />

@section HeadOfPage {
    @Html.ScriptTop_ChosenStyle()
    <style type="text/css">
        .display-table {
            display: table;
        }

            .display-table > div {
                display: table-row;
            }

                .display-table > div > div {
                    display: table-cell;
                    padding: 5px;
                }

        #product_search_control {
            display: inline-block;
            position: relative;
            float: left;
        }

            #product_search_control .result {
                position: absolute;
                width: 300px;
                max-height: 300px;
                overflow-y: scroll;
                background: #fff;
                border: 1px solid #ddd;
                border-top: none;
                display: none;
            }

                #product_search_control .result .item {
                    padding: 2px 5px;
                    border-bottom: 1px solid #ddd;
                    cursor: pointer;
                    display: block;
                    text-decoration: none;
                }

                    #product_search_control .result .item:hover, #product_search_control .result .item.selected {
                        background: #eee;
                        font-weight: bold;
                    }

        #categorySelectList_chosen {
            height: 29px !important;
            float: left;
            width: 250px !important;
        }

            #categorySelectList_chosen .chosen-single {
                width: 100%;
                height: 29px !important;
            }


        .mini-popup {
            position: relative;
            display: inline;
        }

        #popup_archive {
            position: absolute;
            bottom: 34px;
            left: -154px;
            width: 410px;
            height: 235px;
            max-width: inherit;
            top: inherit;
        }

        .formcustomer {
            width: 30%;
            display: inline-block;
            padding: 10px;
            margin: 3px;
            font-weight: 700;
        }

        ul.tabs {
            display: table;
            list-style-type: none;
            margin: 0;
            padding: 0;
        }

            ul.tabs > li {
                float: left;
                padding: 10px;
                background-color: white;
            }

                ul.tabs > li:hover {
                    background-color: lightgray;
                }

        .tabs li.selected {
            border-bottom-color: #FFF;
        }


        div.content {
            border: 1px solid black;
        }

        ul {
            overflow: auto;
        }

        div.content {
            clear: both;
        }


        #TotalAmount1 {
            font-weight: bold;
            background: none !important;
            border: none !important;
            color: #006eaf;
            font-size: 27px;
            text-align: right;
            float: right;
            padding-right: 1.5%;
            outline: none;
        }

        .textPay {
            background-color: #006eaf !important;
            font-size: 20px;
            color: white;
            float: left;
            padding: 0.7% 0% 0% 3%;
            /*height: 100%;*/
            width: 25%;
            cursor: pointer;
            text-align: center;
            padding: 25px 0px;
        }

        #TotalAmount2, #TotalAmount3, #TotalAmount4, #TotalAmount5, #TotalAmount6 {
            color: red !important;
            border: none;
            font-size: 15px !important;
            border-radius: 5px !important;
            width: 210px;
            background-color: #cecece !important;
            text-align: right;
        }

        #TotalAmountTab1, #TotalAmountTab2, #TotalAmountTab3, #TotalAmountTab4, #TotalAmountTab5, #TotalAmountTab6 {
            color: green !important;
            font-weight: bold;
            border: none;
            font-size: 15px !important;
            border-radius: 5px !important;
            width: 72%;
            outline: none;
        }

        #DiscountTab1, #DiscountTab2, #DiscountTab3, #UnitTab1, #UnitTab2, #UnitTab3 {
            border: none;
            border-radius: 5px !important;
            width: 72%;
            outline: none;
        }

            #UnitTab1 input[type="text"] {
                font-size: 10px !important;
                color: green !important;
            }

        #PriceCustomer1, #PriceCustomer2, #PriceCustomer3, #PriceCustomer4, #PriceCustomer5, #PriceCustomer6 {
            text-align: right !important;
            margin-top: 6px;
            font-size: 20px !important;
            border: 1px;
            border-radius: 5px !important;
        }

        input#TotalCustomer1, input#TotalCustomer2, input#TotalCustomer3, input#TotalCustomer4, input#TotalCustomer5, input#TotalCustomer6 {
            margin-top: 5px;
            font-size: 15px !important;
            font-weight: bold;
            color: black;
            border-radius: 5px;
        }

        table, th {
            border: 1px solid #ddd;
            padding: 8px;
            line-height: 1.42857143;
            vertical-align: top;
            border-top: 1px solid #ddd;
            font-weight: normal;
            background-color: #f7f7f7;
        }

            table td {
                padding: 0;
                border: none;
                border-collapse: collapse;
            }


        .classHover {
            border-radius: 5px;
            cursor: pointer;
            text-align: center;
            width: 20% !important;
            color: #0277bd;
            text-decoration: none;
            outline: none !important;
            display: inline-block;
            border-radius: 16px;
            margin-top: 5px;
            padding: 3% 0% 3% 0%;
        }

        .classPlus:hover {
            background: #0277bd;
            color: white !important;
        }

        .classMinus {
            color: #ffc107;
        }

            .classMinus:hover {
                background: #ffc107;
                color: white !important;
            }

        .text_data {
            font-family: Verdana;
            font-size: 12px;
        }

            .text_data:hover {
                cursor: pointer;
                background-color: #e6f5f5;
            }

        .selected_grey {
            background-color: #e4f3e6;
            /*#f39f99*/
        }

        tr.selected td {
            background-color: #333;
            color: #fff;
        }


        .modal {
            display: none; /* Hidden by default */
            position: fixed; /* Stay in place */
            z-index: 1; /* Sit on top */
            padding-top: 5px; /* Location of the box */
            left: 0;
            top: 0;
            width: 100%; /* Full width */
            height: 100%; /* Full height */
            overflow: auto; /* Enable scroll if needed */
            background-color: rgb(0,0,0); /* Fallback color */
            background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
        }

        /* Modal Content */
        .modal-content {
            background-color: #fefefe;
            margin: auto;
            padding: 20px;
            border: 1px solid #888;
        }

        /* The Close Button */
        .close {
            color: #aaaaaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }

            .close:hover,
            .close:focus {
                color: #000;
                text-decoration: none;
                cursor: pointer;
            }
        /*Css button Add Customer btnAdd*/
        .td-btnAdd {
            justify-content: flex-end;
            top: -12%;
            right: -4%;
            position: absolute;
            width: 20%;
            z-index: 4;
        }

        .btnAdd {
            border: none;
            display: inline-block;
            vertical-align: middle;
            overflow: hidden;
            text-decoration: none;
            text-align: center;
            cursor: pointer;
            white-space: nowrap;
            width: 42%;
            height: 77%;
            color: white;
            padding-top: 2px;
            margin-top: 3px;
            margin-right: 50px;
            opacity: 0.6;
            color: #0277bc;
            font-size: 24px;
        }

            .btnAdd:hover {
                color: #66bb6a !important;
                width: 42%;
                height: 77%;
                text-decoration: none !important;
            }

        .rowSearch_Product1 {
            z-index: 2;
            position: fixed;
            top: 80.7%;
            left: 2.6%;
            width: 36%;
            height: 9%;
        }

        .tableCss {
            background-color: whitesmoke;
            position: fixed;
            width: 58.020835%;
            height: 7.5%;
            top: 79.4%;
            left: 0%;
            z-index: 1;
            box-shadow: 1px 0 3px rgba(0,0,0,.24);
        }

        .lineCss {
            border-right: 0.9px solid #ded8d8;
            width: 10%;
            height: 84%;
            position: absolute;
            top: -3%;
            left: 69.3%;
            z-index: 20;
        }

        .lineCss1 {
            border-right: 0.9px solid #ded8d8;
            width: 10%;
            height: 84%;
            position: absolute;
            top: 17%;
            left: 69.3%;
        }
        /*Css View Add Customer {widget-main}*/
        .font-css {
            font-family: initial;
            font-weight: bold;
        }

        #CustomerName1, #CustomerName2, #CustomerName3 {
            font-family: sans-serif;
            width: 228px;
            margin-left: 5px;
            border-radius: 5px !important;
        }

        #CustomerPhone1, #CustomerPhone2, #CustomerPhone3 {
            font-family: sans-serif;
            margin-left: 5px;
            border-radius: 5px !important;
            width: 190px;
        }

        #Address1, #Address2, #Address3 {
            font-family: sans-serif;
            width: 228px;
            margin-top: 5px;
            margin-left: 5px;
            border-radius: 5px !important;
        }

        #Note1, #Note2, #Note3, #Note4, #Note5, #Note6 {
            font-family: sans-serif;
            margin-top: 5px;
            margin-left: 5px;
            border-radius: 5px !important;
            width: 190px;
        }

        .NameCus-Css {
            font-family: initial;
            font-weight: bold;
        }

        .btnCus-Css {
            border-radius: 100px !important;
        }

            .btnCus-Css:hover {
            }

        .Note-Css {
            font-family: initial;
            font-weight: bold;
            padding-left: 10px;
            padding-top: 5px;
        }

        .PhoneNumber-Css {
            padding-left: 10px;
        }

        .Address-Css {
            font-family: initial;
            font-weight: bold;
            padding-top: 5px;
        }
        /*Toggle Cus-Css*/
        .Cus-Css {
            text-align: center !important;
            border-radius: 100px !important;
            margin-top: 5px !important;
            width: 80px !important;
            height: 35px !important;
        }

        .Amount-Css {
            float: left !important;
            font-weight: bold;
            color: orange;
            font-size: 20px;
            padding-top: 10px;
        }

        .Amount1-Css {
            font-weight: bold;
            padding-left: 10px;
            float: left !important;
            color: black;
            font-size: 15px;
            padding-top: 15px !important;
        }

        #TrTab1, #TrTab2, #TrTab3, #TrTab4, #TrTab5, #TrTab6 {
            display: none;
        }

        #TrTab1, #TrTab12 td {
            margin-right: 25px;
            font-size: 15px;
            display: none;
        }

        /*.Tab-none {

            visibility: hidden !important;
        }*/
        /* Css img pagedList*/

        .box-card {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(110px, 1fr));
            grid-gap: 15px;
            margin: 0 auto;
            float: left;
            width: 30%;
            margin: 0% 2% 2% 0%;
        }

        .card {
            position: relative;
            width: 120px !important;
            height: 200px;
            background: #fff;
            margin: 0 auto;
            border-radius: 4px;
            box-shadow: 0px 1px 3px rgba(0,0,0,0.1);
            transition: 0.3s;
            /*box-shadow: 0 2px 10px rgba(0,0,0,.2);*/
        }
            /*.card:before, .card:after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 4px;
            background: #fff;
            transition: 0.5s;
            z-index: -1;
        }*/

            .card:hover {
                /*transform: rotate(10deg);
                box-shadow: 0 2px 20px rgba(0,0,0,.2);*/
                /*background-color: #e8e8e8;*/
                /*box-shadow: 3px 3px 23px rgba(0,0,0,.24) !important;*/
                transform: translateY(-4px);
                box-shadow: -1px 1px 12px 0px rgba(0, 0, 0,0.15);
            }

        .imgBx {
            position: absolute;
            top: 5px;
            left: 5px;
            bottom: 10px;
            background: #222;
            transition: 0.5s;
            z-index: 1;
            bottom: 30px;
        }

        .card:hover .imgBx {
            bottom: 30px;
        }

        .card .imgBx a {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 95%;
            object-fit: cover;
        }

        .card .details-card {
            position: absolute;
            left: 5px;
            right: 5px;
            bottom: 5px;
            height: 67px;
            text-align: center;
        }

        .txtStock {
            padding: 2px;
            height: 3px;
            font-size: 4px;
        }

        .card .details-card p {
            margin-top: 2px;
            padding: 0;
            font-weight: 600;
            font-size: 10px;
            color: #777;
        }

        .widget-body {
            display: none !important;
        }

        .controlPOS-left {
            margin-top: 3px;
        }
        /*Css checkbox toggle trong table*/
        .toggle-button-cover1 {
            display: table-cell;
            width: 20px;
            height: 10px;
            box-sizing: border-box;
            position: relative;
            top: 37%;
            left: 5%;
        }

        .button-cover1 {
            height: 35px;
            box-shadow: 0 10px 20px -8px #c5d6d6;
            border-radius: 4px;
        }

            .button-cover1:before {
                counter-increment: button-counter;
                content: counter(button-counter);
                position: absolute;
                right: 0;
                bottom: 0;
                color: #d7e3e3;
                font-size: 6px;
                line-height: 1;
                padding: 5px;
            }

        .button-cover1 {
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
        }

        .button1 {
            position: relative;
            top: 69%;
            width: 50px;
            height: 26px;
            margin: -20px auto 0 auto;
            overflow: hidden;
        }

            .button1.r, .button1.r {
                border-radius: 100px;
            }

            .button1.b2 {
                border-radius: 2px;
            }

        .button-cover1 {
            height: 35px;
            box-shadow: 0 10px 20px -8px #c5d6d6;
            border-radius: 4px;
        }

            .button-cover1:before {
                counter-increment: button-counter;
                content: counter(button-counter);
                position: absolute;
                right: 0;
                bottom: 0;
                color: #d7e3e3;
                font-size: 6px;
                line-height: 1;
                padding: 5px;
            }

        .button-cover1, .knobs, .layer1 {
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
        }

        .button1.r, .button1.r .layer1 {
            border-radius: 100px;
        }

        .button.b2 {
            border-radius: 2px;
        }

        .checkbox {
            position: relative;
            width: 100%;
            height: 100%;
            padding: 0;
            margin: 0;
            opacity: 0;
            cursor: pointer;
            z-index: 3;
        }

        .knobs {
            z-index: 2;
        }

        .layer1 {
            width: 100%;
            background-color: #fcebeb;
            transition: 0.3s ease all;
            z-index: 1;
        }

        #button-11 .knobs:before {
            content: 'vnđ';
            position: absolute;
            top: 4px;
            left: 4px;
            width: 20px;
            height: 10px;
            color: #fff;
            font-size: 6px;
            font-weight: bold;
            text-align: center;
            line-height: 1;
            padding: 9px 4px;
            border-radius: 50%;
            transition: 0.3s cubic-bezier(0.18, 0.89, 0.35, 1.15) all;
            background-color: #f44336;
        }

        #button-11 .checkbox:checked + .knobs:before {
            content: '%';
            background-color: #03A9F4;
            left: 22px;
        }

        #button-11 .checkbox:checked ~ .layer1 {
            background-color: #ebf7fc;
        }

        #button-11 .knobs, #button-1 .knobs:before, #button-11 .layer1 {
            transition: 0.3s ease all;
        }


        /*End Toggle table*/
        /*Css checkbox toggle*/

        #app-cover {
            display: table;
            width: 600px;
            margin: 80px auto;
            counter-reset: button-counter;
        }


        .toggle-button-cover {
            width: 100px;
            height: 40px;
            box-sizing: border-box;
            position: relative;
            top: 31%;
            left: 0%;
            display: none;
        }

        .button-cover {
            background-color: #fff;
            box-shadow: 0 10px 20px -8px #c5d6d6;
            border-radius: 4px;
            width: 10%;
            height: 10%;
            margin: 6% 0% 0% 5%;
        }

            .button-cover:before {
                counter-increment: button-counter;
                content: counter(button-counter);
                position: absolute;
                right: 0;
                bottom: 0;
                color: #d7e3e3;
                font-size: 8px;
                line-height: 1;
                padding: 5px;
            }

        .button-cover, .knobs, .layer {
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
        }

        .button {
            position: relative;
            top: 50%;
            left: -27%;
            width: 60px;
            height: 29px;
            margin: -20px auto 0 auto;
            overflow: hidden;
        }

            .button.r, .button.r .layer {
                border-radius: 100px;
            }

            .button.b2 {
                border-radius: 2px;
            }

        .checkbox {
            position: relative;
            width: 100%;
            height: 100%;
            padding: 0;
            margin: 0;
            opacity: 0;
            cursor: pointer;
            z-index: 3;
        }

        .knobs {
            z-index: 2;
        }

        .layer {
            width: 100%;
            background-color: #ebf7fc;
            transition: 0.3s ease all;
            z-index: 1;
        }

        #button-1 .knobs:before {
            content: '%';
            position: absolute;
            top: 4px;
            left: 4px;
            width: 21px;
            height: 21px;
            color: #fff;
            font-size: 8px;
            font-weight: bold;
            text-align: center;
            line-height: 1;
            padding: 9px 4px;
            background-color: #03A9F4;
            border-radius: 50%;
            transition: 0.3s cubic-bezier(0.18, 0.89, 0.35, 1.15) all;
        }

        #button-1 .checkbox:checked + .knobs:before {
            content: 'vnđ';
            left: 35px;
            background-color: #f44336;
        }

        #button-1 .checkbox:checked ~ .layer {
            background-color: #fcebeb;
        }

        #button-1 .knobs, #button-1 .knobs:before, #button-1 .layer {
            transition: 0.3s ease all;
        }
        /*End Toggle*/
        .CheckPay {
            display: none;
        }

        /*.PopupPay, #CheckPay1, #CheckPay2 input[type=text] {
            border: none !important;
            border-bottom: 1px solid blue;
        }*/

        .tdTotal {
            width: 72%;
        }

        .tdTotal1 {
            width: 49%;
        }

        /*#TotalPay, #MoneyPay, #TransferPay, #ATMPay, #ChangeMoney, #DiscountAll {
            background-color: black !important;
            border: white;
            height: 30px;
            border-radius: 100px;
            border-radius: 3px;
            padding-left: 3%;
            margin-top: 2%;
            text-align: right;
        }*/

        .btnCheckPay {
            border: none;
            color: #0277bd;
            font-weight: bold;
            font-size: 20px;
            position: relative;
            /*left: %;*/
            background: none;
        }

            .btnCheckPay:hover {
                background-color: aliceblue;
            }

        .hiddenVnd {
            display: none;
        }

        .classHidden {
            display: none;
        }

        .classBlock {
            display: block;
        }

        .detail_item_price_1, .detail_item_price_2,
        .detail_item_price_3, .detail_item_price_4, .detail_item_price_5, .detail_item_price_6 {
            border: none;
            background: none;
            text-align: right;
            padding-top: 8%;
            vertical-align: middle;
            border-radius: 3px !important;
        }

        .numberinput1, .numberinput2 {
            border-radius: 3px !important;
        }

        .btnPay {
            /*background-color: #0277bc !important;*/
            border: none !important;
            border-radius: 0px !important;
            width: 55%;
            left: 0%;
            position: fixed;
            height: 10.6%;
            top: 87%;
        }

        .btnOpenPay {
            border: none;
            background-color: #ffc107 !important;
            border-radius: 0px !important;
            width: 3%;
            left: 55%;
            position: fixed;
            height: 10.6%;
            top: 87%;
            box-shadow: 1px 0 3px rgba(0,0,0,.24);
        }

            .btnOpenPay:hover {
                background-color: #deab10 !important;
            }

        .textPay:hover {
            background-color: #0b659a !important;
        }

        .btnDelBill {
            background-color: #d43f3a !important;
            top: 80.6%;
            border: none;
            border-radius: 5px !important;
            border-color: white;
            position: relative;
            height: 31%;
            left: 151%;
            font-size: 16px;
            z-index: 2;
        }

            .btnDelBill:hover {
                background-color: #bd3935 !important;
            }

        #success-alert, #danger-alert {
            position: fixed;
            top: 5%;
            z-index: 5;
            display: none;
            z-index: 10;
        }

        #success-alert {
            left: 39.2%;
        }

        #danger-alert {
            left: 35%;
            height: 10%;
        }

        #success-alert, #danger-alert2 {
            position: fixed;
            top: 5%;
            z-index: 5;
            display: none;
            z-index: 10;
        }

        #success-alert {
            left: 39.2%;
        }

        #danger-alert2 {
            left: 35%;
            height: 10%;
        }

        #idboxsearch2 {
            border-radius: 3px;
            position: fixed;
            top: 80.5%;
            left: 1.4%;
            width: 27.2%;
        }


        .btnPaged {
            border: none !important;
        }

        .POSleft {
            z-index: 5;
            width: 58%;
            position: fixed;
            top: 0%;
            left: 0%;
            height: 9.5%;
            background-color: #0979bb;
            border-radius: 1px;
        }

        .Return-Product {
            display: block;
        }

        #tabCustomer {
            position: fixed !important;
            top: 9.6% !important;
            left: -1% !important;
            width: 58% !important;
        }


        #rcb_1_RadComboBox {
            position: fixed;
            width: 39.05%;
            top: 8.25% !important;
            left: 0.63%;
            visibility: visible;
            transition: none 0s ease 0s;
            display: block;
            z-index: 5;
            height: 48%;
        }

            #rcb_1_RadComboBox td {
                padding-top: 3% !important;
            }

            #rcb_1_RadComboBox tr:hover {
                color: #006eaf !important;
            }

        .rcbPOS {
            font-family: "Times New Roman", Times, serif;
        }

        #rcb_1_RadComboBox .rcb2POS {
            height: 100% !important;
        }

        #rcb_2_RadComboBox {
            visibility: visible;
            transition: none 0s ease 0s;
            position: fixed;
            width: 29.9%;
            left: 1.5%;
            display: block;
            z-index: 20;
            top: 43% !important;
            height: 37%;
        }

            #rcb_2_RadComboBox td {
                width: 90% !important;
            }

            #rcb_2_RadComboBox .rcb2POS {
                height: 100% !important;
            }
        /*.rcb2POS {
            height: 100% !important;
        }*/
        .rcb2POS td {
            padding-bottom: 1.5% !important;
        }

        .widget-box {
            border: none;
            overflow: scroll;
            height: 58.9%;
            position: fixed;
            top: 23.4%;
            left: 0%;
            width: 57.967%;
            border-left: 0.3px solid #f1f1f1;
            box-shadow: 1px 0 3px rgba(0,0,0,.24);
        }

        .bgPopup {
            background-color: white;
            border-radius: 1.5px;
            box-shadow: 1px 0 3px rgba(0,0,0,.24);
            top: 3%;
            left: 8%;
            width: 84%;
            height: 88%;
            padding: 8% 5% 3% 5%;
            position: relative;
        }

        .widTxt {
            width: 25%;
            text-align: left;
            padding-top: 2%;
            float: left;
            margin-top: 1%;
        }

        .widInput {
            width: 40%;
            text-align: right;
            float: left;
        }

            .widInput input[type=text] {
                padding: unset;
                border: white;
                height: 30px;
                text-align: right;
                border-bottom: 0.5px solid black;
                width: 100%;
            }

        .widControl {
            width: 15%;
            float: left;
            margin: 1.5% 0% 0% 5%;
        }

        .widIcon {
            width: 7%;
            float: left;
            padding-top: 2%;
            margin: 1% 0% 0% 5%;
        }

        #TotalPay {
            color: #0277bc;
            font-weight: bold;
            font-size: 19px;
        }

        #inpBarcode, #idboxsearch1 {
            left: 0.6%;
            width: 39.1% !important;
            height: 6.7%;
            border: none;
            border-radius: 1px;
            position: fixed;
            top: 1.5%;
            box-shadow: 1px 1px 3px rgba(0,0,0,.24) !important;
            padding-left: 1%;
        }

        #idboxsearch1 {
            display: none;
        }

        .btnOrder {
            position: relative;
            left: 5%;
            margin-top: 5%;
        }

        #TotalAmountPay {
            color: green;
            font-weight: bold;
            font-size: 19px;
        }

        #TotalAmountPay, #ChangeMoney, #TotalPay {
            background: white !important;
            border: none;
        }

        #DiscountAll, #MoneyPay, #ChangeMoney {
            font-weight: bold;
        }

        .widRow {
            margin-bottom: 4%;
        }

        #NumberPage {
            height: 30px;
            width: 25%;
            float: left;
            border: none;
            border-bottom: black 0.8px solid;
            text-align: center;
        }

            #NumberPage:hover, #noteHD:hover, #MoneyPay:hover, #DiscountAll:hover, #ATMPay:hover, #TransferPay:hover {
                border-bottom: #0277bc 2px solid;
            }

        #btnCheckBar, #btnCheckKey {
            position: fixed;
            top: 2.3%;
            left: 36.7%;
            z-index: 2;
            width: 3%;
            height: 5.2%;
            border: none;
            font-size: 23px;
            color: black;
            border-radius: 2px;
            font-weight: bold;
            background: none;
        }

        #IdHangTra {
            position: fixed;
            top: 0.7%;
            left: 53.7%;
            z-index: 2;
            height: 8.2%;
            border: none;
            font-size: 23px;
            color: white;
            outline: none;
            border-radius: 2px;
            font-weight: bold;
            background: none;
            width: 4%;
            border-radius: 100%;
        }

            #IdHangTra:hover {
                background-color: #0d6ca5;
            }

        div.modal-full2 {
            width: 100%;
        }

        #btnReturnProduct {
            position: fixed;
            top: 2.3%;
            left: 40.7%;
            z-index: 6;
            width: 3%;
            height: 5.2%;
            border: none;
            font-size: 23px;
            color: black;
            border-radius: 2px;
            font-weight: bold;
            background: none;
        }

        #btnCheckBar:hover, #btnCheckKey:hover {
            color: #0979bb;
        }

        #paged {
            position: fixed;
            top: 90%;
            left: 60%;
        }
        /*classA {
            color: transparent;
        }*/

        #NameTab1, #NameTab2, #NameTab3, #NameTab4, #NameTab5, #NameTab6 {
            width: 5.5%;
            height: 3.4%;
            text-align: center;
            color: black;
            display: none;
            top: 12.6%;
        }

        #TotalProduct1, #TotalProduct2, #TotalProduct3, #TotalProduct4, #TotalProduct5, #TotalProduct6 {
            /*width: 3%;
            height: 1.8%;
            text-align: center;
            border-radius: 100px;
            color: #ffc107;
            background: none !important;
            font-weight: bold;

            font-size: 14px;
            padding: unset;
            margin: unset;
            top: 9%;*/
            width: 5%;
            height: 3.8%;
            text-align: right;
            border-radius: 100px;
            color: #ffc107;
            background: none !important;
            font-weight: bold;
            font-size: 23px;
            padding: unset;
            margin: unset;
            top: 17.6%;
            z-index: 5;
            position: fixed !important;
        }

        #NameTab1, #NameTab2, #NameTab3, #NameTab4, #NameTab5, #NameTab6, #TotalProduct1, #TotalProduct2, #TotalProduct3, #TotalProduct4, #TotalProduct5, #TotalProduct6 {
            position: fixed;
            background: none;
            border: none;
        }

        #TotalProduct1, #TotalProduct2, #TotalProduct3, #TotalProduct4, #TotalProduct5, #TotalProduct6 {
            /*left: 5.7%;*/
            left: 20.7%;
        }

        /*#TotalProduct2 {
            left: 12.1%;
        }

        #TotalProduct3 {
            left: 18.5%;
        }

        #TotalProduct4 {
            left: 24.9%;
        }

        #TotalProduct5 {
            left: 31.3%;
        }

        #TotalProduct6 {
            left: 37.7%;
        }*/

        #NameTab1 {
            left: 1.34%;
        }

        #NameTab2 {
            left: 7.74%;
        }

        #NameTab3 {
            left: 14.1%;
        }

        #NameTab4 {
            left: 20.5%;
        }

        #NameTab5 {
            left: 26.9%;
        }

        #NameTab6 {
            left: 33.3%;
        }

        #PopupDel {
            position: absolute;
            top: 108%;
            left: 57%;
            width: 43%;
            display: none;
            background-color: white;
            border-radius: 5px;
            padding: 4% 0% 4% 5%;
            box-shadow: 1px 1px 3px rgba(0,0,0,.24) !important;
        }

        .PopupDel-content, .PopupDel-container {
            width: 100%;
        }

        .PopupDel-span {
            left: 93%;
            position: absolute;
            top: 0%;
            font-size: 23px;
            cursor: pointer;
        }

        .btnPopupDel1 {
            background-color: #66bb6a !important;
            margin: 3% 3% 0% 13%;
            margin-bottom: 10%;
        }

        .btnPopupDel2 {
            background-color: #e57373 !important;
            margin: 3% 10% 0% 0%;
            margin-bottom: 10%;
        }

        #myModal {
            margin: unset;
            padding: unset;
            width: 100% !important;
            height: 100% !important;
        }

        .Return-Content {
            width: 100% !important;
            height: 100% !important;
            position: relative !important;
            margin: unset;
            padding: 0.8%;
        }

        .Return-Dialog {
            height: 85% !important;
            position: relative !important;
            width: 97% !important;
            padding: 1% 0% 0% 3%;
            height: 96% !important;
            margin: unset !important;
        }

        .Return-Body {
            height: 91% !important;
            position: relative !important;
            width: 100% !important;
        }

        .Return-Iframe {
            height: 100% !important;
        }

        #Return-Toolbar {
            width: 7% !important;
        }

        .Return-text {
            /* position: fixed;
            top: 2%;
            left: 40%;
            color: white;
            margin: unset;
            cursor: pointer;
            width: 80%;
            color: black;
               */
            position: fixed;
            top: 2%;
            left: 40%;
            color: white;
            margin: unset;
            cursor: pointer;
            color: black;
            /* width: 16%; */
            /* text-align: left; */
            font-size: 115%;
        }

        #iconSearch {
            color: #b5b5b5;
            width: 15%;
            float: right;
            text-align: right;
            padding-right: 3%;
            padding-top: 2%;
            cursor: pointer;
        }

        .thPOS {
            margin: unset;
            position: fixed;
            width: 58% !important;
            top: 17%;
            left: 0%;
            height: 6.4% !important;
            box-shadow: 2px -1px 2px 0px rgba(0,0,0,.24);
            z-index: 1;
            background-color: #f7f7f7;
        }

            .thPOS th {
                font-weight: bold;
            }

        select#BRANCH_ID {
            position: relative;
            background-color: white;
            height: 150%;
            width: 80%;
        }
    </style>

}
<div class="alert alert-success" id="success-alert">
    <button type="button" class="close" data-dismiss="alert">x</button>
    <strong>Thành công! </strong>
    Đơn hàng đã được tạo.
</div>

<div class="alert alert-danger" id="danger-alert">
    @*<button type="button" class="close" data-dismiss="alert">x</button>*@
    <strong>Cảnh báo! </strong>
    Tạo đơn hàng không thành công, vui lòng kiểm tra lại!
</div>
<div class="alert alert-danger" id="danger-alert2">
    @*<button type="button" class="close" data-dismiss="alert">x</button>*@
    <strong>Cảnh báo! </strong>
    Hệ thống không cho phép bán nợ, vui lòng thanh toán hết!
</div>
@*Biến Hidden*@
<input hidden id="CustomerName1" />
<input hidden id="CustomerName2" />
<input hidden id="CustomerName3" />
<input hidden id="CustomerName4" />
<input hidden id="CustomerName5" />
<input hidden id="CustomerName6" />
<input hidden id="CustomerId1" />
<input hidden id="CustomerId2" />
<input hidden id="CustomerId3" />
<input hidden id="CustomerId4" />
<input hidden id="CustomerId5" />
<input hidden id="CustomerId6" />

<input hidden id="Money1" />
<input hidden id="Money2" />
<input hidden id="Money3" />
<input hidden id="Money4" />
<input hidden id="Money5" />
<input hidden id="Money6" />
<input hidden id="Transfer1" />
<input hidden id="Transfer2" />
<input hidden id="Transfer3" />
<input hidden id="Transfer4" />
<input hidden id="Transfer5" />
<input hidden id="Transfer6" />
<input hidden id="ATM1" />
<input hidden id="ATM2" />
<input hidden id="ATM3" />
<input hidden id="ATM4" />
<input hidden id="ATM5" />
<input hidden id="ATM6" />

<input hidden id="Tab1Total" />
<input hidden id="Tab2Total" />
<input hidden id="Tab3Total" />
<input hidden id="Tab4Total" />
<input hidden id="Tab5Total" />
<input hidden id="Tab6Total" />
<input hidden id="Tab1Discount" />
<input hidden id="Tab2Discount" />
<input hidden id="Tab3Discount" />
<input hidden id="Tab4Discount" />
<input hidden id="Tab5Discount" />
<input hidden id="Tab6Discount" />
<input hidden id="Tab1Money" />
<input hidden id="Tab2Money" />
<input hidden id="Tab3Money" />
<input hidden id="Tab4Money" />
<input hidden id="Tab5Money" />
<input hidden id="Tab6Money" />

<input hidden id="DiscountAll1" />
<input hidden id="DiscountAll2" />
<input hidden id="DiscountAll3" />
<input hidden id="DiscountAll4" />
<input hidden id="DiscountAll5" />
<input hidden id="DiscountAll6" />

<input hidden id="isDiscountAll1" />
<input hidden id="isDiscountAll2" />
<input hidden id="isDiscountAll3" />
<input hidden id="isDiscountAll4" />
<input hidden id="isDiscountAll5" />
<input hidden id="isDiscountAll6" />

<input hidden id="Tab11Discount" />
<input hidden id="Tab22Discount" />
<input hidden id="Tab33Discount" />
<input hidden id="Tab44Discount" />
<input hidden id="Tab55Discount" />
<input hidden id="Tab66Discount" />


<input hidden id="noteHD1" />
<input hidden id="noteHD2" />
<input hidden id="noteHD3" />
<input hidden id="noteHD4" />
<input hidden id="noteHD5" />
<input hidden id="noteHD6" />
<div id="CheckPay" hidden></div>

<div id="bodymainNT" style="width:100%; height:100vh">
    <div class="col-sm-7" style="height:100vh; padding: unset;">
        <div class="tabbable">
            <div class="POSleft">
                @*<div class="Return-Product">
                        <h3 id="Return-text" class="Return-text">Hàng trả</h3>
                        <button id="IdHangTra">
                            <img src="~/assets/img/box.svg" style="width: 90%;" />
                        </button>
                    </div>*@

                <div class="Return-Product">
                  
                       
                        <h3 @*id="Return-text"*@ class="Return-text" style="height: 29px; width: 21%; margin: -4px 0px; ">
                            @if ((Erp.BackOffice.Helpers.Common.CurrentUser.BranchId != null) && (Erp.BackOffice.Helpers.Common.CurrentUser.BranchId != 0))
                            {

                                //@Html.DropDownList("BRANCH_ID", SelectListHelper.GetSelectList_Branch_byID(Erp.BackOffice.Helpers.Common.CurrentUser.BranchId, "Cửa Hàng"))

                            }
                            else
                            {
                                @Html.DropDownList("BRANCH_ID", SelectListHelper.GetSelectList_Branch(0, "Cửa Hàng"))
                            }
                        </h3>
                   
                </div>


                <div class="listsearch3">
                    <div id="Search_Product3">

                    </div>
                </div>
                <div>
                    <input id="inpBarcode" type="text" placeholder="Quét mã Barcode.." />
                </div>
                <button id="btnCheckBar">
                    <i class="fa fa-barcode"></i>
                </button>
                
                <button id="btnCheckKey" class="classHidden">
                    <i class="fa fa-keyboard-o"></i>
                </button>

                <div id="PopupDel" class="Del-modal">
                    <div class="PopupDel-content">
                        <div class="PopupDel-container">
                            <span onclick="document.getElementById('PopupDel').style.display='none'" class="w3-button w3-display-topright PopupDel-span">&times;</span>
                            <p>Bạn có chắc muốn xóa đơn hàng này không?</p>
                            <button class="btn btn-mini btnPopupDel1" style="background-color:#66bb6a!important;" onclick="DelTabValue()"> Xóa</button>
                            <button class="btn btn-mini btnPopupDel2" style="background-color:#e57373!important;" onclick="document.getElementById('PopupDel').style.display='none'"> Không</button>
                        </div>
                    </div>
                </div>
            </div>
            <ul class="nav nav-pills" id="tabCustomer">
                <li class="active" id="tab11">
                    <a id="TabA1" class="Cus-Css" data-toggle="tab" href="#tab1">#1 @Model.CustomerName</a>
                    <input id="NameTab1" placeholder="Tên.." />
                    @*<p id="TotalProduct1" value="0" readonly> </p>*@
                </li>
                <li id="tab222">
                    <a class="Cus-Css" id="tab22" data-toggle="tab" href="#tab2">#2 @Model.CustomerName2</a>
                    <input id="NameTab2" placeholder="Tên.." />
                </li>
                <li id="tab333">
                    <a class="Cus-Css" id="tab33" data-toggle="tab" href="#tab3">#3 @Model.CustomerName3</a>
                    <input id="NameTab3" placeholder="Tên.." />
                </li>
                <li style="display:none;" id="tab444">
                    <a class="Cus-Css" id="tab44" data-toggle="tab" href="#tab4">#4 @Model.CustomerName2</a>
                    <input id="NameTab4" placeholder="Tên.." />
                </li>
                <li style="display:none;" id="tab555">
                    <a class="Cus-Css" id="tab55" data-toggle="tab" href="#tab5">#5 @Model.CustomerName2</a>
                    <input id="NameTab5" placeholder="Tên.." />
                </li>
                <li style="display:none;" id="tab666">
                    <a class="Cus-Css" id="tab66" data-toggle="tab" href="#tab6">#6 @Model.CustomerName3</a>
                    <input id="NameTab6" placeholder="Tên.." />
                </li>


                <li style="float:right">
                    <a class="btnCus-Css" style="font-size: 17px;color: #0277bd;" onclick="checktabplus();" id="plustab"> <i class="ace-icon fa fa-plus"></i> @Model.CustomerName3</a>
                </li>
                <li style="float:right">
                    <a class="btnCus-Css" style="font-size: 17px;color: #ffc107;" onclick="checktabminus();" id="minustab"> <i class="ace-icon fa fa-minus"></i> @Model.CustomerName3</a>
                </li>

                @*
                    <li style="width: 388px; padding-left:50px">
                        <div class="Amount1-Css">KH1:</div>
                        <div class="Amount-Css" id="TotalProduct1"></div>
                        <div class="Amount1-Css">KH2:</div>
                        <div class="Amount-Css" id="TotalProduct2"></div>
                        <div class="Amount1-Css">KH3:</div>
                        <div class="Amount-Css" id="TotalProduct3"></div>
                    </li>*@
                @*
                    <input id="TotalAmount1" value="@(Model.TotalAmount)" readonly="readonly" />*@
            </ul>
            <div class="tab-content" style="border:none; z-index:2; ">

                @*Thead Table*@
                <div style="max-height:28px;">
                    <p id="TotalProduct1" value="0" readonly> </p>
                    <p id="TotalProduct2" value="0" readonly> </p>
                    <p id="TotalProduct3" value="0" readonly> </p>
                    <p id="TotalProduct4" value="0" readonly> </p>
                    <p id="TotalProduct5" value="0" readonly> </p>
                    <p id="TotalProduct6" value="0" readonly> </p>
                    <table class="table table-bordered bottom-5 thPOS">

                        <tbody>
                            <tr>
                                <th class="th1" width="3.5%">#</th>
                                <th class="th2" width="23.93%">Tên sản phẩm</th>

                                <th class="th3" width="17.9%">SL</th>
                                <th class="th4" width="14%">Đơn giá</th>


                                <th class="th5" width="20%">
                                    Giảm giá
                                </th>

                                <th class="th6" width="14.8%">Thành tiền</th>

                                <th></th>
                            </tr>
                        </tbody>
                    </table>
                </div>
                @*Foot Table*@
                <div>
                    <div class="row rowSearch_Product1">
                        <table class="tableCss">
                            <tr>
                                <td colspan="8" align="right" class="tdTotal">
                                    <strong class="Tab-none">Tổng</strong>
                                </td>
                                <td class="lineCss"></td>
                                <td colspan="3" style="width:24.5%">
                                    <input id="TotalAmountTab1" class="Tab-none numberinput2 text-right" readonly="readonly" />
                                </td>
                            </tr>
                            <tr>
                                <td colspan="8" align="right" class="tdTotal">
                                    <strong class="Tab-none">Giảm HĐ</strong>
                                </td>
                                <td class="lineCss1"></td>
                                <td colspan="3" style="width:24.5%">
                                    <input id="DiscountTab1" class="Tab-none numberinput2 text-right" readonly="readonly" style="float:left" />
                                </td>
                            </tr>
                        </table>
                        <div class="DivDelBill">
                            <button type="button" class="btnDelBill" onclick="document.getElementById('PopupDel').style.display='block'">
                                <i class="fa fa-trash-o" style="color:white; margin:unset" aria-hidden="true"></i>
                            </button>
                        </div>
                        <div class="td">
                            <div id="listsearch1" class="listsearch1">
                                <div id="Search_Product1">

                                </div>
                            </div>
                        </div>
                        <div class="td td-btnAdd">
                            <a class="btnAdd" onclick="OpenPopup('/Customer/Create_POS?IsPopup=true', 'Tạo thông tin KH', 1000, 500)">
                                <i class="ace-icon fa fa-user-plus"></i>
                            </a>
                        </div>
                        <div class="td"></div>
                    </div>

                </div>
                <div class="tab-pane clearfix active" id="tab1">
                    @*@using (Html.BeginForm_AceStyle((string)ViewBag.Title, "CreateNT", "ProductInvoice", null, FormMethod.Post, new { id = "SaleOrder1", @class = "form-horizontal clearfix" }))*@
                    <form id="PlanFormtab1" name="PlanFormtab1">
                        @{
                            @Html.ValidationSummary(true)
                            <input type="hidden" value="@_hiden" id="setting_hiden" name="setting_hiden" />
                            if (Model.Id == 0)
                            {
                                @Html.HiddenFor(model => model.CreatedUserName)
                                @Html.HiddenFor(model => model.CustomerDiscountId)
                                @Html.HiddenFor(model => model.Id)

                            }
                            else
                            {
                                @Html.HiddenFor(model => model.Id)
                                @Html.HiddenFor(model => model.CreatedUserId)
                                @Html.HiddenFor(model => model.CreatedDate)
                                @Html.HiddenFor(model => model.IsDeleted)
                                @Html.HiddenFor(model => model.Code)
                                @Html.HiddenFor(model => model.CustomerDiscountId)
                                @Html.HiddenFor(model => model.Status)
                            }

                            @Html.HiddenFor(model => model.BranchId)
                            <div class="row">
                                <div class="widget-box">
                                    @*<div id="listOrderDetail1" class="table-responsive top-10 " style="margin:unset">*@
                                    <div id="listOrderDetail1" class="top-10 " style="margin:unset">
                                        <table id="tbllistOrderDetail1" class="table table-bordered bottom-5" style="margin: unset !important;width: 100%;">

                                            <tbody id="tbddetailList1" class="detailList1">
                                                @if (Model.DetailList.Count > 0)
                                                {
                                                    foreach (var item in Model.DetailList)
                                                    {
                                                        @Html.Partial("LoadProductItemNT", item);
                                                    }
                                                }
                                            </tbody>
                                        </table>
                                        <span style="color:red" class="field-validation-valid help-inline" data-valmsg-for="ProductItemCount1" data-valmsg-replace="true"></span>
                                    </div>
                                </div>
                            </div>
                        }
                    </form>
                    @*//het tab 1*@

                </div>
                <div class="tab-pane clearfix" id="tab2">
                    <form id="PlanFormtab2" name="PlanFormtab2">
                        @{

                            @Html.ValidationSummary(true)
                            <input type="hidden" value="@_hiden" id="setting_hiden" name="setting_hiden" />
                            if (Model.Id == 0)
                            {
                                @Html.HiddenFor(model => model.CreatedUserName)
                                @Html.HiddenFor(model => model.CustomerDiscountId)
                                @Html.HiddenFor(model => model.Id)

                            }
                            else
                            {
                                @Html.HiddenFor(model => model.Id)
                                @Html.HiddenFor(model => model.CreatedUserId)
                                @Html.HiddenFor(model => model.CreatedDate)
                                @Html.HiddenFor(model => model.IsDeleted)
                                @Html.HiddenFor(model => model.Code)
                                @Html.HiddenFor(model => model.CustomerDiscountId)
                                @Html.HiddenFor(model => model.Status)
                            }

                            @Html.HiddenFor(model => model.BranchId)
                            <div class="row">
                                <div class="widget-box">
                                    <div id="listOrderDetail2" class="top-10 " style="margin:unset">
                                        <table id="tbllistOrderDetail2" class="table table-bordered bottom-5" style="margin: unset !important;width: 100%;">

                                            <tbody id="tbddetailList2" class="detailList2">
                                                @if (Model.DetailList.Count > 0)
                                                {
                                                    foreach (var item in Model.DetailList)
                                                    {
                                                        @Html.Partial("LoadProductItemNT", item);
                                                    }
                                                }
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>

                        }
                    </form>
                </div>

                <div class="tab-pane clearfix" id="tab3">
                    <form id="PlanFormtab3" name="PlanFormtab3">
                        @{


                            @Html.ValidationSummary(true)
                            <input type="hidden" value="@_hiden" id="setting_hiden" name="setting_hiden" />
                            if (Model.Id == 0)
                            {
                                @Html.HiddenFor(model => model.CreatedUserName)
                                @Html.HiddenFor(model => model.CustomerDiscountId)
                                @Html.HiddenFor(model => model.Id)

                            }
                            else
                            {
                                @Html.HiddenFor(model => model.Id)
                                @Html.HiddenFor(model => model.CreatedUserId)
                                @Html.HiddenFor(model => model.CreatedDate)
                                @Html.HiddenFor(model => model.IsDeleted)
                                @Html.HiddenFor(model => model.Code)
                                @Html.HiddenFor(model => model.CustomerDiscountId)
                                @Html.HiddenFor(model => model.Status)
                            }

                            @Html.HiddenFor(model => model.BranchId)
                            <div class="row">
                                <div class="widget-box">
                                    <div id="listOrderDetail3" class="top-10 " style="margin:unset">
                                        <table id="tbllistOrderDetail3" class="table table-bordered bottom-5" style="margin: unset !important;width: 100%;">

                                            <tbody id="tbddetailList3" class="detailList3">
                                                @if (Model.DetailList.Count > 0)
                                                {
                                                    foreach (var item in Model.DetailList)
                                                    {
                                                        @Html.Partial("LoadProductItemNT", item);
                                                    }
                                                }
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        }
                    </form>
                </div>
                <div class="tab-pane clearfix" id="tab4">
                    <form id="PlanFormtab4" name="PlanFormtab4">
                        @{


                            @Html.ValidationSummary(true)
                            <input type="hidden" value="@_hiden" id="setting_hiden" name="setting_hiden" />
                            if (Model.Id == 0)
                            {
                                @Html.HiddenFor(model => model.CreatedUserName)
                                @Html.HiddenFor(model => model.CustomerDiscountId)
                                @Html.HiddenFor(model => model.Id)

                            }
                            else
                            {
                                @Html.HiddenFor(model => model.Id)
                                @Html.HiddenFor(model => model.CreatedUserId)
                                @Html.HiddenFor(model => model.CreatedDate)
                                @Html.HiddenFor(model => model.IsDeleted)
                                @Html.HiddenFor(model => model.Code)
                                @Html.HiddenFor(model => model.CustomerDiscountId)
                                @Html.HiddenFor(model => model.Status)
                            }

                            @Html.HiddenFor(model => model.BranchId)
                            <div class="row">
                                <div class="widget-box">
                                    <div id="listOrderDetail4" class="table-responsive top-10 " style="margin:unset">
                                        <table id="tbllistOrderDetail4" class="table table-bordered bottom-5" style="margin: unset !important;width: 100%;">

                                            <tbody id="tbddetailList4" class="detailList4">
                                                @if (Model.DetailList.Count > 0)
                                                {
                                                    foreach (var item in Model.DetailList)
                                                    {
                                                        @Html.Partial("LoadProductItemNT", item);
                                                    }
                                                }
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>

                        }
                    </form>
                </div>
                <div class="tab-pane clearfix" id="tab5">
                    <form id="PlanFormtab5" name="PlanFormtab5">
                        @{


                            @Html.ValidationSummary(true)
                            <input type="hidden" value="@_hiden" id="setting_hiden" name="setting_hiden" />
                            if (Model.Id == 0)
                            {
                                @Html.HiddenFor(model => model.CreatedUserName)
                                @Html.HiddenFor(model => model.CustomerDiscountId)
                                @Html.HiddenFor(model => model.Id)

                            }
                            else
                            {
                                @Html.HiddenFor(model => model.Id)
                                @Html.HiddenFor(model => model.CreatedUserId)
                                @Html.HiddenFor(model => model.CreatedDate)
                                @Html.HiddenFor(model => model.IsDeleted)
                                @Html.HiddenFor(model => model.Code)
                                @Html.HiddenFor(model => model.CustomerDiscountId)
                                @Html.HiddenFor(model => model.Status)
                            }

                            @Html.HiddenFor(model => model.BranchId)
                            <div class="row">
                                <div class="widget-box">
                                    <div id="listOrderDetail5" class="table-responsive top-10 " style="margin:unset">
                                        <table id="tbllistOrderDetail5" class="table table-bordered bottom-5" style="margin: unset !important;width: 100%;">

                                            <tbody id="tbddetailList5" class="detailList5">
                                                @if (Model.DetailList.Count > 0)
                                                {
                                                    foreach (var item in Model.DetailList)
                                                    {
                                                        @Html.Partial("LoadProductItemNT", item);
                                                    }
                                                }
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>

                        }
                    </form>
                </div>
                <div class="tab-pane clearfix" id="tab6">
                    <form id="PlanFormtab6" name="PlanFormtab6">
                        @{


                            @Html.ValidationSummary(true)
                            <input type="hidden" value="@_hiden" id="setting_hiden" name="setting_hiden" />
                            if (Model.Id == 0)
                            {
                                @Html.HiddenFor(model => model.CreatedUserName)
                                @Html.HiddenFor(model => model.CustomerDiscountId)
                                @Html.HiddenFor(model => model.Id)

                            }
                            else
                            {
                                @Html.HiddenFor(model => model.Id)
                                @Html.HiddenFor(model => model.CreatedUserId)
                                @Html.HiddenFor(model => model.CreatedDate)
                                @Html.HiddenFor(model => model.IsDeleted)
                                @Html.HiddenFor(model => model.Code)
                                @Html.HiddenFor(model => model.CustomerDiscountId)
                                @Html.HiddenFor(model => model.Status)
                            }

                            @Html.HiddenFor(model => model.BranchId)
                            <div class="row">
                                <div class="widget-box">
                                    <div id="listOrderDetail6" class="table-responsive top-10 " style="margin:unset">
                                        <table id="tbllistOrderDetail6" class="table table-bordered bottom-5" style="margin: unset !important;width: 100%;">

                                            <tbody id="tbddetailList6" class="detailList6">
                                                @if (Model.DetailList.Count > 0)
                                                {
                                                    foreach (var item in Model.DetailList)
                                                    {
                                                        @Html.Partial("LoadProductItemNT", item);
                                                    }
                                                }
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>

                        }
                    </form>
                </div>
            </div>
        </div>
        <div class="row" style="position: fixed;top: 84%;left: 2.3%;">
            <div>
                <div class="controlPOS-left" style="left: 0%; top: 90%; position: fixed;width: 62%;">
                    <div class="row">
                        <div class="btnPay">
                            <input id="TotalAmount1" readonly />
                            <p id="textPay" class="textPay" onclick="Savetab1OKIn(@serializer.Serialize(Model))">Thanh toán(F10)</p>
                        </div>
                        <button type="button" class="btnOpenPay" id="btnOpenPopupPay" onclick="OpenPopupPay()">
                            <i class="fa fa-chevron-right" style="color:white"></i>
                        </button>
                        <button type="button" style="display:none" class="btnOpenPay" id="btnClosePopupPay" onclick="ExitPopupPay()">
                            <i class="fa fa-chevron-left" style="color:white"></i>
                        </button>
                        @*<div>
                                <button type="button" class="btnDelBill" onclick="DelTabValue()">
                                    <i class="fa fa-trash-o" style="color:white" aria-hidden="true"></i>
                                </button>
                            </div>*@
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="productRight" class="col-sm-5" style="display:block; height:100vh">
        <div class="product-search-box">
            <div class="row" style="margin-left: 2.5%;width: 90%;">
                <div style="width:94%; border:1px solid #d2cdcd; height:33px; border-radius: 5px;margin-left: 8px; ">
                    <input id="txtSearchControl" name="txtSearchControl" class="form-control mr-sm-2" type="text" placeholder="Nhập tên sản phẩm.." aria-label="Search"
                           style="width:80%; float:left; border:none; margin-left: 10px; border-radius: 5px !important; height: auto;">
                    <span class="fa fa-search" id="iconSearch">
                    </span>
                </div>
                <div class="ViewProduct">
                    <div id="ViewProductControl">
                    </div>
                </div>
            </div>
        </div>

        <div class="listsearch2">

            <div id="Search_Product">
                <div style="overflow:scroll; height:78.5%!important; position: fixed; width:40%">
                    <table class="table table-bordered" style="margin: unset;width: 100%;border:none !important; border-top: 0.3px solid #f1f1f1; border-left: 0.3px solid #f1f1f1;">
                        <tbody>
                            <tr>
                                <td id="tblData" style="border:none !important;"></td>
                            </tr>
                        </tbody>

                    </table>
                </div>
                <div id="paged">

                </div>
            </div>
        </div>
    </div>

    <div class="col-sm-5 popupPayRight" style="height:100vh;">
        <div class="row">
            <div class="td"></div>
            <div class="td"></div>
            <div class="td"></div>
        </div>
        @*background-color:#f7f7f7;*@
        <div id="popup_Pay" style="background-color:#f7f7f7; height: 100%;border-radius: 2px;">
            <div id="CheckPopup" hidden></div>
            <div class="bgPopup">
                <div class="bodyPopup" style="height:82%;">
                    @*<div class="row widRow">
                            <div class="widIcon">
                                <i class="fa fa-file-text-o" aria-hidden="true"></i>
                            </div>
                            <label class="widTxt"> Ghi chú </label>
                            <div class="widInput">
                                <input id="noteHD" type="text" />
                            </div>
                        </div>*@
                    <div class="row widRow">
                        <div class="widIcon">
                            <i class="fa fa-align-justify" aria-hidden="true"></i>
                        </div>
                        <label class="widTxt"> Tiền hàng </label>
                        <div class="widInput">
                            <input id="TotalAmountPay" readonly type="text" />
                        </div>
                    </div>

                    <div class="row widRow">
                        <div class="widIcon">
                            <i class="fa fa-gift" aria-hidden="true"></i>
                        </div>
                        <label class="widTxt"> Giảm giá </label>
                        <div class="widInput">
                            <input id="DiscountAll" type="text" />
                        </div>
                        <div class="widControl">
                            <div class="toggle-button-cover" id="toggle-button-cover">
                                <div class="button-cover">
                                    <div class="button r" id="button-1">
                                        <input id="TypeDiscountHD" type="checkbox" class="checkbox" onclick="myFunction()">
                                        <div class="knobs"></div>
                                        <div class="layer"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row widRow">
                        <div class="widIcon">
                            <i class="fa fa-hand-o-right" aria-hidden="true"></i>
                        </div>
                        <label class="widTxt"> Thanh toán </label>
                        <div class="widInput">
                            <input id="TotalPay" readonly type="text" />
                        </div>
                        @*<div class="widControl">
                                <span style="color:#0277bd; font-weight:bold">vnđ</span>
                            </div>*@
                    </div>
                    <div class="row widRow">
                        <div class="widIcon">
                            <i class="fa fa-money" aria-hidden="true"></i>
                        </div>
                        <label class="widTxt"> Tiền mặt </label>
                        <div class="widInput">
                            <div>
                                <input id="MoneyPay" type="text" placeholder="" />
                            </div>
                        </div>
                        <div class="widControl">
                            <button class="btnCheckPay" onclick="OpenCheckPay()">
                                <i class="fa fa-level-down "></i>
                            </button>
                        </div>
                    </div>
                    <div>
                        <div class="row widRow" hidden id="CheckPay2">
                            <div class="widIcon">
                                <i class="fa fa-credit-card" aria-hidden="true"></i>
                            </div>
                            <label class="widTxt"> Quẹt thẻ </label>
                            <div class="widInput">
                                <input id="ATMPay" type="text" placeholder="" />
                            </div>
                        </div>
                        <div class="row widRow" hidden id="CheckPay1">
                            <div class="widIcon">
                                <i class="fa fa-exchange" aria-hidden="true"></i>
                            </div>
                            <label class="widTxt"> Chuyển khoản </label>
                            <div class="widInput">
                                <input id="TransferPay" type="text" placeholder="" />
                            </div>
                        </div>
                    </div>

                    <div class="row widRow" style="margin-top: 2%;">
                        <div class="widIcon">
                            <i class="fa fa-gift" aria-hidden="true"></i>
                        </div>
                        <label class="widTxt"> Tiền thối </label>
                        <div class="widInput">
                            <input id="ChangeMoney" readonly type="text" />
                        </div>
                    </div>
                    <div class="row widRow">
                        <div class="widIcon">
                            <i class="fa fa-file-text-o" aria-hidden="true"></i>
                        </div>
                        <label class="widTxt"> Ghi chú </label>
                        <div class="clearfix ">
                            <textarea id="noteHD" class="col-xs-6" cols="20" rows="2" @*onkeypress="onTestChange()"*@></textarea>

                        </div>
                    </div>
                    <div class="row btnOrder">
                        <div style="width: 35%; float:left;">
                            <a class="btn btn-mini Click1" style="background-color:#66bb6a!important;width: 100%; " id="savetab1" onclick="Savetab1OK(@serializer.Serialize(Model));">
                                <i class="ace-icon fa fa-save"></i>
                                Thanh toán (F9)
                            </a>
                        </div>
                        <div style="width: 54%; float:left;">
                            <a class="btn btn-mini Click2" style="background-color:#0277bc !important;margin-left: 10px;width: 100%;" id="savetab1" target="_blank" onclick="Savetab1OKIn(@serializer.Serialize(Model));">
                                <i class="ace-icon fa fa-save"></i>
                                Thanh toán và in (F10)
                            </a>
                        </div>
                    </div>
                </div>

                <div id="btnExit" style="position: fixed; display:none;
    top: 7%;
    left: 90.5%;">
                    <button class="btn btn-mini" style="background-color:#e57373!important;margin-left: 20px" onclick="ExitPopupPay()"><i class="fa fa-times" style="margin:unset" aria-hidden="true"></i></button>
                </div>

            </div>
        </div>
    </div>

</div>

<div class="listsearch8">
    <div id="Search_Product8">

    </div>
</div>
<script>

</script>
<script type="text/javascript">
    qtytabnow = 3;
    var tab1 = 1;
    var tab2 = 0;
    var tab3 = 0;
    var tab4 = 0;
    var tab5 = 0;
    var tab6 = 0;
    var checkcustomertab1 = 0;
    var checkcustomertab2 = 0;
    var checkcustomertab3 = 0;
    var checkcustomertab4 = 0;
    var checkcustomertab5 = 0;
    var checkcustomertab = 0;
    var ArrHdDiscountAll = new Array();
    var ArrHdDiscountVIP = new Array();
    var isDiscountAll = false;
    var isplus = 0;
    var isminus = 0;
    var isone = 0;
    var SLDau = 1;
    var isEditPrice = 0;

    //$("#txtSearchControl").change(function () {
    //    GetPageData(1);
    //    //alert(Search);
    //});
    function getdataimg(ProductId, ProductName, Unit, Price, ProductType, ProductCode, QuantityInventory, LoCode, ExpiryDate, TaxFee) {

        isplus = 1;
        isminus = 0;
        //alert("vao ham getdataimg");
        var $this = $(this);

        if (tab3 == 0 && tab1 == 1 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
            var OrderNo = $('.detailList1 tr').length;
            var Istab = 1;
            var customerId = $("#CustomerId1").val();
            if (customerId === "" || customerId === null) {
                customerId = "0";
            }
        } else if (tab3 == 0 && tab1 == 0 && tab2 == 1 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
            var OrderNo = $('.detailList2 tr').length;
            var Istab = 2;
            var customerId = $("#CustomerId2").val();
            if (customerId === "" || customerId === null) {
                customerId = "0";
            }
        } else if (tab3 == 1 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
            var OrderNo = $('.detailList3 tr').length;
            var Istab = 3;
            var customerId = $("#CustomerId3").val();
            if (customerId === "" || customerId === null) {
                customerId = "0";
            }
        } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 1 && tab5 == 0 && tab6 == 0) {
            var OrderNo = $('.detailList4 tr').length;
            var Istab = 4;
            var customerId = $("#CustomerId4").val();
            if (customerId === "" || customerId === null) {
                customerId = "0";
            }
        } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 1 && tab6 == 0) {
            var OrderNo = $('.detailList5 tr').length;
            var Istab = 5;
            var customerId = $("#CustomerId5").val();
            if (customerId === "" || customerId === null) {
                customerId = "0";
            }
        } else {
            var OrderNo = $('.detailList6 tr').length;
            var Istab = 6;
            var customerId = $("#CustomerId6").val();
            if (customerId === "" || customerId === null) {
                customerId = "0";
            }
        }
        var Quantity = 1;
        var formdata = {
            OrderNo: OrderNo,
            ProductId: ProductId,
            ProductName: ProductName,
            Unit: Unit,
            Quantity: Quantity,
            Price: Price,
            ProductCode: ProductCode,
            ProductType: ProductType,
            QuantityInventory: QuantityInventory,
            LoCode: LoCode,
            ExpiryDate: ExpiryDate,
            TaxFee: TaxFee,
            Istab: Istab,
            CustomerID: customerId
        }





        //begin hoapd su ly neu co roi thi cong 1 don vi
        //alert("OK");
        if (tab3 == 0 && tab1 == 1 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
            $("#tbllistOrderDetail1 TBODY TR").each(function () {
                var row = $(this);

                var ProductCode1 = $(this).closest('tr').find("td:eq(5) input").val();
                //alert(ProductCode);
                // alert($('#product_barcode3').val());
                $(this).removeClass('selected_grey').addClass("text_data");

                if (String(ProductCode).trim().localeCompare(String(ProductCode1).trim()) == 0) {
                    //alert(ProductCode);
                    $(this).closest('tr').find("td:eq(2) input").val(parseInt($(this).closest('tr').find("td:eq(2) input").val()) + 1);
                    $(this).closest('tr').find("td:eq(2) input").trigger('change');
                    $(this).addClass('selected_grey');
                    formdata = {};
                    return;
                }
                //alert(ProductCode);

            });
        } else if (tab3 == 0 && tab1 == 0 && tab2 == 1 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
            $("#tbllistOrderDetail2 TBODY TR").each(function () {
                var row = $(this);

                var ProductCode1 = $(this).closest('tr').find("td:eq(5) input").val();

                // alert($('#product_barcode3').val());
                $(this).removeClass('selected_grey').addClass("text_data");

                if (String(ProductCode).trim().localeCompare(String(ProductCode1).trim()) == 0) {
                    //alert(ProductCode);
                    $(this).closest('tr').find("td:eq(2) input").val(parseInt($(this).closest('tr').find("td:eq(2) input").val()) + 1);
                    $(this).closest('tr').find("td:eq(2) input").trigger('change');
                    $(this).addClass('selected_grey');
                    formdata = {};
                    return;
                }
                //alert(ProductCode);

            });
        } else if (tab3 == 1 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
            $("#tbllistOrderDetail3 TBODY TR").each(function () {
                var row = $(this);

                var ProductCode1 = $(this).closest('tr').find("td:eq(5) input").val();

                // alert($('#product_barcode3').val());
                $(this).removeClass('selected_grey').addClass("text_data");

                if (String(ProductCode).trim().localeCompare(String(ProductCode1).trim()) == 0) {
                    //alert(ProductCode);
                    $(this).closest('tr').find("td:eq(2) input").val(parseInt($(this).closest('tr').find("td:eq(2) input").val()) + 1);
                    $(this).closest('tr').find("td:eq(2) input").trigger('change');
                    $(this).addClass('selected_grey');
                    formdata = {};
                    return;
                }
                //alert(ProductCode);

            });
        } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 1 && tab5 == 0 && tab6 == 0) {
            $("#tbllistOrderDetail4 TBODY TR").each(function () {
                var row = $(this);

                var ProductCode1 = $(this).closest('tr').find("td:eq(5) input").val();

                // alert($('#product_barcode3').val());
                $(this).removeClass('selected_grey').addClass("text_data");

                if (String(ProductCode).trim().localeCompare(String(ProductCode1).trim()) == 0) {
                    //alert(ProductCode);
                    $(this).closest('tr').find("td:eq(2) input").val(parseInt($(this).closest('tr').find("td:eq(2) input").val()) + 1);
                    $(this).closest('tr').find("td:eq(2) input").trigger('change');
                    $(this).addClass('selected_grey');
                    formdata = {};
                    return;
                }
                //alert(ProductCode);

            });
        } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 1 && tab6 == 0) {
            $("#tbllistOrderDetail5 TBODY TR").each(function () {
                var row = $(this);

                var ProductCode1 = $(this).closest('tr').find("td:eq(5) input").val();

                // alert($('#product_barcode3').val());
                $(this).removeClass('selected_grey').addClass("text_data");

                if (String(ProductCode).trim().localeCompare(String(ProductCode1).trim()) == 0) {
                    //alert(ProductCode);
                    $(this).closest('tr').find("td:eq(2) input").val(parseInt($(this).closest('tr').find("td:eq(2) input").val()) + 1);
                    $(this).closest('tr').find("td:eq(2) input").trigger('change');
                    $(this).addClass('selected_grey');
                    formdata = {};
                    return;
                }
                //alert(ProductCode);

            });
        } else {
            $("#tbllistOrderDetail6 TBODY TR").each(function () {
                var row = $(this);

                var ProductCode1 = $(this).closest('tr').find("td:eq(5) input").val();

                // alert($('#product_barcode3').val());
                $(this).removeClass('selected_grey').addClass("text_data");

                if (String(ProductCode).trim().localeCompare(String(ProductCode1).trim()) == 0) {
                    //alert(ProductCode);
                    $(this).closest('tr').find("td:eq(2) input").val(parseInt($(this).closest('tr').find("td:eq(2) input").val()) + 1);
                    $(this).closest('tr').find("td:eq(2) input").trigger('change');
                    $(this).addClass('selected_grey');
                    formdata = {};
                    return;
                }
                //alert(ProductCode);

            });
        }

        //end hoapd su ly neu co roi thi cong 1 don vi
        ClickEventHandler2(true, "/ProductInvoice/LoadProductItemNT", ".detailList2", formdata, ProductCode, function () {
            if (tab3 == 0 && tab1 == 1 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                $('#ProductItemCount1').val($('#listOrderDetail1 .detailList1 tr').length);
            } else if (tab3 == 0 && tab1 == 0 && tab2 == 1 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                $('#ProductItemCount2').val($('#listOrderDetail2 .detailList2 tr').length);
            } else if (tab3 == 1 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                $('#ProductItemCount3').val($('#listOrderDetail3 .detailList3 tr').length);
            } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 1 && tab5 == 0 && tab6 == 0) {
                $('#ProductItemCount4').val($('#listOrderDetail4 .detailList4 tr').length);
            } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 1 && tab6 == 0) {
                $('#ProductItemCount5').val($('#listOrderDetail5 .detailList5 tr').length);
            } else {
                $('#ProductItemCount6').val($('#listOrderDetail6 .detailList6 tr').length);
            }
            $.mask.definitions['~'] = '[+-]';
            $('.input-mask-date').mask('99/99/9999');
            LoadNumberInput();

            //Cho phép sửa giá?
            if (@isallow_edit_price_POS == false)
            {
                $('.detail_item_price_1').attr('readonly', true);
                $('.detail_item_price_2').attr('readonly', true);
                $('.detail_item_price_3').attr('readonly', true);
                $('.detail_item_price_4').attr('readonly', true);
                $('.detail_item_price_5').attr('readonly', true);
                $('.detail_item_price_6').attr('readonly', true);
            }

            if (tab3 == 0 && tab1 == 1 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                tinh_tong_tien1();
                tinhkhuyenmaiHd();
                $("#tbllistOrderDetail1 TBODY TR").each(function () {
                    var row = $(this);

                    var ProductCode1 = $(this).closest('tr').find("td:eq(5) input").val();
                    //alert(ProductCode);
                    // alert($('#product_barcode3').val());
                    $(this).removeClass('selected_grey').addClass("text_data");

                    if (String(ProductCode).trim().localeCompare(String(ProductCode1).trim()) == 0) {
                        //alert(ProductCode);
                        $(this).addClass('selected_grey');
                        formdata = {};
                        return;
                    }
                    //alert(ProductCode);

                });
            } else if (tab3 == 0 && tab1 == 0 && tab2 == 1 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                tinh_tong_tien2();
                tinhkhuyenmaiHd();

                $("#tbllistOrderDetail2 TBODY TR").each(function () {
                    var row = $(this);

                    var ProductCode1 = $(this).closest('tr').find("td:eq(5) input").val();
                    //alert(ProductCode);
                    // alert($('#product_barcode3').val());
                    $(this).removeClass('selected_grey').addClass("text_data");

                    if (String(ProductCode).trim().localeCompare(String(ProductCode1).trim()) == 0) {
                        //alert(ProductCode);
                        $(this).addClass('selected_grey');
                        formdata = {};
                        return;
                    }
                    //alert(ProductCode);

                });

            } else if (tab3 == 1 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                tinh_tong_tien3();
                tinhkhuyenmaiHd();

                $("#tbllistOrderDetail3 TBODY TR").each(function () {
                    var row = $(this);

                    var ProductCode1 = $(this).closest('tr').find("td:eq(5) input").val();
                    //alert(ProductCode);
                    // alert($('#product_barcode3').val());
                    $(this).removeClass('selected_grey').addClass("text_data");

                    if (String(ProductCode).trim().localeCompare(String(ProductCode1).trim()) == 0) {
                        //alert(ProductCode);
                        $(this).addClass('selected_grey');
                        formdata = {};
                        return;
                    }
                    //alert(ProductCode);

                });

            } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 1 && tab5 == 0 && tab6 == 0) {
                tinh_tong_tien4();
                tinhkhuyenmaiHd();
                $("#tbllistOrderDetail4 TBODY TR").each(function () {
                    var row = $(this);

                    var ProductCode1 = $(this).closest('tr').find("td:eq(5) input").val();
                    //alert(ProductCode);
                    // alert($('#product_barcode3').val());
                    $(this).removeClass('selected_grey').addClass("text_data");

                    if (String(ProductCode).trim().localeCompare(String(ProductCode1).trim()) == 0) {
                        //alert(ProductCode);
                        $(this).addClass('selected_grey');
                        formdata = {};
                        return;
                    }
                    //alert(ProductCode);

                });

            } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 1 && tab6 == 0) {
                tinh_tong_tien5();
                tinhkhuyenmaiHd();

                $("#tbllistOrderDetail5 TBODY TR").each(function () {
                    var row = $(this);

                    var ProductCode1 = $(this).closest('tr').find("td:eq(5) input").val();
                    //alert(ProductCode);
                    // alert($('#product_barcode3').val());
                    $(this).removeClass('selected_grey').addClass("text_data");

                    if (String(ProductCode).trim().localeCompare(String(ProductCode1).trim()) == 0) {
                        //alert(ProductCode);
                        $(this).addClass('selected_grey');
                        formdata = {};
                        return;
                    }
                    //alert(ProductCode);

                });

            } else {
                tinh_tong_tien6();
                tinhkhuyenmaiHd();

                $("#tbllistOrderDetail6 TBODY TR").each(function () {
                    var row = $(this);

                    var ProductCode1 = $(this).closest('tr').find("td:eq(5) input").val();
                    //alert(ProductCode);
                    // alert($('#product_barcode3').val());
                    $(this).removeClass('selected_grey').addClass("text_data");

                    if (String(ProductCode).trim().localeCompare(String(ProductCode1).trim()) == 0) {
                        //alert(ProductCode);
                        $(this).addClass('selected_grey');
                        formdata = {};
                        return;
                    }
                    //alert(ProductCode);

                });
            }
        });

    }



    function GetPageData(pageNum, pageSize) {

        //After every trigger remove previous data and paging
        $("#tblData").empty();
        $("#paged").empty();
        //alert("vao phan trang");
        ShowLoading();
        var Search = document.getElementById("txtSearchControl").value;
        $.getJSON("/ProductInvoice/SearchProductControl", { Search: Search, pageNumber: pageNum, pageSize: pageSize }, function (response) {
            var rowData = "";
            for (var i = 0; i < response.Data.length; i++) {
                var price = numeral(response.Data[i].ProductPriceOutbound).format('0,0');
                var strtd = '<div class="box-card"> '
                    + '<div class="card" >'
                    + '<div class="imgBx">'
                    + '<a class="imgproduct" href="javascript:getdataimg(' + response.Data[i].ProductId + ',' + "'" + response.Data[i].ProductName + "'" + ',' + (response.Data[i].ProductUnit == null ? "''" : response.Data[i].ProductUnit) + ',' + response.Data[i].ProductPriceOutbound + ',' + (response.Data[i].CategoryCode == null ? "''" : response.Data[i].CategoryCode) + ',' + "'" + response.Data[i].ProductCode + "'" + ',' + (response.Data[i].Quantity == null ? 0 : response.Data[i].Quantity) + ',' + (response.Data[i].LoCode == null ? "''" : "'" + response.Data[i].LoCode + "'") + ',' + (response.Data[i].ExpiryDate == null ? "''" : response.Data[i].ExpiryDate.Value.ToString("dd/MM/yyyy")) + ',' + response.Data[i].TaxFee + ')"'
                    + ' data-id="' + response.Data[i].ProductId

                    + '" value="' + response.Data[i].Id
                    + '" data-selected="0"'
                    + ' data-value="' + response.Data[i].Id
                    + '| /Uploads/Product/product_ao_gucci_2_optimized.jpg |'
                    + response.Data[i].ProductCode + ' - ' + response.Data[i].ProductName
                    + ' | ' + (response.Data[i].Origin == null ? "''" : response.Data[i].Origin)
                    + ' | ' + (response.Data[i].Quantity == null ? "''" : response.Data[i].Quantity)
                    + ' | ' + (response.Data[i].Size == null ? "''" : response.Data[i].Size)
                    + ' | ' + (response.Data[i].color == null ? "''" : response.Data[i].color)
                    + '" data-code="' + response.Data[i].ProductCode
                    + '" data-lo-code="' + (response.Data[i].LoCode == null ? "''" : response.Data[i].LoCode)
                    + '" data-expiry-date="' + (response.Data[i].ExpiryDate == null ? "''" : response.Data[i].ExpiryDate.Value.ToString("dd/MM/yyyy"))
                    + '" data-product-type="' + (response.Data[i].ProductType == null ? "''" : response.Data[i].ProductType)
                    + '" data-price="' + response.Data[i].ProductPriceOutbound
                    + '" data-unit="' + (response.Data[i].ProductUnit == null ? "''" : response.Data[i].ProductUnit)
                    + '" data-product-name="' + (response.Data[i].ProductName == null ? "''" : response.Data[i].ProductName)
                    + '" data-product-id="' + (response.Data[i].ProductId == null ? "''" : response.Data[i].ProductId)
                    + '" data-quantity-inventory="' + (response.Data[i].ProductId == null || response.Data[i].ProductId == undefined ? "''" : response.Data[i].QuantityInventory)
                    + '" data-origin="' + (response.Data[i].Origin == null ? "''" : response.Data[i].Origin)
                    + '" data-tax-fee="' + (response.Data[i].TaxFee == null ? "''" : response.Data[i].TaxFee)
                    + '" style = "width: 110px; height:120px; background-size: 100%;'
                    + 'background-image: url(' + response.Data[i].Image_Name + ')"> '

                    + '</a> '
                    + ' </div>'
                    + ' <div class="details-card" >'
                    + ' <p class="txtStock"> ' + response.Data[i].ProductCode + '</p>'
                    + ' <p class="txtStock"> ' + (price == null ? "'X'" : price) + 'đ' + " | " + (response.Data[i].Quantity == null ? "'X'" : response.Data[i].Quantity) + "</p>"
                    + ' <p class="txtStock"> ' + (response.Data[i].Size == null ? "' '" : response.Data[i].Size) + " | " + (response.Data[i].color == null ? "' '" : response.Data[i].color) + '</p>'
                    + ' <p class="txtStock" style="color:black"> ' + (response.Data[i].ProductName == null ? "'NoName'" : response.Data[i].ProductName) + ' </p>'
                    + ' </div>  </div >  </div >';

                //alert(strtd);
                rowData = rowData + strtd;
            }
            $("#tblData").append(rowData);
            PaggingTemplate(response.TotalPages, response.CurrentPage);
            HideLoading();

        })
    };
    //Start Pagination
    //This is paging temlpate ,you should just copy paste
    function PaggingTemplate(totalPage, currentPage) {
        var template = "";
        var TotalPages = totalPage;
        var CurrentPage = currentPage;
        var PageNumberArray = Array();


        var countIncr = 1;
        for (var i = currentPage; i <= totalPage; i++) {
            PageNumberArray[0] = currentPage;
            if (totalPage != currentPage && PageNumberArray[countIncr - 1] != totalPage) {
                PageNumberArray[countIncr] = i + 1;
            }
            countIncr++;
        };
        PageNumberArray = PageNumberArray.slice(0, 5);
        var FirstPage = 1;
        var LastPage = totalPage;
        if (totalPage != currentPage) {
            var ForwardOne = currentPage + 1;
        }
        var BackwardOne = 1;
        if (currentPage > 1) {
            BackwardOne = currentPage - 1;
        }

        //template =
        //    '<div  style="width:15%; float:left;">' +
        //    '<select id="custom-select">';
        //for (var i = 1; i <= totalPage; i++) {
        //    template = template + '<option value="' + i + '">' + i + '</option>';
        //}
        //template = template + ' </select> </div>';
        template = template + '<input id="NumberPage" placeholder="Trang ' + CurrentPage + ' / ' + totalPage + '" />';

        template = template + '<ul class="pager" style="margin:unset;overflow: hidden;" >' +
            '<li><a class="btnPaged" href="#" onclick="GetPageData(' + FirstPage + ')">' +
            //'<i class="fa fa-angle-double-left"></i>' +
            'Đầu' +
            '</a ></li > ' +
            //'<li><select ng-model="pageSize" id="selectedId"><option value="20" selected>20</option><option value="50">50</option><option value="100">100</option><option value="150">150</option></select> </li>' +
            '<li><a class="btnPaged" href="#" onclick="GetPageData(' + BackwardOne + ')"><i class="fa fa-angle-left"></i></a>';

        var numberingLoop = "";
        numberingLoop = numberingLoop + '<a class="page-number active PageActive btnPaged" href="#">' + CurrentPage + '</a>'
        // Danh sách từng trang
        //for (var i = CurrentPage; i < PageNumberArray.length & i < CurrentPage+1; i++) {
        //    numberingLoop = numberingLoop + '<a class="page-number active" onclick="GetPageData(' + PageNumberArray[i] + ')" href="#">' + PageNumberArray[i] + ' &nbsp;&nbsp;</a>'
        //}
        template = template + numberingLoop + '<a class="btnPaged" href="#" onclick="GetPageData(' + ForwardOne + ')" >' +
            '<i class="fa fa-angle-right"></i></a ></li > ' +
            '<li class="btnPaged"><a class="btnPaged" href="#" onclick="GetPageData(' + LastPage + ')">' +
            'Cuối' +
            //'<i class="fa fa-angle-double-right btnPaged"></i>' +
            '</a ></li ></ul > ';

        $("#paged").append(template);
        $('#custom-select').change(function () {
            GetPageData($(this).val());
            $("#custom-select").val($(this).val());
            HideLoading();
        });

        $('#NumberPage').keyup(function (event) {
            if (window.event.keyCode == 13 || window.event.which == 13) {
                event.preventDefault();
                GetPageData($('#NumberPage').val());
                HideLoading();
            }
        });
    };

    function AppendSearchControl() {

        var Search = document.getElementById("txtSearchControl").value;

        $.get('/ProductInvoice/SearchProductControl/?Search=' + Search, function (html) {
            $('.listsearch2').show();
            $("#ViewProductControl").html(html);
        });

    };

    function ClosePopupAndReloadPage(id, name, company, taxcode, bankname, bankaccount, address, phone) {

        if (tab3 == 0 && tab1 == 1 && tab2 == 0) {


            $("#CompanyName1").val(company);
            $("#CustomerName").val(name);
            $("#CustomerName1").val(name);
            $("#CustomerPhone1").val(phone);
            $("#CustomerId").val(id);
            $("#CustomerId_DisplayText").val(name);
            $("#TaxCode1").val(taxcode);
            $("#BankAccount1").val(bankaccount);
            $("#BankName1").val(bankname);
            $("#Address1").val(address);


        } else if (tab3 == 0 && tab1 == 0 && tab2 == 1) {

            $("#CompanyName2").val(company);
            $("#CustomerName2").val(name);

            $("#CustomerPhone2").val(phone);
            $("#CustomerId2").val(id);
            $("#CustomerId2_DisplayText").val(name);
            $("#TaxCode2").val(taxcode);
            $("#BankAccount2").val(bankaccount);
            $("#BankName2").val(bankname);
            $("#Address2").val(address);
        } else {

            $("#CompanyName3").val(company);
            $("#CustomerName3").val(name);
            $("#CustomerPhone3").val(phone);
            $("#CustomerId3").val(id);
            $("#CustomerId3_DisplayText").val(name);
            $("#TaxCode3").val(taxcode);
            $("#BankAccount3").val(bankaccount);
            $("#BankName3").val(bankname);
            $("#Address3").val(address);
        }



        ClosePopup(false);

    };


    function processFormData(formData) {
        var data = formData;
        if (tab3 == 0 && tab1 == 1 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
            data.forEach(function (object) {
                $('#PlanFormtab1 input').each(function () {
                    if (this.name == object.name) {
                        var nonformData = $(this).data("nonformdata");
                        formData.push({ name: this.name, value: nonformData });
                    }
                });
            });
        } else if (tab3 == 0 && tab1 == 0 && tab2 == 1 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
            data.forEach(function (object) {
                $('#PlanFormtab2 input').each(function () {
                    if (this.name == object.name) {
                        var nonformData = $(this).data("nonformdata");
                        formData.push({ name: this.name, value: nonformData });
                    }
                });
            });
        } else if (tab3 == 1 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
            data.forEach(function (object) {
                $('#PlanFormtab3 input').each(function () {
                    if (this.name == object.name) {
                        var nonformData = $(this).data("nonformdata");
                        formData.push({ name: this.name, value: nonformData });
                    }
                });
            });
        } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 1 && tab5 == 0 && tab6 == 0) {
            data.forEach(function (object) {
                $('#PlanFormtab4 input').each(function () {
                    if (this.name == object.name) {
                        var nonformData = $(this).data("nonformdata");
                        formData.push({ name: this.name, value: nonformData });
                    }
                });
            });
        } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 1 && tab6 == 0) {
            data.forEach(function (object) {
                $('#PlanFormtab5 input').each(function () {
                    if (this.name == object.name) {
                        var nonformData = $(this).data("nonformdata");
                        formData.push({ name: this.name, value: nonformData });
                    }
                });
            });
        } else {
            data.forEach(function (object) {
                $('#PlanFormtab6 input').each(function () {
                    if (this.name == object.name) {
                        var nonformData = $(this).data("nonformdata");
                        formData.push({ name: this.name, value: nonformData });
                    }
                });
            });
        }

        return formData;
    }

    function my_functionadd(Istab, ProductCode, add) {
        //$("#DetailList_" + OrderNo + "__Quantity").val(parseInt($("#DetailList_" + OrderNo + "__Quantity").val()) + 1);
        //$("#DetailList_" + OrderNo + "__Quantity").trigger('change');
        var row; var ProductCode1;
        //debugger
        //alert("OK");
        $("#tbllistOrderDetail" + Istab + " TBODY TR").each(function () {
            row = $(this);
            ProductCode1 = $(this).closest('tr').find("td:eq(5) input").val();
            $(this).removeClass('selected_grey').addClass("text_data");
            if (String(ProductCode).trim().localeCompare(String(ProductCode1).trim()) == 0) {
                if (add == 1) {
                    $(this).closest('tr').find("td:eq(2) input").val(parseInt($(this).closest('tr').find("td:eq(2) input").val()) + 1);
                    isplus = 1;
                    isminus = 0;
                    isone = 0;

                }
                else {
                    if ($(this).closest('tr').find("td:eq(2) input").val() > 1) {
                        isone = 0;
                        $(this).closest('tr').find("td:eq(2) input").val(parseInt($(this).closest('tr').find("td:eq(2) input").val()) - 1);
                    }
                    else if ($(this).closest('tr').find("td:eq(2) input").val() == 1) {
                        isone = 1;
                    }
                    isplus = 0;
                    isminus = 1;
                }
                $(this).closest('tr').find("td:eq(2) input").trigger('change');
                $(this).addClass('selected_grey');
            }
        });
    }



    function DisCountHdAll() {
        var customers = new Array();

        $("#tbllistOrderDetail1 TBODY TR").each(function () {
            var row = $(this);
            var customer = {};
            customer.ProductId = $(this).closest('tr').find("td:eq(1) input").val();
            customer.Quantity = $(this).closest('tr').find("td:eq(2) input").val();
            customer.Price = $(this).closest('tr').find("td:eq(3) input").val();
            //customer.PromotionId = row.find("TD").eq(4).html();
            //customer.PromotionDetailId = row.find("TD").eq(5).html();
            //customer.PromotionValue = row.find("TD").eq(6).html();
            customer.IrregularDiscountAmount = $(this).closest('tr').find("td:eq(4) input").val();

            customers.push(customer);
        });
        return customers
    };
    function Savetab1OK(jsonData) {
        //debugger

        var customers = new Array();
        if (tab3 == 0 && tab1 == 1 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
            $("#tbllistOrderDetail1 TBODY TR").each(function () {
                var row = $(this);
                var customer = {};
                customer.ProductId = $(this).closest('tr').find("td:eq(1) input").val();
                customer.Quantity = $(this).closest('tr').find("td:eq(2) input").val();
                customer.Price = removeComma($(this).closest('tr').find("td:eq(3) input").val());
                customer.IrregularDiscount = $(this).closest('tr').find("td:eq(4) input:nth-child(1)").val();

                //alert($(this).closest('tr').find("td:eq(6) input:hidden").val());
                //alert($(this).closest('tr').find("td:eq(7) input:hidden").val());
                //alert($(this).closest('tr').find("td:eq(8) input:hidden").val());
                //alert($(this).closest('tr').find("td:eq(9) input:hidden").val());

                customer.IsMoney = $(this).closest('tr').find("td:eq(6) input:hidden").val();
                customer.PromotionId = $(this).closest('tr').find("td:eq(7) input:hidden").val();
                customer.PromotionDetailId = $(this).closest('tr').find("td:eq(8) input:hidden").val();
                customer.PromotionValue = $(this).closest('tr').find("td:eq(9) input:hidden").val();


                var tmpdiscountchild = $(this).closest('tr').find("td:eq(4) input:nth-child(2)").val();
                customer.IrregularDiscountAmount = removeComma(tmpdiscountchild);


                customers.push(customer);
            });

            var DiscountTab = $("#Tab1Discount").val();
            var hinhthuctt = $("#hinhthuctttab1").val();
            var tataltab = removeComma($("#Tab1Total").val());
            var customerId = $("#CustomerId1").val();
            var noteHDtab = $("#noteHD1").val();
            if (customerId === "" || customerId === null) {
                customerId = "0";
            }
            var ATMPaytab = removeComma($("#ATM1").val());
            var TransferPaytab = removeComma($("#Transfer1").val());
            if (ATMPaytab === "" || ATMPaytab === null) {
                ATMPaytab = 0;
            }

            if (TransferPaytab === "" || TransferPaytab === null) {
                TransferPaytab = 0;
            }
            var isDisAll = $("#isDiscountAll1").val();
            var DisAll = $("#DiscountAll1").val();
            var MoneyPaytab =  removeComma($("#Money1").val());
            if (MoneyPaytab === "" || MoneyPaytab === null) {
                MoneyPaytab = 0;
            }


        } else if (tab3 == 0 && tab1 == 0 && tab2 == 1 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
            $("#tbllistOrderDetail2 TBODY TR").each(function () {
                var row = $(this);
                var customer = {};
                customer.ProductId = $(this).closest('tr').find("td:eq(1) input").val();
                customer.Quantity = $(this).closest('tr').find("td:eq(2) input").val();
                customer.Price = removeComma($(this).closest('tr').find("td:eq(3) input").val());
                //customer.PromotionId = row.find("TD").eq(4).html();
                //customer.PromotionDetailId = row.find("TD").eq(5).html();
                //customer.PromotionValue = row.find("TD").eq(6).html();
                //customer.IrregularDiscount = $(this).closest('tr').find("td:eq(4) input:first").val();
                customer.IrregularDiscount = $(this).closest('tr').find("td:eq(4) input:nth-child(1)").val();
                var tmpdiscountchild = $(this).closest('tr').find("td:eq(4) input:nth-child(2)").val();
                customer.IrregularDiscountAmount = removeComma(tmpdiscountchild);

                customer.IsMoney = $(this).closest('tr').find("td:eq(6) input:hidden").val();
                customer.PromotionId = $(this).closest('tr').find("td:eq(7) input:hidden").val();
                customer.PromotionDetailId = $(this).closest('tr').find("td:eq(8) input:hidden").val();
                customer.PromotionValue = $(this).closest('tr').find("td:eq(9) input:hidden").val();


                customers.push(customer);
            });

            var DiscountTab = $("#Tab2Discount").val();
            var hinhthuctt = $("#hinhthuctttab2").val();
            var tataltab = removeComma($("#Tab2Total").val());
            var customerId = $("#CustomerId2").val();
            var noteHDtab = $("#noteHD2").val();
            if (customerId === "" || customerId === null) {
                customerId = 0;
            }
            var ATMPaytab = removeComma($("#ATM2").val());
            var TransferPaytab = removeComma($("#Transfer2").val());
            if (ATMPaytab === "" || ATMPaytab === null) {
                ATMPaytab = 0;
            }
            if (TransferPaytab === "" || TransferPaytab === null) {
                TransferPaytab = 0;
            }
            var MoneyPaytab =  removeComma($("#Money2").val());

            if (MoneyPaytab === "" || MoneyPaytab === null) {
                MoneyPaytab = 0;
            }

            var isDisAll = $("#isDiscountAll2").val();
            var DisAll = $("#DiscountAll2").val();

        } else if (tab3 == 1 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
            $("#tbllistOrderDetail3 TBODY TR").each(function () {
                var row = $(this);
                var customer = {};
                customer.ProductId = $(this).closest('tr').find("td:eq(1) input").val();
                customer.Quantity = $(this).closest('tr').find("td:eq(2) input").val();
                customer.Price = removeComma($(this).closest('tr').find("td:eq(3) input").val());
                //customer.PromotionId = row.find("TD").eq(4).html();
                //customer.PromotionDetailId = row.find("TD").eq(5).html();
                //customer.PromotionValue = row.find("TD").eq(6).html();
                customer.IrregularDiscount = $(this).closest('tr').find("td:eq(4) input:nth-child(1)").val();
                var tmpdiscountchild = $(this).closest('tr').find("td:eq(4) input:nth-child(2)").val();
                customer.IrregularDiscountAmount = removeComma(tmpdiscountchild);

                customer.IsMoney = $(this).closest('tr').find("td:eq(6) input:hidden").val();
                customer.PromotionId = $(this).closest('tr').find("td:eq(7) input:hidden").val();
                customer.PromotionDetailId = $(this).closest('tr').find("td:eq(8) input:hidden").val();
                customer.PromotionValue = $(this).closest('tr').find("td:eq(9) input:hidden").val();


                customers.push(customer);
            });
            var DiscountTab = $("#Tab3Discount").val();
            var hinhthuctt = $("#hinhthuctttab3").val();
            var tataltab = removeComma($("#Tab3Total").val());
            var customerId = $("#CustomerId3").val();
            var noteHDtab = $("#noteHD3").val();
            if (customerId === "" || customerId === null) {
                customerId = 0;
            }
            var ATMPaytab = removeComma($("#ATM3").val());
            var TransferPaytab = removeComma($("#Transfer3").val());
            if (ATMPaytab === "" || ATMPaytab === null) {
                ATMPaytab = 0;
            }
            if (TransferPaytab === "" || TransferPaytab === null) {
                TransferPaytab = 0;
            }
            var MoneyPaytab =  removeComma($("#Money3").val());

            if (MoneyPaytab === "" || MoneyPaytab === null) {
                MoneyPaytab = 0;
            }

            var DisAll = $("#DiscountAll3").val();
        } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 1 && tab5 == 0 && tab6 == 0) {
            $("#tbllistOrderDetail4 TBODY TR").each(function () {
                var row = $(this);
                var customer = {};
                customer.ProductId = $(this).closest('tr').find("td:eq(1) input").val();
                customer.Quantity = $(this).closest('tr').find("td:eq(2) input").val();
                customer.Price = removeComma($(this).closest('tr').find("td:eq(3) input").val());
                //customer.PromotionId = row.find("TD").eq(4).html();
                //customer.PromotionDetailId = row.find("TD").eq(5).html();
                //customer.PromotionValue = row.find("TD").eq(6).html();
                customer.IrregularDiscount = $(this).closest('tr').find("td:eq(4) input:nth-child(1)").val();
                var tmpdiscountchild = $(this).closest('tr').find("td:eq(4) input:nth-child(2)").val();
                customer.IrregularDiscountAmount = removeComma(tmpdiscountchild);

                customer.IsMoney = $(this).closest('tr').find("td:eq(6) input:hidden").val();
                customer.PromotionId = $(this).closest('tr').find("td:eq(7) input:hidden").val();
                customer.PromotionDetailId = $(this).closest('tr').find("td:eq(8) input:hidden").val();
                customer.PromotionValue = $(this).closest('tr').find("td:eq(9) input:hidden").val();


                customers.push(customer);
            });

            var DiscountTab = $("#Tab3Discount").val();
            var hinhthuctt = $("#hinhthuctttab4").val();
            var tataltab = removeComma($("#Tab4Total").val());
            var customerId = $("#CustomerId4").val();
            var noteHDtab = $("#noteHD4").val();
            if (customerId === "" || customerId === null) {
                customerId = 0;
            }
            var ATMPaytab = removeComma($("#ATM4").val());
            var TransferPaytab = removeComma($("#Transfer4").val());
            if (ATMPaytab === "" || ATMPaytab === null) {
                ATMPaytab = 0;
            }
            if (TransferPaytab === "" || TransferPaytab === null) {
                TransferPaytab = 0;
            }
            var MoneyPaytab =  removeComma($("#Money4").val());
            if (MoneyPaytab === "" || MoneyPaytab === null) {
                MoneyPaytab = 0;
            }


            var isDisAll = $("#isDiscountAll4").val();
            var DisAll = $("#DiscountAll4").val();
        } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 1 && tab6 == 0) {
            $("#tbllistOrderDetail5 TBODY TR").each(function () {
                var row = $(this);
                var customer = {};
                customer.ProductId = $(this).closest('tr').find("td:eq(1) input").val();
                customer.Quantity = $(this).closest('tr').find("td:eq(2) input").val();
                customer.Price = removeComma($(this).closest('tr').find("td:eq(3) input").val());
                //customer.PromotionId = row.find("TD").eq(4).html();
                //customer.PromotionDetailId = row.find("TD").eq(5).html();
                //customer.PromotionValue = row.find("TD").eq(6).html();
                customer.IrregularDiscount = $(this).closest('tr').find("td:eq(4) input:nth-child(1)").val();
                var tmpdiscountchild = $(this).closest('tr').find("td:eq(4) input:nth-child(2)").val();
                customer.IrregularDiscountAmount = removeComma(tmpdiscountchild);

                customer.IsMoney = $(this).closest('tr').find("td:eq(6) input:hidden").val();
                customer.PromotionId = $(this).closest('tr').find("td:eq(7) input:hidden").val();
                customer.PromotionDetailId = $(this).closest('tr').find("td:eq(8) input:hidden").val();
                customer.PromotionValue = $(this).closest('tr').find("td:eq(9) input:hidden").val();


                customers.push(customer);
            });

            var DiscountTab = $("#Tab5Discount").val();
            var hinhthuctt = $("#hinhthuctttab5").val();
            var tataltab = removeComma($("#Tab5Total").val());
            var customerId = $("#CustomerId5").val();
            var noteHDtab = $("#noteHD5").val();
            if (customerId === "" || customerId === null) {
                customerId = 0;
            }
            var ATMPaytab = removeComma($("#ATM5").val());
            var TransferPaytab = removeComma($("#Transfer5").val());
            if (ATMPaytab === "" || ATMPaytab === null) {
                ATMPaytab = 0;
            }
            if (TransferPaytab === "" || TransferPaytab === null) {
                TransferPaytab = 0;
            }
            var MoneyPaytab =  removeComma($("#Money5").val());

            if (MoneyPaytab === "" || MoneyPaytab === null) {
                MoneyPaytab = 0;
            }

            var isDisAll = $("#isDiscountAll5").val();
            var DisAll = $("#DiscountAll5").val();
        } else {
            $("#tbllistOrderDetail6 TBODY TR").each(function () {
                var row = $(this);
                var customer = {};
                customer.ProductId = $(this).closest('tr').find("td:eq(1) input").val();
                customer.Quantity = $(this).closest('tr').find("td:eq(2) input").val();
                customer.Price = removeComma($(this).closest('tr').find("td:eq(3) input").val());
                //customer.PromotionId = row.find("TD").eq(4).html();
                //customer.PromotionDetailId = row.find("TD").eq(5).html();
                //customer.PromotionValue = row.find("TD").eq(6).html();
                customer.IrregularDiscount = $(this).closest('tr').find("td:eq(4) input:nth-child(1)").val();
                var tmpdiscountchild = $(this).closest('tr').find("td:eq(4) input:nth-child(2)").val();
                customer.IrregularDiscountAmount = removeComma(tmpdiscountchild);

                customer.IsMoney = $(this).closest('tr').find("td:eq(6) input:hidden").val();
                customer.PromotionId = $(this).closest('tr').find("td:eq(7) input:hidden").val();
                customer.PromotionDetailId = $(this).closest('tr').find("td:eq(8) input:hidden").val();
                customer.PromotionValue = $(this).closest('tr').find("td:eq(9) input:hidden").val();


                customers.push(customer);
            });

            var DiscountTab = $("#Tab6Discount").val();
            var hinhthuctt = $("#hinhthuctttab6").val();
            var tataltab = removeComma($("#Tab6Total").val());
            var customerId = $("#CustomerId6").val();
            var noteHDtab = $("#noteHD6").val();
            if (customerId === "" || customerId === null) {
                customerId = 0;
            }
            var ATMPaytab = removeComma($("#ATM6").val());
            var TransferPaytab = removeComma($("#Transfer6").val());
            if (ATMPaytab === "" || ATMPaytab === null) {
                ATMPaytab = 0;
            }
            if (TransferPaytab === "" || TransferPaytab === null) {
                TransferPaytab = 0;
            }
            var MoneyPaytab =  removeComma($("#Money6").val());

            if (MoneyPaytab === "" || MoneyPaytab === null) {
                MoneyPaytab = 0;
            }

            var isDisAll = $("#isDiscountAll6").val();
            var DisAll = $("#DiscountAll6").val();
        }
        if (customers.length == 0) {
            $("#danger-alert").fadeTo(2000, 500).slideUp(500, function () {
                $("#danger-alert").slideUp(500);
            });
            keydown = false;
            return;
        }
        var notPrint = true;
        var ChangeM_de = $("#ChangeMoney").val() + "";
        var ChangeM_str = ChangeM_de.split(".");
        var ChangeM_int = ChangeM_str[0] * 1;
        if (ChangeM_int < 0) {
            ShowLoading();
            $.ajax({
                type: "POST",
                url: "/ProductInvoice/Checkdebtsales",
                data: JSON.stringify(),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (r) {
                    if (r == 0) {
                        keydown = false;
                        $("#danger-alert2").fadeTo(2000, 500).slideUp(500, function () {
                            removeData(TabTemp);
                            var thattab = document.getElementById("popup_Pay");
                            thattab.style.display = "none";
                            $("#danger-alert2").slideUp(500);
                        });
                    }
                    else {
                        ShowLoading();
                        $.ajax({
                            type: "POST",
                            url: "/ProductInvoice/CreatePOSIn",
                            data: JSON.stringify({ listsp: customers, customerId: customerId, DiscountTab: DiscountTab, Hinhthuctt: hinhthuctt, MoneyPayTab: MoneyPaytab, ATMPayTab: ATMPaytab, TransferPayTab: TransferPaytab, IsDisAll: isDisAll, DiscountAll: DisAll, NoteHDtab: noteHDtab, NotPrint: notPrint }),
                            contentType: "application/json; charset=utf-8",
                            dataType: "json",
                            success: function (r) {
                                var TabTemp;
                                HideLoading();
                                keydown = false;
                                if (r == "1") {
                                    $("#success-alert").fadeTo(2000, 500).slideUp(500, function () {
                                        $("#success-alert").slideUp(500);
                                    });
                                    if (tab3 == 0 && tab1 == 1 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                                        TabTemp = 1;
                                    } else if (tab3 == 0 && tab1 == 0 && tab2 == 1 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                                        TabTemp = 2;
                                    } else if (tab3 == 1 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                                        TabTemp = 3;
                                    } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 1 && tab5 == 0 && tab6 == 0) {
                                        TabTemp = 4;
                                    } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 1 && tab6 == 0) {
                                        TabTemp = 5;
                                    } else {
                                        TabTemp = 6;
                                    }

                                    removeData(TabTemp);
                                    ExitPopupPay();
                                    var thattab = document.getElementById("popup_Pay");
                                    thattab.style.display = "none";
                                } else {
                                    $("#danger-alert").fadeTo(2000, 500).slideUp(500, function () {
                                        removeData(TabTemp);
                                        var thattab = document.getElementById("popup_Pay");
                                        thattab.style.display = "none";
                                        $("#danger-alert").slideUp(500);
                                        keydown = false;
                                    });
                                }
                            },
                            error: function (xhr, ajaxOptions, thrownError) {
                                HideLoading();
                                keydown = false;
                                $("#danger-alert").fadeTo(2000, 500).slideUp(500, function () {
                                    $("#danger-alert").slideUp(500);
                                });
                            }
                        });
                    }
                }
            });
        } else {
            ShowLoading();
            $.ajax({
                type: "POST",
                url: "/ProductInvoice/CreatePOSIn",
                data: JSON.stringify({ listsp: customers, customerId: customerId, DiscountTab: DiscountTab, Hinhthuctt: hinhthuctt, MoneyPayTab: MoneyPaytab, ATMPayTab: ATMPaytab, TransferPayTab: TransferPaytab, IsDisAll: isDisAll, DiscountAll: DisAll, NoteHDtab: noteHDtab, NotPrint: notPrint }),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (r) {
                    var TabTemp;
                    HideLoading();
                    keydown = false;
                    if (r == "1") {
                        $("#success-alert").fadeTo(2000, 500).slideUp(500, function () {
                            $("#success-alert").slideUp(500);
                        });
                        if (tab3 == 0 && tab1 == 1 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                            TabTemp = 1;
                        } else if (tab3 == 0 && tab1 == 0 && tab2 == 1 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                            TabTemp = 2;
                        } else if (tab3 == 1 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                            TabTemp = 3;
                        } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 1 && tab5 == 0 && tab6 == 0) {
                            TabTemp = 4;
                        } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 1 && tab6 == 0) {
                            TabTemp = 5;
                        } else {
                            TabTemp = 6;
                        }

                        removeData(TabTemp);
                        ExitPopupPay();
                        var thattab = document.getElementById("popup_Pay");
                        thattab.style.display = "none";
                    } else {
                        $("#danger-alert").fadeTo(2000, 500).slideUp(500, function () {
                            removeData(TabTemp);
                            var thattab = document.getElementById("popup_Pay");
                            thattab.style.display = "none";
                            $("#danger-alert").slideUp(500);
                            keydown = false;
                        });
                    }
                },
                error: function (xhr, ajaxOptions, thrownError) {
                    keydown = false;
                    HideLoading();
                    $("#danger-alert").fadeTo(2000, 500).slideUp(500, function () {
                        $("#danger-alert").slideUp(500);
                    });
                }
            });
        }
        //alert(customerId);
        //Load lại tồn kho Imgdata
        GetPageData($('.page-number').html());
        //Load lại tồn kho SelectList
        //$.get('/ProductInvoice/SearchProductInvoice3', function (html) {
        //    $("#Search_Product3").html(html);
        //});
        //var combo = $find(rcb_1_RadComboBox);
        //combo.requestItems();


    }
    function Savetab1OKIn(jsonData) {

        //bodymainNT.style.display = "none";
        //$("#buttonmenu").css('display', 'none');
        //$("#footerPOS").css('display', 'none');
        //var DIVHD = document.getElementById("Search_Product8");
        //DIVHD.style.display = "block";
        //// Get the modal
        //var modal = document.getElementById("myModal");

        //// Get the button that opens the modal
        //var btn = document.getElementById("savetab1");

        //// Get the <span> element that closes the modal
        //var span = document.getElementsByClassName("close")[0];

        //// When the user clicks the button, open the modal

        //modal.style.display = "block";


        //// When the user clicks on <span> (x), close the modal
        //span.onclick = function () {
        //    modal.style.display = "none";
        //}

        //// When the user clicks anywhere outside of the modal, close it
        //window.onclick = function (event) {
        //    if (event.target == modal) {
        //        modal.style.display = "none";
        //    }
        //}


        var customers = new Array();
        if (tab3 == 0 && tab1 == 1 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
            $("#tbllistOrderDetail1 TBODY TR").each(function () {
                var row = $(this);
                var customer = {};
                customer.ProductId = $(this).closest('tr').find("td:eq(1) input").val();
                customer.Quantity = $(this).closest('tr').find("td:eq(2) input").val();
                customer.Price = removeComma($(this).closest('tr').find("td:eq(3) input").val());
                customer.IrregularDiscount = $(this).closest('tr').find("td:eq(4) input:nth-child(1)").val();

                //alert($(this).closest('tr').find("td:eq(6) input:hidden").val());
                //alert($(this).closest('tr').find("td:eq(7) input:hidden").val());
                //alert($(this).closest('tr').find("td:eq(8) input:hidden").val());
                //alert($(this).closest('tr').find("td:eq(9) input:hidden").val());

                customer.IsMoney = $(this).closest('tr').find("td:eq(6) input:hidden").val();
                customer.PromotionId = $(this).closest('tr').find("td:eq(7) input:hidden").val();
                customer.PromotionDetailId = $(this).closest('tr').find("td:eq(8) input:hidden").val();
                customer.PromotionValue = $(this).closest('tr').find("td:eq(9) input:hidden").val();


                var tmpdiscountchild = $(this).closest('tr').find("td:eq(4) input:nth-child(2)").val();
                customer.IrregularDiscountAmount = removeComma(tmpdiscountchild);


                customers.push(customer);
            });

            var DiscountTab = $("#Tab1Discount").val();
            var hinhthuctt = $("#hinhthuctttab1").val();
            var tataltab = removeComma($("#Tab1Total").val());
            var customerId = $("#CustomerId1").val();
            var noteHDtab = $("#noteHD1").val();
            if (customerId === "" || customerId === null) {
                customerId = "0";
            }
            var ATMPaytab = removeComma($("#ATM1").val());
            var TransferPaytab = removeComma($("#Transfer1").val());
            if (ATMPaytab === "" || ATMPaytab === null) {
                ATMPaytab = 0;
            }

            if (TransferPaytab === "" || TransferPaytab === null) {
                TransferPaytab = 0;
            }
            var isDisAll = $("#isDiscountAll1").val();
            var DisAll = $("#DiscountAll1").val();
            var MoneyPaytab =  removeComma($("#Money1").val());

            if (MoneyPaytab === "" || MoneyPaytab === null) {
                MoneyPaytab = 0;
            }


        } else if (tab3 == 0 && tab1 == 0 && tab2 == 1 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
            $("#tbllistOrderDetail2 TBODY TR").each(function () {
                var row = $(this);
                var customer = {};
                customer.ProductId = $(this).closest('tr').find("td:eq(1) input").val();
                customer.Quantity = $(this).closest('tr').find("td:eq(2) input").val();
                customer.Price = removeComma($(this).closest('tr').find("td:eq(3) input").val());
                //customer.PromotionId = row.find("TD").eq(4).html();
                //customer.PromotionDetailId = row.find("TD").eq(5).html();
                //customer.PromotionValue = row.find("TD").eq(6).html();
                //customer.IrregularDiscount = $(this).closest('tr').find("td:eq(4) input:first").val();
                customer.IrregularDiscount = $(this).closest('tr').find("td:eq(4) input:nth-child(1)").val();
                var tmpdiscountchild = $(this).closest('tr').find("td:eq(4) input:nth-child(2)").val();
                customer.IrregularDiscountAmount = removeComma(tmpdiscountchild);

                customer.IsMoney = $(this).closest('tr').find("td:eq(6) input:hidden").val();
                customer.PromotionId = $(this).closest('tr').find("td:eq(7) input:hidden").val();
                customer.PromotionDetailId = $(this).closest('tr').find("td:eq(8) input:hidden").val();
                customer.PromotionValue = $(this).closest('tr').find("td:eq(9) input:hidden").val();


                customers.push(customer);
            });

            var DiscountTab = $("#Tab2Discount").val();
            var hinhthuctt = $("#hinhthuctttab2").val();
            var tataltab = removeComma($("#Tab2Total").val());
            var customerId = $("#CustomerId2").val();
            var noteHDtab = $("#noteHD2").val();
            if (customerId === "" || customerId === null) {
                customerId = 0;
            }
            var ATMPaytab = removeComma($("#ATM2").val());
            var TransferPaytab = removeComma($("#Transfer2").val());
            if (ATMPaytab === "" || ATMPaytab === null) {
                ATMPaytab = 0;
            }
            if (TransferPaytab === "" || TransferPaytab === null) {
                TransferPaytab = 0;
            }
            var MoneyPaytab =  removeComma($("#Money2").val());

            if (MoneyPaytab === "" || MoneyPaytab === null) {
                MoneyPaytab = 0;
            }

            var isDisAll = $("#isDiscountAll2").val();
            var DisAll = $("#DiscountAll2").val();

        } else if (tab3 == 1 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
            $("#tbllistOrderDetail3 TBODY TR").each(function () {
                var row = $(this);
                var customer = {};
                customer.ProductId = $(this).closest('tr').find("td:eq(1) input").val();
                customer.Quantity = $(this).closest('tr').find("td:eq(2) input").val();
                customer.Price = removeComma($(this).closest('tr').find("td:eq(3) input").val());
                //customer.PromotionId = row.find("TD").eq(4).html();
                //customer.PromotionDetailId = row.find("TD").eq(5).html();
                //customer.PromotionValue = row.find("TD").eq(6).html();
                customer.IrregularDiscount = $(this).closest('tr').find("td:eq(4) input:nth-child(1)").val();
                var tmpdiscountchild = $(this).closest('tr').find("td:eq(4) input:nth-child(2)").val();
                customer.IrregularDiscountAmount = removeComma(tmpdiscountchild);

                customer.IsMoney = $(this).closest('tr').find("td:eq(6) input:hidden").val();
                customer.PromotionId = $(this).closest('tr').find("td:eq(7) input:hidden").val();
                customer.PromotionDetailId = $(this).closest('tr').find("td:eq(8) input:hidden").val();
                customer.PromotionValue = $(this).closest('tr').find("td:eq(9) input:hidden").val();


                customers.push(customer);
            });

            var DiscountTab = $("#Tab3Discount").val();
            var hinhthuctt = $("#hinhthuctttab3").val();
            var tataltab = removeComma($("#Tab3Total").val());
            var customerId = $("#CustomerId3").val();
            var noteHDtab = $("#noteHD3").val();
            if (customerId === "" || customerId === null) {
                customerId = 0;
            }
            var ATMPaytab = removeComma($("#ATM3").val());
            var TransferPaytab = removeComma($("#Transfer3").val());
            if (ATMPaytab === "" || ATMPaytab === null) {
                ATMPaytab = 0;
            }
            if (TransferPaytab === "" || TransferPaytab === null) {
                TransferPaytab = 0;
            }
            var MoneyPaytab =  removeComma($("#Money3").val());

            if (MoneyPaytab === "" || MoneyPaytab === null) {
                MoneyPaytab = 0;
            }

            var isDisAll = $("#isDiscountAll3").val();
            var DisAll = $("#DiscountAll3").val();
        } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 1 && tab5 == 0 && tab6 == 0) {
            $("#tbllistOrderDetail4 TBODY TR").each(function () {
                var row = $(this);
                var customer = {};
                customer.ProductId = $(this).closest('tr').find("td:eq(1) input").val();
                customer.Quantity = $(this).closest('tr').find("td:eq(2) input").val();
                customer.Price = removeComma($(this).closest('tr').find("td:eq(3) input").val());
                //customer.PromotionId = row.find("TD").eq(4).html();
                //customer.PromotionDetailId = row.find("TD").eq(5).html();
                //customer.PromotionValue = row.find("TD").eq(6).html();
                customer.IrregularDiscount = $(this).closest('tr').find("td:eq(4) input:nth-child(1)").val();
                var tmpdiscountchild = $(this).closest('tr').find("td:eq(4) input:nth-child(2)").val();
                customer.IrregularDiscountAmount = removeComma(tmpdiscountchild);

                customer.IsMoney = $(this).closest('tr').find("td:eq(6) input:hidden").val();
                customer.PromotionId = $(this).closest('tr').find("td:eq(7) input:hidden").val();
                customer.PromotionDetailId = $(this).closest('tr').find("td:eq(8) input:hidden").val();
                customer.PromotionValue = $(this).closest('tr').find("td:eq(9) input:hidden").val();


                customers.push(customer);
            });

            var DiscountTab = $("#Tab4Discount").val();
            var hinhthuctt = $("#hinhthuctttab4").val();
            var tataltab = removeComma($("#Tab4Total").val());
            var customerId = $("#CustomerId4").val();
            var noteHDtab = $("#noteHD4").val();
            if (customerId === "" || customerId === null) {
                customerId = 0;
            }
            var ATMPaytab = removeComma($("#ATM4").val());
            var TransferPaytab = removeComma($("#Transfer4").val());
            if (ATMPaytab === "" || ATMPaytab === null) {
                ATMPaytab = 0;
            }
            if (TransferPaytab === "" || TransferPaytab === null) {
                TransferPaytab = 0;
            }
            var MoneyPaytab =  removeComma($("#Money4").val());

            if (MoneyPaytab === "" || MoneyPaytab === null) {
                MoneyPaytab = 0;
            }

            var isDisAll = $("#isDiscountAll4").val();
            var DisAll = $("#DiscountAll4").val();
        } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 1 && tab6 == 0) {
            $("#tbllistOrderDetail5 TBODY TR").each(function () {
                var row = $(this);
                var customer = {};
                customer.ProductId = $(this).closest('tr').find("td:eq(1) input").val();
                customer.Quantity = $(this).closest('tr').find("td:eq(2) input").val();
                customer.Price = removeComma($(this).closest('tr').find("td:eq(3) input").val());
                //customer.PromotionId = row.find("TD").eq(4).html();
                //customer.PromotionDetailId = row.find("TD").eq(5).html();
                //customer.PromotionValue = row.find("TD").eq(6).html();
                customer.IrregularDiscount = $(this).closest('tr').find("td:eq(4) input:nth-child(1)").val();
                var tmpdiscountchild = $(this).closest('tr').find("td:eq(4) input:nth-child(2)").val();
                customer.IrregularDiscountAmount = removeComma(tmpdiscountchild);

                customer.IsMoney = $(this).closest('tr').find("td:eq(6) input:hidden").val();
                customer.PromotionId = $(this).closest('tr').find("td:eq(7) input:hidden").val();
                customer.PromotionDetailId = $(this).closest('tr').find("td:eq(8) input:hidden").val();
                customer.PromotionValue = $(this).closest('tr').find("td:eq(9) input:hidden").val();


                customers.push(customer);
            });

            var DiscountTab = $("#Tab5Discount").val();
            var hinhthuctt = $("#hinhthuctttab5").val();
            var tataltab = removeComma($("#Tab5Total").val());
            var customerId = $("#CustomerId5").val();
            var noteHDtab = $("#noteHD5").val();
            if (customerId === "" || customerId === null) {
                customerId = 0;
            }
            var ATMPaytab = removeComma($("#ATM5").val());
            var TransferPaytab = removeComma($("#Transfer5").val());
            if (ATMPaytab === "" || ATMPaytab === null) {
                ATMPaytab = 0;
            }
            if (TransferPaytab === "" || TransferPaytab === null) {
                TransferPaytab = 0;
            }
            var MoneyPaytab =  removeComma($("#Money5").val());

            if (MoneyPaytab === "" || MoneyPaytab === null) {
                MoneyPaytab = 0;
            }

            var isDisAll = $("#isDiscountAll5").val();
            var DisAll = $("#DiscountAll5").val();
        } else {
            $("#tbllistOrderDetail6 TBODY TR").each(function () {
                var row = $(this);
                var customer = {};
                customer.ProductId = $(this).closest('tr').find("td:eq(1) input").val();
                customer.Quantity = $(this).closest('tr').find("td:eq(2) input").val();
                customer.Price = removeComma($(this).closest('tr').find("td:eq(3) input").val());
                //customer.PromotionId = row.find("TD").eq(4).html();
                //customer.PromotionDetailId = row.find("TD").eq(5).html();
                //customer.PromotionValue = row.find("TD").eq(6).html();
                customer.IrregularDiscount = $(this).closest('tr').find("td:eq(4) input:nth-child(1)").val();
                var tmpdiscountchild = $(this).closest('tr').find("td:eq(4) input:nth-child(2)").val();
                customer.IrregularDiscountAmount = removeComma(tmpdiscountchild);

                customer.IsMoney = $(this).closest('tr').find("td:eq(6) input:hidden").val();
                customer.PromotionId = $(this).closest('tr').find("td:eq(7) input:hidden").val();
                customer.PromotionDetailId = $(this).closest('tr').find("td:eq(8) input:hidden").val();
                customer.PromotionValue = $(this).closest('tr').find("td:eq(9) input:hidden").val();


                customers.push(customer);
            });

            var DiscountTab = $("#Tab6Discount").val();
            var hinhthuctt = $("#hinhthuctttab6").val();
            var tataltab = removeComma($("#Tab6Total").val());
            var customerId = $("#CustomerId6").val();
            var noteHDtab = $("#noteHD6").val();
            if (customerId === "" || customerId === null) {
                customerId = 0;
            }
            var ATMPaytab = removeComma($("#ATM6").val());
            var TransferPaytab = removeComma($("#Transfer6").val());
            if (ATMPaytab === "" || ATMPaytab === null) {
                ATMPaytab = 0;
            }
            if (TransferPaytab === "" || TransferPaytab === null) {
                TransferPaytab = 0;
            }
            var MoneyPaytab =  removeComma($("#Money6").val());

            if (MoneyPaytab === "" || MoneyPaytab === null) {
                MoneyPaytab = 0;
            }

            var isDisAll = $("#isDiscountAll6").val();
            var DisAll = $("#DiscountAll6").val();
        }
        if (customers.length == 0) {
            $("#danger-alert").fadeTo(2000, 500).slideUp(500, function () {
                $("#danger-alert").slideUp(500);
            });
            keydown = false;
            return;
        }
        var notPrint = false;
        var ChangeM_de = $("#ChangeMoney").val() + "";
        var ChangeM_str = ChangeM_de.split(".");
        var ChangeM_int = ChangeM_str[0] * 1;
        if (ChangeM_int < 0) {
            ShowLoading();
            $.ajax({
                type: "POST",
                url: "/ProductInvoice/Checkdebtsales",
                data: JSON.stringify(),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (r) {
                    if (r == 0) {
                        keydown = false;
                        $("#danger-alert2").fadeTo(2000, 500).slideUp(500, function () {
                            removeData(TabTemp);
                            var thattab = document.getElementById("popup_Pay");
                            thattab.style.display = "none";
                            $("#danger-alert2").slideUp(500);
                        });
                    }
                    else {
                        ShowLoading();
                        $.ajax({
                            type: "POST",
                            url: "/ProductInvoice/CreatePOSIn",
                            data: JSON.stringify({ listsp: customers, customerId: customerId, DiscountTab: DiscountTab, Hinhthuctt: hinhthuctt, MoneyPayTab: MoneyPaytab, ATMPayTab: ATMPaytab, TransferPayTab: TransferPaytab, IsDisAll: isDisAll, DiscountAll: DisAll, NoteHDtab: noteHDtab, NotPrint: notPrint }),
                            contentType: "application/json; charset=utf-8",
                            dataType: "json",
                            success: function (r) {
                                var TabTemp;
                                keydown = false;
                                HideLoading();
                                if (r == 1) {
                                    if (tab3 == 0 && tab1 == 1 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                                        TabTemp = 1;
                                    } else if (tab3 == 0 && tab1 == 0 && tab2 == 1 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                                        TabTemp = 2;
                                    } else if (tab3 == 1 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                                        TabTemp = 3;
                                    } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 1 && tab5 == 0 && tab6 == 0) {
                                        TabTemp = 4;
                                    } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 1 && tab6 == 0) {
                                        TabTemp = 5;
                                    } else {
                                        TabTemp = 6;
                                    }
                                    removeData(TabTemp);
                                    ExitPopupPay();
                                    var thattab = document.getElementById("popup_Pay");
                                    thattab.style.display = "none";
                                }
                                else if (r != "0") {
                                    //$("#success-alert").fadeTo(2000, 500).slideUp(500, function () {
                                    //    $("#success-alert").slideUp(500);
                                    //});
                                    if (tab3 == 0 && tab1 == 1 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                                        TabTemp = 1;
                                    } else if (tab3 == 0 && tab1 == 0 && tab2 == 1 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                                        TabTemp = 2;
                                    } else if (tab3 == 1 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                                        TabTemp = 3;
                                    } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 1 && tab5 == 0 && tab6 == 0) {
                                        TabTemp = 4;
                                    } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 1 && tab6 == 0) {
                                        TabTemp = 5;
                                    } else {
                                        TabTemp = 6;
                                    }
                                    removeData(TabTemp);
                                    var thattab = document.getElementById("popup_Pay");
                                    thattab.style.display = "none";
                                    ShowLoading();
                                    //$.get('/ProductInvoice/PrintNT?Id=' + r + '&ExportExcel=false', function (html) {

                                    //    $('.listsearch8').show();
                                    //    $("#Search_Product8").html(html);

                                    //});
                                    OpenPopup('/ProductInvoice/PrintNT?Id=' + r + '&ExportExcel=false', 'Tìm kiếm dữ liệu', 300, 300);
                                    $(".close").trigger('click');
                                    HideLoading();
                                } else {
                                    $("#danger-alert").fadeTo(2000, 500).slideUp(500, function () {
                                        removeData(TabTemp);
                                        var thattab = document.getElementById("popup_Pay");
                                        thattab.style.display = "none";
                                        $("#danger-alert").slideUp(500);
                                    });
                                }
                            },
                            error: function (xhr, ajaxOptions, thrownError) {
                                HideLoading();
                                keydown = false;
                                $("#danger-alert").fadeTo(2000, 500).slideUp(500, function () {
                                    $("#danger-alert").slideUp(500);
                                });
                            }
                        });
                    }
                }
            });
        } else {
            ShowLoading();
            $.ajax({
                type: "POST",
                url: "/ProductInvoice/CreatePOSIn",
                data: JSON.stringify({ listsp: customers, customerId: customerId, DiscountTab: DiscountTab, Hinhthuctt: hinhthuctt, MoneyPayTab: MoneyPaytab, ATMPayTab: ATMPaytab, TransferPayTab: TransferPaytab, IsDisAll: isDisAll, DiscountAll: DisAll, NoteHDtab: noteHDtab, NotPrint: notPrint }),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (r) {
                    var TabTemp;
                    keydown = false;
                    HideLoading();
                    if (r == 1) {
                        if (tab3 == 0 && tab1 == 1 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                            TabTemp = 1;
                        } else if (tab3 == 0 && tab1 == 0 && tab2 == 1 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                            TabTemp = 2;
                        } else if (tab3 == 1 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                            TabTemp = 3;
                        } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 1 && tab5 == 0 && tab6 == 0) {
                            TabTemp = 4;
                        } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 1 && tab6 == 0) {
                            TabTemp = 5;
                        } else {
                            TabTemp = 6;
                        }
                        removeData(TabTemp);
                        ExitPopupPay();
                        var thattab = document.getElementById("popup_Pay");
                        thattab.style.display = "none";
                    }
                    else if (r != "0") {
                        //$("#success-alert").fadeTo(2000, 500).slideUp(500, function () {
                        //    $("#success-alert").slideUp(500);
                        //});
                        if (tab3 == 0 && tab1 == 1 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                            TabTemp = 1;
                        } else if (tab3 == 0 && tab1 == 0 && tab2 == 1 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                            TabTemp = 2;
                        } else if (tab3 == 1 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                            TabTemp = 3;
                        } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 1 && tab5 == 0 && tab6 == 0) {
                            TabTemp = 4;
                        } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 1 && tab6 == 0) {
                            TabTemp = 5;
                        } else {
                            TabTemp = 6;
                        }
                        removeData(TabTemp);
                        var thattab = document.getElementById("popup_Pay");
                        thattab.style.display = "none";
                        ShowLoading();
                        //$.get('/ProductInvoice/PrintNT?Id=' + r + '&ExportExcel=false', function (html) {

                        //    $('.listsearch8').show();
                        //    $("#Search_Product8").html(html);

                        //});
                        OpenPopup('/ProductInvoice/PrintNT?Id=' + r + '&ExportExcel=false', 'Tìm kiếm dữ liệu', 300, 300);
                        $(".close").trigger('click');
                        HideLoading();
                    } else {
                        $("#danger-alert").fadeTo(2000, 500).slideUp(500, function () {
                            removeData(TabTemp);
                            var thattab = document.getElementById("popup_Pay");
                            thattab.style.display = "none";
                            $("#danger-alert").slideUp(500);
                        });
                    }
                },
                error: function (xhr, ajaxOptions, thrownError) {
                    HideLoading();
                    keydown = false;
                    $("#danger-alert").fadeTo(2000, 500).slideUp(500, function () {
                        $("#danger-alert").slideUp(500);
                    });
                }
            });
        }


        //alert(customerId);

        //Load lại tồn kho Imgdata
        GetPageData($('.page-number').html());
        //Load lại tồn kho SelectList
        //$.get('/ProductInvoice/SearchProductInvoice3', function (html) {
        //    $("#Search_Product3").html(html);
        //});

        //var combo = $find(rcb_1_RadComboBox);
        // combo.requestItems();

    }

    $(document).bind("keydown", function (evt){
        var keycode = (evt.keyCode?evt.keyCode:evt.charCode);
        //alert(keycode);
        switch(keycode){

            case 121:  //F8 key on Mac Safari
                evt.preventDefault();
                //Remapping event
                evt.originalEvent.keyCode = 0;
                return false;
                break;
        }
    });

    //function doc_keyUp(e) {

    //// this would test for whichever key is 40 and the ctrl key at the same time
    //if (e.keyCode == 120) {
    //    // call your function to do the thing
    //    Savetab1OKIn();
    //}
    //document.addEventListener('keyup', doc_keyUp, false);
    var keydown = false;
    document.onkeyup=function(e){
        var e = e || window.event;


        if ((e.which == 121)&& (!keydown)) {
            keydown = true;
            e.preventDefault();
            $(".Click2").click()
        }
        if ((e.which == 120)&& (!keydown)) {
            keydown = true;
            e.preventDefault();
            $(".Click1").click()
        }


    }


    $(document).ready(function () {
        ShowLoading();
        //$("#danger-alert").slideUp(500);
        //$("#success-alert").slideUp(500);
        $("#success-alert").hide();
        $("#danger-alert").hide();
        GetDisCountToday();
        DisCountToDayHhOfCustomerVip();
        AppendSearchProduct2();//load hình bên phải
        Rum();
        //sét mặc định giảm giá tổng = 1 theo %
        $("#isDiscountAll1").val(1);
        $("#isDiscountAll2").val(1);
        $("#isDiscountAll3").val(1);
        $("#isDiscountAll4").val(1);
        $("#isDiscountAll5").val(1);
        $("#isDiscountAll6").val(1);


        if (tab3 == 0 && tab1 == 1 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
            $('#listOrderDetail1').on('keypress', '.detail_item_qty', function (e) {
                if (e.keyCode === 46 || e.keyCode === 44) {
                    e.preventDefault();
                }
            });
        } else if (tab3 == 0 && tab1 == 0 && tab2 == 1 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
            $('#listOrderDetail2').on('keypress', '.detail_item_qty', function (e) {
                if (e.keyCode === 46 || e.keyCode === 44) {
                    e.preventDefault();
                }
            });
        } else if (tab3 == 1 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
            $('#listOrderDetail3').on('keypress', '.detail_item_qty', function (e) {
                if (e.keyCode === 46 || e.keyCode === 44) {
                    e.preventDefault();
                }
            });
        } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 1 && tab5 == 0 && tab6 == 0) {
            $('#listOrderDetail4').on('keypress', '.detail_item_qty', function (e) {
                if (e.keyCode === 46 || e.keyCode === 44) {
                    e.preventDefault();
                }
            });
        } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 1 && tab6 == 0) {
            $('#listOrderDetail5').on('keypress', '.detail_item_qty', function (e) {
                if (e.keyCode === 46 || e.keyCode === 44) {
                    e.preventDefault();
                }
            });
        } else {
            $('#listOrderDetail6').on('keypress', '.detail_item_qty', function (e) {
                if (e.keyCode === 46 || e.keyCode === 44) {
                    e.preventDefault();
                }
            });
        }
        var strVal = getCookie("BRANCH_ID_CookieName");
        //alert(strVal);
        $('#BRANCH_ID').val(strVal);
    });
    $('#BRANCH_ID').change(function () {
        $(this).find(":selected").each(function () {
            //alert($(this).val());
            setCookie("BRANCH_ID_CookieName", $(this).val(), 100);
            location.reload();
        });


    });

    $('#tab11').click(function () {
        $("#tab11").removeClass('activeTab').addClass("activeTab");
        //ẩn tổng số lượng sản phẩm tab
        HiddenTotalProductTab(1);
        $("#CustomerId_DisplayText").val($("#CustomerName").val());
        tab1 = 1;
        tab2 = 0;
        tab3 = 0;
        tab4 = 0;
        tab5 = 0;
        tab6 = 0;
        //đổ dữ liệu tab vào
        //removeData(1, true);
        getData(1);
        CheckExtendPay(1);
        ExitPopupPay();

    });
    $('#tab22').click(function () {

        //ẩn tổng số lượng sản phẩm tab
        HiddenTotalProductTab(2);
        tab1 = 0;
        tab2 = 1;
        tab3 = 0;
        tab4 = 0;
        tab5 = 0;
        tab6 = 0;
        getData(2);
        CheckExtendPay(2);
        ExitPopupPay();
    });
    $('#tab33').click(function () {

        //ẩn tổng số lượng sản phẩm tab
        HiddenTotalProductTab(3);
        tab1 = 0;
        tab2 = 0;
        tab3 = 1;
        tab4 = 0;
        tab5 = 0;
        tab6 = 0;
        getData(3);
        CheckExtendPay(3);
        ExitPopupPay();
    });
    $('#tab44').click(function () {

        //ẩn tổng số lượng sản phẩm tab
        HiddenTotalProductTab(4);
        tab1 = 0;
        tab2 = 0;
        tab3 = 0;
        tab4 = 1;
        tab5 = 0;
        tab6 = 0;
        getData(4);
        CheckExtendPay(4);
        ExitPopupPay();
    });
    $('#tab55').click(function () {

        //ẩn tổng số lượng sản phẩm tab
        HiddenTotalProductTab(5);
        tab1 = 0;
        tab2 = 0;
        tab3 = 0;
        tab4 = 0;
        tab5 = 1;
        tab6 = 0;
        getData(5);
        CheckExtendPay(5);
        ExitPopupPay();
    });
    $('#tab66').click(function () {

        //ẩn tổng số lượng sản phẩm tab
        HiddenTotalProductTab(6);
        tab1 = 0;
        tab2 = 0;
        tab3 = 0;
        tab4 = 0;
        tab5 = 0;
        tab6 = 1;
        getData(6);
        CheckExtendPay(6);
        ExitPopupPay();
    });
    $('#CustomerId').change(function () {
        var $this = $(this);
        var $option = $this.find('#CustomerId_DisplayText');
        if ($option.val() != '') {
            $('.listsearch').show();
            $('.alw').hide();
        }
        else {
            alert("Vui lòng chọn khách hàng");
        }

    });

    function checktabplus() {
        if (qtytabnow == 1) {
            var thistab = document.getElementById("tab222");
            thistab.style.display = "block";
            qtytabnow = qtytabnow + 1;
        }
        else if (qtytabnow == 2) {
            var thistab = document.getElementById("tab333");
            thistab.style.display = "block";
            qtytabnow = qtytabnow + 1;
        }
        else if (qtytabnow == 3) {
            var thistab = document.getElementById("tab444");
            thistab.style.display = "block";
            qtytabnow = qtytabnow + 1;
        }
        else if (qtytabnow == 4) {
            var thistab = document.getElementById("tab555");
            thistab.style.display = "block";
            qtytabnow = qtytabnow + 1;
        } else if (qtytabnow == 5) {
            var thistab = document.getElementById("tab666");
            thistab.style.display = "block";
            qtytabnow = qtytabnow + 1;
        }
    }
    function checktabminus() {
        $("#tab" + qtytabnow + qtytabnow + qtytabnow).css('display', 'none');
        removeData(qtytabnow);
        if (qtytabnow > 1) {
            qtytabnow = qtytabnow - 1;
        }
    }
    function selectLocationItem(id, code, name, orderNo) {

        $("#DetailList_" + orderNo + "__SalerName").val(name);
        $("#DetailList_" + orderNo + "__StaffId").val(id);
        ClosePopup();
    }
    function Check() {
        ShowLoading();
        var check = $('input[name="group_choice"]:checked').val();
        var CustomerName = $("#CompanyName").val();
        var messagge = "";
        if (check == 'Customer') {
            if (CustomerName == '')
                messagge += "Khách hàng chưa có<br>";
        }
        if (messagge != '') {
            alertPopup('Lỗi!', messagge, 'error');
            HideLoading();
        }
        else {
            if (tab3 == 0 && tab1 == 1 && tab2 == 0) {

                //ClearFormatBeforeSubmit($("#SaleOrder3"));
                $("#SaleOrder1").submit();
                //alert('1');

            } else if (tab3 == 0 && tab1 == 0 && tab2 == 1) {

                //ClearFormatBeforeSubmit($("#SaleOrder1"));
                $("#SaleOrder2").submit();
                //alert('2');
            } else {

                //ClearFormatBeforeSubmit($("#SaleOrder2"));
                $("#SaleOrder3").submit();
                //alert('3');
            }


        }
    }
    function thongbaothanhcong() {
        thanhcong = 1;
    };
    function AppendSearchProduct(customerId) {
        ShowLoading();
        $.get('/ProductInvoice/SearchProductInvoice', function (html) {
            $("#Search_Product").html(html);

        });

    };
    function AppendSearchProduct2() {
        GetPageData(1);
    };
    function KmToday() {
        ShowLoading();


    };
    function AppendSearchProduct3(callback) {

        $.get('/ProductInvoice/SearchProductInvoice3', function (html) {
            $('.listsearch3').show();
            $("#Search_Product3").html(html);
            document.getElementById("idboxsearch1").placeholder = "Nhập tên hoặc mã sản phẩm..";
            callback();
        });

    };
    function AppendSearchProduct4(callback) {

        $.get('/ProductInvoice/SearchCustomerInvoice2', function (html) {
            $('.listsearch1').show();
            $("#Search_Product1").html(html);
            document.getElementById("idboxsearch2").placeholder = "Nhập số điện thoại khách hàng..";
            callback();
        });


    };
    function AppendSearchProduct5(callback) {
        ShowLoading();
        $.get('/ProductInvoice/SearchCustomerInvoice3', function (html) {
            $('.listsearch4').show();
            $("#Search_Product4").html(html);
            callback();

        });
    };
    function AppendSearchProduct6(callback) {
        ShowLoading();
        $.get('/ProductInvoice/SearchCustomerInvoice4', function (html) {
            $('.listsearch5').show();
            $("#Search_Product5").html(html);
            callback();

        });
    };
    function GetDisCountToday() {
        ShowLoading();
        $.ajax({
            type: "POST",
            url: "/ProductInvoice/DisCountToDay",
            data: null,
            contentType: "application/json; charset=utf-8",
            success: function (result) {
                if (result != null && result.length != 0) {
                    var i;
                    var tmp = {};
                    for (i = 0; i < result.length; i++) {
                        tmp = {};
                        tmp.TypeApply = result[i].TypeApply;
                        tmp.type = result[i].type;
                        tmp.listIDcustomer = result[i].listIDcustomer;
                        tmp.Minvalue = result[i].Minvalue;
                        tmp.CommissionValue = result[i].CommissionValue;
                        tmp.IsMoney = result[i].IsMoney;
                        //alert(result[i].Id);
                        //alert(result[i].Id_cha);
                        tmp.id = result[i].id;
                        tmp.id_cha = result[i].id_cha;
                        //alert("cai nay" + result[i].id);
                        //alert("apllytype:" + tmp.TypeApply + "type" + tmp.type + "listIDcustomer:" + tmp.listIDcustomer + "Minvalue:" + tmp.Minvalue + "CommissionValue:" + tmp.CommissionValue + "IsMoney:" + tmp.IsMoney);
                        ArrHdDiscountAll.push(tmp);
                        //alert("apllytype arr:" + ArrHdDiscountAll[i].TypeApply + "type arr" + ArrHdDiscountAll[i].type + "listIDcustomer:" + ArrHdDiscountAll[i].listIDcustomer + "Minvalue:" + ArrHdDiscountAll[i].Minvalue + "CommissionValue:" + ArrHdDiscountAll[i].CommissionValue + "IsMoney:" + ArrHdDiscountAll[i].IsMoney);
                    }
                } else {
                    //HideLoading();
                }

                // HideLoading();
            },
            error: function (result) {
                //console.log(result);
                HideLoading();
            }

        });

        return false;
    };
    function DisCountToDayHhOfCustomerVip() {
        ShowLoading();
        $.ajax({
            type: "POST",
            url: "/ProductInvoice/DisCountToDayHhOfCustomerVip",
            data: null,
            contentType: "application/json; charset=utf-8",
            success: function (result) {
                if (result != null && result.length != 0) {
                    var i;
                    var tmp = {};

                    for (i = 0; i < result.length; i++) {
                        //alert(result.length);
                        tmp = {};
                        tmp.TypeApply = result[i].TypeApply;
                        tmp.type = result[i].type;
                        tmp.listIDcustomer = result[i].listIDcustomer;
                        tmp.listIdproduct = result[i].listIdproduct;
                        tmp.CommissionValue = result[i].CommissionValue;
                        tmp.IsMoney = result[i].IsMoney;
                        //alert(result[i].Id);
                        //alert(result[i].Id_cha);
                        tmp.id = result[i].id;
                        tmp.id_cha = result[i].id_cha;
                        //alert("cai nay" + result[i].id);
                        //alert("apllytype:" + tmp.TypeApply + "type" + tmp.type + "listIDcustomer:" + tmp.listIDcustomer + "Minvalue:" + tmp.Minvalue + "CommissionValue:" + tmp.CommissionValue + "IsMoney:" + tmp.IsMoney);
                        ArrHdDiscountVIP.push(tmp);
                        //alert("apllytype arr:" + ArrHdDiscountVIP[i].TypeApply + "type arr" + ArrHdDiscountVIP[i].type + "listIDcustomer:" + ArrHdDiscountVIP[i].listIDcustomer + "Minvalue:" + ArrHdDiscountVIP[i].Minvalue + "CommissionValue:" + ArrHdDiscountVIP[i].CommissionValue + "IsMoney:" + ArrHdDiscountVIP[i].IsMoney);
                    }
                } else {
                    //HideLoading();
                }

                //HideLoading();
            },
            error: function (result) {
                //console.log(result);
                HideLoading();
            }

        });

        return false;
    };

    function selectItemCustomer(customerid, name, address, phone) {
        //alert("da ve cha");
        if (tab3 == 0 && tab1 == 1 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
            $("#CustomerId1").val(customerid);
            $("#CustomerName1").val(name);
            $("#idboxsearch2").val(name);

        } else if (tab3 == 0 && tab1 == 0 && tab2 == 1 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
            $("#CustomerId2").val(customerid);
            $("#CustomerName2").val(name);
            $("#idboxsearch2").val(name);

        } else if (tab3 == 1 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
            $("#CustomerId3").val(customerid);
            $("#CustomerName3").val(name);
            $("#idboxsearch2").val(name);

        } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 1 && tab5 == 0 && tab6 == 0) {
            $("#CustomerId4").val(customerid);
            $("#CustomerName4").val(name);
            $("#idboxsearch2").val(name);

        } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 1 && tab6 == 0) {
            $("#CustomerId5").val(customerid);
            $("#CustomerName5").val(name);
            $("#idboxsearch2").val(name);

        } else {
            $("#CustomerId6").val(customerid);
            $("#CustomerName6").val(name);
            $("#idboxsearch2").val(name);

        }

        ClosePopup();
    };

    function Rum(callback) {
        ShowLoading();
        AppendSearchProduct3(function () {
            AppendSearchProduct4(function () {
                AppendSearchProduct5(function () {
                    AppendSearchProduct6(callback);
                    HideLoading();
                });
            });
        });
    }
    function tinhkhuyenmaiHHVip(istab) {
        //alert("vao day khong");
        //debugger
        var i;
        if (ArrHdDiscountVIP !== null && ArrHdDiscountVIP.length > 0 && ArrHdDiscountVIP.length != 0) {

            for (i = 0; i < ArrHdDiscountVIP.length; i++) {
                ispass = false;
                var iscus = $("#CustomerId" + istab).val();

                customerNV = ArrHdDiscountVIP[i].listIDcustomer.split(',');
                var j;
                for (j = 0; j < customerNV.length; j++) {
                    if (iscus == customerNV[j]) {

                        ispass = true;
                        break;
                    }
                }
                if (ispass == true) {
                    if (ArrHdDiscountVIP[i].type == "ALLSP") {

                        if (ArrHdDiscountVIP[i].IsMoney == true) {
                            var ks = 0;
                            $("#tbllistOrderDetail" + istab + ' TBODY TR').each(function () {
                                var row = $(this);
                                $(this).closest('tr').find("td:eq(4) input:nth-child(2)").val('');
                                Productcodes2 = $(this).closest('tr').find("td:eq(5) input").val();
                                var id = "checkboxDiscount" + istab + "+" + ks + "+" + Productcodes2;
                                var checkBox = document.getElementById(id);
                                checkBox.checked = false;
                                $(this).closest('tr').find("td:eq(4) input:nth-child(2)").val(numeral(ArrHdDiscountVIP[i].CommissionValue).format('0,0'));
                                $(this).closest('tr').find("td:eq(4) input:nth-child(2)").trigger('change');
                                $(this).closest('tr').find("td:eq(4) input:nth-child(1)").removeClass('classBlock').addClass('classHidden');
                                $(this).closest('tr').find("td:eq(4) input:nth-child(2)").removeClass('classHidden').addClass('classBlock');
                                ks++;
                            });
                        } else {
                            $("#tbllistOrderDetail" + istab + ' TBODY TR').each(function () {
                                var row = $(this);
                                $(this).closest('tr').find("td:eq(4) input:nth-child(1)").val('');
                                $(this).closest('tr').find("td:eq(4) input:nth-child(1)").val(ArrHdDiscountVIP[i].CommissionValue);
                                $(this).closest('tr').find("td:eq(4) input:nth-child(1)").trigger('change');
                            });
                        }

                    }
                    if (ArrHdDiscountVIP[i].type == "NSP") {

                        productNSP = ArrHdDiscountVIP[i].listIdproduct.split(',');
                        if (ArrHdDiscountVIP[i].IsMoney == true) {
                            var ks = 0;
                            $("#tbllistOrderDetail" + istab + ' TBODY TR').each(function () {
                                ProductIds1 = $(this).closest('tr').find("td:eq(1) input").val();
                                var row = $(this);
                                var j;
                                for (j = 0; j < productNSP.length; j++) {
                                    if (ProductIds1 == productNSP[j]) {
                                        $(this).closest('tr').find("td:eq(4) input:nth-child(2)").val('');
                                        Productcodes2 = $(this).closest('tr').find("td:eq(5) input").val();
                                        var id = "checkboxDiscount" + istab + "+" + ks + "+" + Productcodes2;
                                        var checkBox = document.getElementById(id);
                                        checkBox.checked = false;
                                        $(this).closest('tr').find("td:eq(4) input:nth-child(2)").val(numeral(ArrHdDiscountVIP[i].CommissionValue).format('0,0'));
                                        $(this).closest('tr').find("td:eq(4) input:nth-child(2)").trigger('change');
                                        $(this).closest('tr').find("td:eq(4) input:nth-child(1)").removeClass('classBlock').addClass('classHidden');
                                        $(this).closest('tr').find("td:eq(4) input:nth-child(2)").removeClass('classHidden').addClass('classBlock');
                                    }
                                }
                                ks++;

                            });
                        } else {

                            $("#tbllistOrderDetail" + istab + ' TBODY TR').each(function () {
                                ProductIds1 = $(this).closest('tr').find("td:eq(1) input").val();
                                var row = $(this);
                                var j;

                                for (j = 0; j < productNSP.length; j++) {
                                    if (ProductIds1 == productNSP[j]) {
                                        $(this).closest('tr').find("td:eq(4) input:nth-child(1)").val('');
                                        $(this).closest('tr').find("td:eq(4) input:nth-child(1)").val(ArrHdDiscountVIP[i].CommissionValue);
                                        $(this).closest('tr').find("td:eq(4) input:nth-child(1)").trigger('change');
                                    }
                                }

                            });
                        }

                    }
                    if (ArrHdDiscountVIP[i].type == "ONESP") {
                        productNSP = ArrHdDiscountVIP[i].listIdproduct;
                        if (ArrHdDiscountVIP[i].IsMoney == true) {
                            var ks = 0;
                            $("#tbllistOrderDetail" + istab + ' TBODY TR').each(function () {
                                ProductIds1 = $(this).closest('tr').find("td:eq(1) input").val();
                                var row = $(this);

                                if (ProductIds1 == productNSP) {
                                    $(this).closest('tr').find("td:eq(4) input:nth-child(2)").val('');
                                    Productcodes2 = $(this).closest('tr').find("td:eq(5) input").val();
                                    var id = "checkboxDiscount" + istab + "+" + ks + "+" + Productcodes2;
                                    var checkBox = document.getElementById(id);
                                    checkBox.checked = false;
                                    $(this).closest('tr').find("td:eq(4) input:nth-child(2)").val(numeral(ArrHdDiscountVIP[i].CommissionValue).format('0,0'));
                                    $(this).closest('tr').find("td:eq(4) input:nth-child(2)").trigger('change');
                                    $(this).closest('tr').find("td:eq(4) input:nth-child(1)").removeClass('classBlock').addClass('classHidden');
                                    $(this).closest('tr').find("td:eq(4) input:nth-child(2)").removeClass('classHidden').addClass('classBlock');
                                }

                                ks++;

                            });
                        } else {

                            $("#tbllistOrderDetail" + istab + ' TBODY TR').each(function () {

                                ProductIds1 = $(this).closest('tr').find("td:eq(1) input").val();

                                var row = $(this);
                                if (ProductIds1 == productNSP) {
                                    $(this).closest('tr').find("td:eq(4) input:nth-child(1)").val('');
                                    $(this).closest('tr').find("td:eq(4) input:nth-child(1)").val(ArrHdDiscountVIP[i].CommissionValue);
                                    $(this).closest('tr').find("td:eq(4) input:nth-child(1)").trigger('change');
                                }


                            });
                        }
                    }
                }
            }
        }

    }
    function thongbaotinhtrang() {
        ShowLoading();
        if (thanhcong == 1) {
            alert("Tạo Đơn Hàng Thành Công!");
            HideLoading();
        } else {
            HideLoading();
            return;
        }



    };
    function DelTabValue() {
        if (tab3 == 0 && tab1 == 1 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
            removeData(1);
        } else if (tab3 == 0 && tab1 == 0 && tab2 == 1 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
            removeData(2);
        } else if (tab3 == 1 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
            removeData(3);
        } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 1 && tab5 == 0 && tab6 == 0) {
            removeData(4);
        } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 1 && tab6 == 0) {
            removeData(5);
        } else {
            removeData(6);
        }
        $('#PopupDel').css('display', 'none');
    }

    function myFunction() {
        // alert("vao day khong");
        var check = document.getElementById("TypeDiscountHD");
        //alert(check.checked);
        if (check.checked == true) {
            if (tab3 == 0 && tab1 == 1 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                $("#isDiscountAll1").val(0);
                //tinh_tong_tien1()
            } else if (tab3 == 0 && tab1 == 0 && tab2 == 1 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                $("#isDiscountAll2").val(0);
                //tinh_tong_tien2()
            } else if (tab3 == 1 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                $("#isDiscountAll3").val(0);
                //tinh_tong_tien3()
            } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 1 && tab5 == 0 && tab6 == 0) {
                $("#isDiscountAll4").val(0);
                //tinh_tong_tien4()
            } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 1 && tab6 == 0) {
                $("#isDiscountAll5").val(0);
                //tinh_tong_tien5()
            } else {
                $("#isDiscountAll6").val(0);
                //tinh_tong_tien6()
            }
        } else {
            if (tab3 == 0 && tab1 == 1 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                $("#isDiscountAll1").val(1);
                //tinh_tong_tien1()
            } else if (tab3 == 0 && tab1 == 0 && tab2 == 1 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                $("#isDiscountAll2").val(1);
                //tinh_tong_tien2()
            } else if (tab3 == 1 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                $("#isDiscountAll3").val(1);
                //tinh_tong_tien3()
            } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 1 && tab5 == 0 && tab6 == 0) {
                $("#isDiscountAll4").val(1);
                //tinh_tong_tien4()
            } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 1 && tab6 == 0) {
                $("#isDiscountAll5").val(1);
                //tinh_tong_tien5()
            } else {
                $("#isDiscountAll6").val(1);
                //tinh_tong_tien6()
            }
        }
        $("#DiscountAll").trigger('keyup');
    }
    function ToggleDiscount(Istab, OrderNo, ProductCode) {
        //alert("vao day khong");
        isplus = 0;
        isminus = 0;
        isone = 0;
        var id = "checkboxDiscount" + Istab + "+" + OrderNo + "+" + ProductCode;
        var checkBox = document.getElementById(id);
        var tbl = "#tbllistOrderDetail" + Istab + " TBODY TR";

        //$(this).removeClass('selected_grey').addClass("text_data");
        $(tbl).each(function () {
            if (checkBox.checked == true) {
                var ProductCode1 = $(this).closest('tr').find("td:eq(5) input:hidden").val();

                if (ProductCode1 == ProductCode) {
                    var isMoney = $(this).closest('tr').find("td:eq(6) input:hidden").val(false);
                    //alert("khuyen mai %");
                    $(this).closest('tr').find('td:eq(4) input:nth-child(1)').removeClass('classHidden').addClass("classBlock");
                    $(this).closest('tr').find('td:eq(4) input:nth-child(2)').removeClass('classBlock').addClass("classHidden");
                    $(this).closest('tr').find('td:eq(4) input:nth-child(1)').val(0);
                    $(this).closest('tr').find('td:eq(4) input:nth-child(2)').val(0);
                    $(this).closest('tr').find('td:eq(4) input:nth-child(1)').trigger('change');
                    //alert('Tab:' + Istab + '- Mã Code:' + ProductCode + '- %:' + $(this).closest('tr').find('td:eq(4) input:nth-child(1)').val() + '- đ:'+$(this).closest('tr').find('td:eq(4) input:nth-child(2)').val());
                }
            }
            else {
                var ProductCode1 = $(this).closest('tr').find("td:eq(5) input:hidden").val();

                if (ProductCode1 == ProductCode) {
                    var isMoney = $(this).closest('tr').find("td:eq(6) input:hidden").val(true);
                    //alert("khuyen mai tien");
                    $(this).closest('tr').find('td:eq(4) input:nth-child(1)').removeClass('classBlock').addClass("classHidden");
                    $(this).closest('tr').find('td:eq(4) input:nth-child(2)').removeClass('classHidden').addClass("classBlock");
                    $(this).closest('tr').find('td:eq(4) input:nth-child(1)').val(0);
                    $(this).closest('tr').find('td:eq(4) input:nth-child(2)').val(0);
                    $(this).closest('tr').find('td:eq(4) input:nth-child(2)').trigger('change');
                    //alert('Tab:' + Istab + '- Mã Code:' + ProductCode + '- %:' + $(this).closest('tr').find('td:eq(4) input:nth-child(1)').val() + '- đ:' + $(this).closest('tr').find('td:eq(4) input:nth-child(2)').val());

                }
            }
        });
    }
    function searchProductByBarCodeContain2(barcode) {
        //alert("ok cretent");
        barcode = barcode.toLowerCase();
        var $optionList = $("#productSelectList2").find('option');

        var arrResulft = [];
        for (var i = 0; i < $optionList.length; i++) {
            var data_code = $($optionList[i]).data('code') != undefined ? $($optionList[i]).data('code').toString().toLowerCase() : undefined;
            if (barcode.indexOf(data_code) != -1)
                arrResulft.push($($optionList[i]).attr('value'));

            if (arrResulft.length == 1) {
                if (tab3 == 0 && tab1 == 1 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                    var OrderNo = $('.detailList1 tr').length;
                    var Istab = 1;
                } else if (tab3 == 0 && tab1 == 0 && tab2 == 1 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                    var OrderNo = $('.detailList2 tr').length;
                    var Istab = 2;
                } else if (tab3 == 1 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                    var OrderNo = $('.detailList3 tr').length;
                    var Istab = 3;
                } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 1 && tab5 == 0 && tab6 == 0) {
                    var OrderNo = $('.detailList4 tr').length;
                    var Istab = 4;
                } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 1 && tab6 == 0) {
                    var OrderNo = $('.detailList5 tr').length;
                    var Istab = 5;
                } else {
                    var OrderNo = $('.detailList6 tr').length;
                    var Istab = 6;
                }

                var productidbarcode = $($optionList[i]).data("product-id") != undefined ? $($optionList[i]).data("product-id").toString().toLowerCase() : undefined;
                var formdata = {
                    OrderNo: OrderNo,
                    ProductId: productidbarcode,
                    Istab: Istab
                    //alert(OrderNo);
                    //alert(productidbarcode);
                    //alert(Istab);
                };
                ClickEventHandler2(true, "/ProductInvoice/LoadProductItemNT", ".detailList2", formdata, function () {
                    if (tab3 == 0 && tab1 == 1 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                        $('#ProductItemCount1').val($('#listOrderDetail1 .detailList1 tr').length);

                    } else if (tab3 == 0 && tab1 == 0 && tab2 == 1 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                        $('#ProductItemCount2').val($('#listOrderDetail2.detailList2 tr').length);
                    } else if (tab3 == 1 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                        $('#ProductItemCount3').val($('#listOrderDetail3 .detailList3 tr').length);
                    } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 1 && tab5 == 0 && tab6 == 0) {
                        $('#ProductItemCount4').val($('#listOrderDetail4 .detailList4 tr').length);
                    } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 1 && tab6 == 0) {
                        $('#ProductItemCount5').val($('#listOrderDetail5 .detailList5 tr').length);
                    } else {
                        $('#ProductItemCount6').val($('#listOrderDetail6 .detailList6 tr').length);
                    }

                    $.mask.definitions['~'] = '[+-]';
                    $('.input-mask-date').mask('99/99/9999');
                    LoadNumberInput();
                    //Cho phép sửa giá?
                    if (@isallow_edit_price_POS == false)
                    {
                        $('.detail_item_price_1').attr('readonly', true);
                        $('.detail_item_price_2').attr('readonly', true);
                        $('.detail_item_price_3').attr('readonly', true);
                        $('.detail_item_price_4').attr('readonly', true);
                        $('.detail_item_price_5').attr('readonly', true);
                        $('.detail_item_price_6').attr('readonly', true);
                    }
                    if (tab3 == 0 && tab1 == 1 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                        var tmp1 = $("#TotalProduct1").val();
                        tmp1 = tmp1 + 1;
                        $("#TotalProduct1").val(tmp1);
                        tinh_tong_tien1();
                    } else if (tab3 == 0 && tab1 == 0 && tab2 == 1 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                        var tmp2 = $("#TotalProduct2").val();
                        tmp2 = tmp2 + 1;
                        $("#TotalProduct1").val(tmp2);
                        tinh_tong_tien2();
                    } else if (tab3 == 1 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                        var tmp3 = $("#TotalProduct3").val();
                        tmp3 = tmp3 + 1;
                        $("#TotalProduct3").val(tmp3);
                        tinh_tong_tien3();
                    } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 1 && tab5 == 0 && tab6 == 0) {
                        var tmp4 = $("#TotalProduct4").val();
                        tmp4 = tmp4 + 1;
                        $("#TotalProduct4").val(tmp4);
                        tinh_tong_tien4();
                    } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 1 && tab6 == 0) {
                        var tmp5 = $("#TotalProduct5").val();
                        tmp5 = tmp5 + 1;
                        $("#TotalProduct5").val(tmp5);
                        tinh_tong_tien5();
                    } else {
                        var tmp6 = $("#TotalProduct6").val();
                        tmp6 = tmp6 + 1;
                        $("#TotalProduct6").val(tmp6);
                        tinh_tong_tien6();
                    }
                });
                return arrResulft[0];
            }
        }


        return arrResulft[0];
    }
    function HideVnd(Istab, ProductCode) {
        //var thistab = document.getElementById("productRight");
        //alert("OK");
        var row; var ProductCode1;
        if (Istab == 1) {
            $("#tbllistOrderDetail1 TBODY TR").each(function () {
                row = $(this);
                ProductCode1 = $(this).closest('tr').find("td:eq(5) input:hidden").val();
                ProductCode1 =
                    $(this).removeClass('selected_grey').addClass("text_data");
                if (String(ProductCode).trim().localeCompare(String(ProductCode1).trim()) == 0) {
                    if (add == 1) {
                        $(this).closest('tr').find("td:eq(2) input").val(parseInt($(this).closest('tr').find("td:eq(2) input").val()) + 1);
                    }
                    else {
                        $(this).closest('tr').find("td:eq(2) input").val(parseInt($(this).closest('tr').find("td:eq(2) input").val()) - 1);
                    }
                    $(this).closest('tr').find("td:eq(2) input").trigger('change');
                    $(this).addClass('selected_grey');
                }
            });
        }
        //if (checkBox.checked == true) {
        //    //alert("Checked");
        //} else {
        //    //alert("UnChecked")
        //}
    }
    //sự kiện click hàng trả

    $("#Return-text").click(function () {
        $("#IdHangTra").trigger('click');
    });
    $("#IdHangTra").click(function () {

        //OpenPopup('/SalesReturns/Create', ' Tạo Hàng Trả',0, 600);

        PopupReturnProduct('/SalesReturns/Create', ' Tạo Hàng Trả', 0, 600);

    });


    //end hang trả
    $("#MoneyPay").click(function () {

    });
    $("#DiscountAll").click(function () {

    });
    $("#TransferPay").click(function () {

    });
    $("#ATMPay").click(function () {

    });
    function OpenPopupPay() {

        //alert("mo trang thanh toan");
        //debugger
        //begin hoapd them vao để tính lại tổng giá trị thanh toán khi mở opup
        var isTab = checkTab();
        myFunction();
        var discountalltab = $('#DiscountAll').val();
        discountalltab = removeComma(discountalltab);
        $('#DiscountAll' + isTab).val(discountalltab);
        var sumas = $('#TotalAmount1').val();
        sumas = removeComma(sumas);
        var kkk = $("#isDiscountAll" + isTab).val();
        if (kkk == 0) {
            var sumass = sumas - discountalltab;
            $("#TotalPay").val(numeral(sumass).format('0,0'));
            //begin xem co tien ATM hay chuyen khoan khong
            var ATM = $("#ATM" + isTab).val();
            var Transfer = $("#Transfer" + isTab).val();
            if (Transfer === "" || Transfer === null) {
                Transfer = 0;
            }
            if (ATM === "" || ATM === null) {
                ATM = 0;
            }
            $("#MoneyPay").val(numeral((parseFloat(removeComma(sumass))-parseFloat(removeComma(ATM))-parseFloat(removeComma(Transfer)))).format('0,0'));
            $("#Money" + isTab).val(numeral(tienmat).format('0,0'));
            $('#Money' + isTab).val(discountalltab);
        } else {
            var sumass = sumas - ((discountalltab * sumas) / 100);
            //begin xem co tien ATM hay chuyen khoan khong
            var ATM = $("#ATM" + isTab).val();
            var Transfer = $("#Transfer" + isTab).val();
            if (Transfer === "" || Transfer === null) {
                Transfer = 0;
            }
            if (ATM === "" || ATM === null) {
                ATM = 0;
            }

            var tienmat=parseFloat(removeComma(sumass))-parseFloat(removeComma(ATM))-parseFloat(removeComma(Transfer));
            //alert(parseFloat(removeComma(sumass))-parseFloat(removeComma(ATM))-parseFloat(removeComma(Transfer)));

            $("#TotalPay").val(numeral(sumass).format('0,0'));
            $("#MoneyPay").val(numeral(tienmat).format('0,0'));
            $("#Money" + isTab).val(numeral(tienmat).format('0,0'));
            $('#Money' + isTab).val(discountalltab);
        }
        //end hoapd them vao để tính lại tổng giá trị thanh toán khi mở opup



        var check = $("#CheckPopup").val();
        if (check == 1 || check == null || check == undefined || check == "") {
            var thistab = document.getElementById("productRight");
            thistab.style.display = "none";
            var thattab = document.getElementById("popup_Pay");
            thattab.style.display = "block";
            var toggle = document.getElementById("toggle-button-cover");
            toggle.style.display = "block";

            var btnExit = document.getElementById("btnExit");
            btnExit.style.display = "block";
            var btnClose = document.getElementById("btnOpenPopupPay");
            btnClose.style.display = "none";
            var btnClose = document.getElementById("btnClosePopupPay");
            btnClose.style.display = "block";
            //document.getElementById("TypeDiscountHD").checked = false;
            if (tab3 == 0 && tab1 == 1 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                BillTab(1); CheckExtendPay(1);
            } else if (tab3 == 0 && tab1 == 0 && tab2 == 1 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                BillTab(2); CheckExtendPay(2);
            } else if (tab3 == 1 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
                BillTab(3); CheckExtendPay(3);
            } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 1 && tab5 == 0 && tab6 == 0) {
                BillTab(4); CheckExtendPay(4);
            } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 1 && tab6 == 0) {
                BillTab(5); CheckExtendPay(5);
            } else {
                BillTab(6); CheckExtendPay(6);
            }
            $("#CheckPopup").val(0);
        }
        else {
            ExitPopupPay();
        }
    }

    function CheckExtendPay(isTab) {
        // alert("vao day khong");phai sua cho nay
        //debugger
        var Money = $("#Money" + isTab).val();
        var TotalAmountPay = $("#TotalAmountPay").val();
        if (isNull(Money) == 1 || Money == 0) {
            $("#MoneyPay").val(TotalAmountPay);
        }
        else {
            $("#MoneyPay").val(numeral(Money).format('0,0'));
        }

        //begin

        var isTab = checkTab();
        var discountalltab = $('#DiscountAll').val();
        discountalltab = removeComma(discountalltab);
        $('#DiscountAll' + isTab).val(discountalltab);
        var sumas = $('#TotalAmount1').val();
        sumas = removeComma(sumas);
        var kkk = $("#isDiscountAll" + isTab).val();
        if (kkk == 0) {
            var sumass = sumas - discountalltab;
            $("#TotalPay").val(numeral(sumass).format('0,0'));
        } else {
            var sumass = sumas - ((discountalltab * sumas) / 100);
            $("#TotalPay").val(numeral(sumass).format('0,0'));
        }
        //end hoapd them vao để tính lại tổng giá trị thanh toán khi mở opup
        //end



        $("#CheckPay").val();
        var ATM = $("#ATM" + isTab).val();
        var Transfer = $("#Transfer" + isTab).val();
        if ((isNull(ATM) == 1 & isNull(Transfer) == 1) || (ATM == 0 & Transfer == 0)) {
            $("#CheckPay").val(0);
            OpenCheckPay();
        }
        else {
            $("#CheckPay").val(1);
            OpenCheckPay();
        }
    }
    function ExitPopupPay() {
        var thistab = document.getElementById("productRight");
        thistab.style.display = "block";
        var thattab = document.getElementById("popup_Pay");
        thattab.style.display = "none";
        var toggle = document.getElementById("toggle-button-cover");
        toggle.style.display = "none";
        var btnExit = document.getElementById("btnExit");
        btnExit.style.display = "none";

        var btnClose = document.getElementById("btnClosePopupPay");
        btnClose.style.display = "none";
        var btnClose = document.getElementById("btnOpenPopupPay");
        btnClose.style.display = "block";
        $("#CheckPopup").val(1);
    }
    function RemoveNameTab(isTab) {
        var TabA;
        var NameTab = "#NameTab" + isTab;

        if (isTab == 1) {
            TabA = "#TabA" + isTab;
        }
        else {
            NameTab = "#NameTab" + isTab;
            TabA = "#tab" + isTab + isTab;
        }
        $(NameTab).val("");
        $(NameTab).css('display', 'none');
        $(TabA).html('#' + isTab);
        $(TabA).css('opacity', '1');
        $(TabA).val("#" + isTab);
    }
    function removeData(isTab) {
        $("#TotalProduct" + isTab).trigger('change');
        var Form = "PlanFormtab" + isTab;
        RemoveNameTab(isTab);
        var tbl = "#tbllistOrderDetail" + isTab + " TBODY TR";
        document.getElementById(Form).reset();
        $(tbl).remove();

        //Biến thành phần
        $("#DiscountAll" + isTab).val("");
        $("#noteHD" + isTab).val("");
        $("#DiscountTab" + isTab).val("");// Giảm giá từng hóa đơn
        $("#TotalAmount" + isTab).val("");
        $("#Tab" + isTab + "Money").val("");
        $("#CustomerName" + isTab).val("");
        $("#CustomerId" + isTab).val("");
        $("#TotalProduct" + isTab).html("");//Tổng số lượng sản phẩm 1->6
        $("#TotalAmountTab" + isTab).val("");//Tổng 1->6
        $('#NameTab' + isTab).val("");//Tên thay đổi
        $("#Tab" + isTab + "Total").val("");//Tên thay đổi
        $("#Tab" + isTab + "Discount").val("");//Giảm giá HĐ
        $("#Tab" + isTab + isTab + "Discount").val("");//Giảm giá HĐ
        $('#Money' + isTab).val("");//Tiền mặt
        $('#Transfer' + isTab).val("");//Chuyển khoản
        $('#ATM' + isTab).val("");//ATM

        // Biến tổng
        $('#TotalAmount1').val(""); //Thanh toán trái
        $('#TotalAmountTab1').val(""); //Thanh toán trái
        $("#noteHD").val("");
        $('#TotalAmountPay').val(""); // Tiền hàng
        $("#DiscountAll").val(""); // Giảm giá đặc biệt
        $("#idboxsearch2").val("");
        $("#TotalPay").val(""); // Thanh toán phải
        $("#MoneyPay").val("");//Tiền mặt
        $("#TransferPay").val("");//Tiền Ck
        $("#ChangeMoney").val(""); //Tiền thối
        $("#ATMPay").val("");//Quẹt thẻ
        $("#DiscountTab1").val("");//Giảm giá HĐ
        document.getElementById("TypeDiscountHD").checked = false;
        myFunction();
        ExitPopupPay();
    }

    function checkTab() {
        if (tab3 == 0 && tab1 == 1 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
            return 1;

        } else if (tab3 == 0 && tab1 == 0 && tab2 == 1 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
            return 2;
        } else if (tab3 == 1 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 0 && tab6 == 0) {
            return 3;
        } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 1 && tab5 == 0 && tab6 == 0) {
            return 4;
        } else if (tab3 == 0 && tab1 == 0 && tab2 == 0 && tab4 == 0 && tab5 == 1 && tab6 == 0) {
            return 5;
        } else {
            return 6;
        }
    }
    function BillTab(isTab) {
        //alert("vao day khong");
        //debugger
        var TotalTab = $("#TotalAmount1").val();   //Thanh toán trái
        var TotalPublish = $("#TotalAmountTab1").val(); // tổng trái
        $("#TotalAmountPay").val(TotalTab); // tiền hàng
        var Money = $("#Money" + isTab).val();
        var ATM = $("#ATM" + isTab).val();
        var Transfer = $("#Transfer" + isTab).val();

        if (Money === "" || Money === null) {
            Money = 0;
        }

        if (ATM === "" || ATM === null) {
            ATM = 0;
        }
        if (Transfer === "" || Transfer === null) {
            Transfer = 0;
        }

        if (ATM == 0 && Transfer==0)
        {
            //alert($("#TotalPay").val());
            $("#MoneyPay").val( $("#TotalPay").val()) ;
            Money = $("#Money" + isTab).val();
        }



        // tiền mặt
        if ((isNull(Money) == 1||Money==0)&&((parseFloat(ATM) +parseFloat(Transfer))==0)) {
            $("#MoneyPay").val(TotalTab);
            $("#Money" + isTab).val(removeComma(TotalTab));
            $("#Money" + isTab).val(removeComma(TotalTab));
        }
        else {
            $("#MoneyPay").val(parseFloat(removeComma($("#TotalPay").val()))-parseFloat(removeComma(ATM))-parseFloat(removeComma(Transfer)));
            $("#Money" + isTab).val(parseFloat(removeComma($("#TotalPay").val()))-parseFloat(removeComma(ATM))-parseFloat(removeComma(Transfer)));
        }
        // chuyển khoản
        if (isNull($("#Transfer" + isTab).val()) == 1) {
            $("#TransferPay").val("");
        }
        else {
            $("#TransferPay").val(removeComma(Transfer));
        }
        // ATM
        if (isNull($("#ATM" + isTab).val()) == 1) {  // tiền mặt
            $("#ATMPay").val("");
        }
        else {
            $("#ATMPay").val(numeral(removeComma(ATM)).format('0,0'));
        }
        // Tiền thối
        var pricus = removeComma($("#MoneyPay").val());
        var TotalPaya = removeComma($("#TotalPay").val());
        var Transfer = removeComma($("#TransferPay").val());
        var ATM = removeComma($("#ATMPay").val());
        var aa = removeComma(TotalPaya);
        var number = pricus * 1 + ATM * 1 + Transfer * 1;
        var totalcus1 = number - aa;
        $("#ChangeMoney").val(' ' + numeral(totalcus1).format('0,0'));
    }
    function OpenCheckPay() {
        //alert("vao day khong");
        var isTab = checkTab();
        var check = $("#CheckPay").val();
        var thistab = document.getElementById("CheckPay1");
        var thattab = document.getElementById("CheckPay2");
        if (check == 1 || check == null || check == undefined || check == "") {

            thistab.style.display = "block";
            thattab.style.display = "block";
            $("#CheckPay").val(0);
        }
        else {
            thistab.style.display = "none";
            thattab.style.display = "none";
            $("#CheckPay").val(1);
            $('#Transfer' + isTab).val("");//Chuyển khoản
            $('#ATM' + isTab).val("");//ATM
            $('#ATMPay').val("");//ATM
            $('#TransferPay').val("");//ATM
            // Tiền thối
            var pricus = removeComma($("#MoneyPay").val());
            var TotalPaya = removeComma($("#TotalPay").val());
            var Transfer = removeComma($("#TransferPay").val());
            var ATM = removeComma($("#ATMPay").val());
            var aa = removeComma(TotalPaya);
            var number = pricus * 1 + ATM * 1 + Transfer * 1;
            var totalcus1 = number - aa;
            $("#ChangeMoney").val(' ' + numeral(totalcus1).format('0,0'));
        }
    }

</script>
<script>

    $('#MoneyPay').on('keyup', function (event) {
        //alert("vao day khong");
        if (event.which >= 37 && event.which <= 40) {
            event.preventDefault();
        }

        $(this).val(function (index, value) {
            return value
                .replace(/\D/g, "")
                .replace(/\B(?=(\d{3})+(?!\d)\.?)/g, ".")
                ;
        });
    })
    $('#TotalPay').on('keyup', function (event) {
        $('#MoneyPay').val($('#TotalPay').val());

    })
    $('#TypeDiscountHD').on('change', function (event) {
        $('#TotalPay').trigger('keyup');

    })
    $('#DiscountAll').on('keyup', function (event) {
        if (event.which >= 37 && event.which <= 40) {
            event.preventDefault();
        }

        $(this).val(function (index, value) {
            return value
                .replace(/\D/g, "")
                .replace(/\B(?=(\d{3})+(?!\d)\.?)/g, ".")
                ;
        });
    })
    $('#ATMPay').on('keyup', function (event) {
        if (event.which >= 37 && event.which <= 40) {
            event.preventDefault();
        }

        $(this).val(function (index, value) {
            return value
                .replace(/\D/g, "")
                .replace(/\B(?=(\d{3})+(?!\d)\.?)/g, ".")
                ;
        });
    })
    $('#TransferPay').on('keyup', function (event) {
        if (event.which >= 37 && event.which <= 40) {
            event.preventDefault();
        }

        $(this).val(function (index, value) {
            return value
                .replace(/\D/g, "")
                .replace(/\B(?=(\d{3})+(?!\d)\.?)/g, ".")
                ;
        });
    })
    $('#txtSearchControl').keyup(function (event) {
        //if ($("#txtSearchControl").val() == "") {
        //    GetPageData(1);
        //}
        if (window.event.keyCode == 13 || window.event.which == 13 || $("#txtSearchControl").val() == "") {
            event.preventDefault();
            GetPageData(1);
            HideLoading();
        }
    });
    $('#iconSearch').click(function (event) {
        GetPageData(1);
        HideLoading();
    });

</script>
<script>
    function isNull(number) {
        if (number == null || number == undefined || number == "") {
            return 1;
        }
        return 0;
    };
    $("#btnCheckBar").click(function () {
        $("#btnCheckBar").removeClass('classBlock').addClass("classHidden");
        $("#inpBarcode").removeClass('classBlock').addClass("classHidden");

        $("#btnCheckKey").removeClass('classHidden').addClass("classBlock");

        var thisSearch = document.getElementById("idboxsearch1");
        thisSearch.style.display = "block";
    });
    $("#btnCheckKey").click(function () {
        $("#btnCheckKey").removeClass('classBlock').addClass("classHidden");
        $("#btnCheckBar").removeClass('classHidden').addClass("classBlock");

        $("#inpBarcode").removeClass('classHidden').addClass("classBlock");
        var thisSearch = document.getElementById("idboxsearch1");
        thisSearch.style.display = "none";
    });
</script>

<script>
    //   <---  1. Event: double click       --->
    function Step1(isTab, this1) {
        $("#NameTab" + isTab).css('display', 'block');
        if (isTab == 1) { $('#TabA1').css('opacity', '0'); }
        else {
            $("#tab" + isTab + isTab).css('opacity', '0');
        }
        this1.closest('li').find('#NameTab' + isTab).focus();
    }
    //  <---   2. Event Change NameTab Input  --->
    function Step2(isTab) {
        if (isNull($('#NameTab' + isTab).val()) == 0) {
            if (isTab == 1) { $('#TabA1').html($('#NameTab1').val()); }
            else {
                $('#tab' + isTab + isTab).html($('#NameTab' + isTab).val());
            }
        }
    }
    //  <---   3. Focus out: Hidden tag Input  --->
    function Step3(isTab) {
        $("#NameTab" + isTab).css('display', 'none');
        if (isTab == 1) { $("#TabA" + isTab).css('opacity', '1'); }
        else {
            $("#tab" + isTab + isTab).css('opacity', '1');
        }
    }
    $('#tab11').dblclick(function () { Step1(1, $(this)); });
    $('#tab222').dblclick(function () { Step1(2, $(this)); });
    $('#tab333').dblclick(function () { Step1(3, $(this)); });
    $('#tab444').dblclick(function () { Step1(4, $(this)); });
    $('#tab555').dblclick(function () { Step1(5, $(this)); });
    $('#tab666').dblclick(function () { Step1(6, $(this)); });

    $('#NameTab1').keyup(function () { Step2(1); });
    $('#NameTab2').keyup(function () { Step2(2); });
    $('#NameTab3').keyup(function () { Step2(3); });
    $('#NameTab4').keyup(function () { Step2(4); });
    $('#NameTab5').keyup(function () { Step2(5); });
    $('#NameTab6').keyup(function () { Step2(6); });

    $('#NameTab1').focusout(function () { Step3(1); });
    $('#NameTab2').focusout(function () { Step3(2); });
    $('#NameTab3').focusout(function () { Step3(3); });
    $('#NameTab4').focusout(function () { Step3(4); });
    $('#NameTab5').focusout(function () { Step3(5); });
    $('#NameTab6').focusout(function () { Step3(6); });

    $('#tab11').dblclick(function () {
        $('#NameTab1').css('display', 'block');
        $('#TabA1').css('opacity', '0');
        $(this).closest('li').find('#NameTab1').focus();
    });

</script>
<script>
    function ChangeTable(isTab) {
        var totalTab = 0;
        var tbl = "#tbllistOrderDetail" + isTab + " TBODY TR";
        $(tbl).each(function () {
            totalTab += parseInt($(this).closest('tr').find("td:eq(2) input").val());
        });
        if (totalTab != 0) {
            $("#TotalProduct" + isTab).html(totalTab);
        }
        else {
            $("#TotalProduct" + isTab).html("");
        }
        if ($("#TotalProduct" + isTab).html() == 0) {
            removeData(isTab);
        }
    }
    $("#tbllistOrderDetail1").on('change', function () {
        ChangeTable(1);
    });
    $("#tbllistOrderDetail2").on('change', function () {
        ChangeTable(2);
    });
    $("#tbllistOrderDetail3").on('change', function () {
        ChangeTable(3);
    });
    $("#tbllistOrderDetail4").on('change', function () {
        ChangeTable(4);
    });
    $("#tbllistOrderDetail5").on('change', function () {
        ChangeTable(5);
    });
    $("#tbllistOrderDetail6").on('change', function () {
        ChangeTable(6);
    });

    function HiddenTotalProductTab(isTab) {
        var i;
        for (i = 1; i <= 6; i++) {
            $("#TotalProduct" + i).css("display", 'none');
        }
        $("#TotalProduct" + isTab).css("display", 'block');
    };
    function removeDiscount(isTab) {
        $('#CustomerId' + isTab).val("");
        $('#CustomerName' + isTab).val("");
        $('#Tab' + isTab + 'Discount').val("");
        $('#Tab' + isTab + isTab + 'Discount').val("");
        $('#DiscountTab1').val("");
    }
</script>
<script>

    function NVLSTN(p1) {
        if (p1 == null || p1 == "") {
            return 0;
        } else {
            return parseFloat(p1);
        }

    }

    $("#MoneyPay").keyup(function () {
        //debugger
        //alert("vao day khong");
        var isTab = checkTab();
        //xử lý số tiền nhận từ customer
        var TotalPaya = removeComma($("#TotalPay").val());
        var pricus = removeComma($("#MoneyPay").val());
        var check = $("#CheckPay").val();
        //alert(check);
        //check=0 la mo, =1 la dong
        if ((parseFloat(pricus) > parseFloat(TotalPaya)) && (check == "0")) {
            //debugger
            $("#MoneyPay").val(numeral(TotalPaya).format('0,0'));
            $("#ATMPay").val("");
            $("#TransferPay").val("");
            $("#ChangeMoney").val("");

            $("#Transfer" + isTab).val("");
            $("#ATM" + isTab).val("");


            pricus = removeComma($("#MoneyPay").val());
        }



        $("#Money" + isTab).val(removeComma(pricus));
        var Transfer = removeComma($("#TransferPay").val());
        var ATM = removeComma($("#ATMPay").val());
        if ((Transfer == "") && (check == "0")) {
            $("#ATMPay").val(numeral(parseFloat(removeComma($("#TotalPay").val())) - parseFloat(pricus)).format('0,0'));
            ATM = removeComma($("#ATMPay").val());
        }
        $("#ATM" + isTab).val(removeComma(ATM));
        var aa = removeComma(TotalPaya);
        var number = pricus * 1 + ATM * 1 + Transfer * 1;
        var totalcus1 = number - aa;
        $("#ChangeMoney").val(' ' + numeral(totalcus1).format('0,0'));
        //console.log(pricus - total);
    });
    $("#TransferPay").keyup(function () {
        var isTab = checkTab();
        // alert("vao day khong");
        //xử lý số tiền nhận từ customer
        var TotalPaya = removeComma($("#TotalPay").val());
        var Transfer = removeComma($("#TransferPay").val());
        var ATM1 = removeComma($("#ATMPay").val());
        var pricus1 = removeComma($("#MoneyPay").val());
        if ((NVLSTN(Transfer) + NVLSTN(ATM1) + NVLSTN(pricus1)) > parseFloat(TotalPaya)) {
            //debugger
            $("#TransferPay").val(numeral(TotalPaya).format('0,0'));
            $("#ATMPay").val("");
            $("#MoneyPay").val("");
            $("#ChangeMoney").val("");

            $("#Money" + isTab).val("");
            $("#ATM" + isTab).val("");

            Transfer = removeComma($("#TransferPay").val());
        }



        var pricus = removeComma($("#MoneyPay").val());

        $("#Transfer" + isTab).val(removeComma(Transfer));
        var ATM = removeComma($("#ATMPay").val());
        var number = pricus * 1 + ATM * 1 + Transfer * 1;
        var aa = removeComma(TotalPaya);
        var totalcus1 = number - aa;
        $("#ChangeMoney").val(' ' + numeral(totalcus1).format('0,0'));
        //console.log(pricus - total);
    });
    $("#ATMPay").keyup(function () {
        //debugger
        var isTab = checkTab();
        // alert("vao day khong");
        //xử lý số tiền nhận từ customer
        var TotalPaya = removeComma($("#TotalPay").val());
        var ATM = removeComma($("#ATMPay").val());
        var pricus1 = removeComma($("#MoneyPay").val());
        var Transfer1 = removeComma($("#TransferPay").val());
        if ((NVLSTN(pricus1) + NVLSTN(Transfer1) + NVLSTN(ATM)) > parseFloat(TotalPaya)) {
            //debugger
            if (NVLSTN(ATM) > parseFloat(TotalPaya)) {
                $("#ATMPay").val(numeral(TotalPaya).format('0,0'));
                $("#TransferPay").val("");
                $("#MoneyPay").val("");
                $("#ChangeMoney").val("");

                $("#Money" + isTab).val("");
                $("#Transfer" + isTab).val("");

                ATM = removeComma($("#ATMPay").val());

            } else if ((NVLSTN(pricus1) + NVLSTN(ATM)) > parseFloat(TotalPaya)) {
                $("#ATMPay").val(numeral(parseFloat(TotalPaya) - NVLSTN(pricus1)).format('0,0'));
                $("#TransferPay").val("");
                $("#ChangeMoney").val("");
                ATM = removeComma($("#ATMPay").val());
            }
            else if ((NVLSTN(pricus1) + NVLSTN(ATM)) <= parseFloat(TotalPaya)) {
                $("#TransferPay").val(numeral(parseFloat(TotalPaya) - (NVLSTN(pricus1) + NVLSTN(ATM))).format('0,0'));
                $("#ChangeMoney").val("");
            }

        }

        //debugger
        var check = $("#CheckPay").val();
        var pricus = removeComma($("#MoneyPay").val());
        var Transfer = removeComma($("#TransferPay").val());

        $("#ATM" + isTab).val(removeComma(ATM));
        var tienthoi = NVLSTN(TotalPaya) - (NVLSTN(ATM) + NVLSTN(pricus));
        if ((NVLSTN(tienthoi) > 0) && (check == "0")) {
            $("#TransferPay").val(numeral(parseFloat(tienthoi)).format('0,0'));
            $("#Transfer" + isTab).val(parseFloat(tienthoi));
            $("#ChangeMoney").val("");
        } else if ((NVLSTN(tienthoi) < 0) && (check == "0")) {
            $("#TransferPay").val(numeral(NVLSTN(TotalPaya) - NVLSTN(ATM)).format('0,0'));
            $("#Transfer" + isTab).val(NVLSTN(TotalPaya) - NVLSTN(ATM));
            $("#ChangeMoney").val("");
        }
        else if ((NVLSTN(tienthoi) == 0) && (check == "0")) {
            $("#TransferPay").val(0);
            $("#Transfer" + isTab).val(0);
            $("#ChangeMoney").val("");
        }

        //console.log(pricus - total);
    });
    $("#noteHD").keyup(function () {
        //alert("vao day khong");
        var isTab = checkTab();
        var noteHD1 = $("#noteHD").val();
        $("#noteHD" + isTab).val(noteHD1);
    });


    $('#DiscountAll').keyup(function () {
        //alert("vao day khong");em day
        //debugger
        var isTab = checkTab();
        var discountalltab = $('#DiscountAll').val();
        discountalltab = removeComma(discountalltab);
        $('#DiscountAll' + isTab).val(discountalltab);
        var sumas = $('#TotalAmount1').val();
        sumas = removeComma(sumas);
        var kkk = $("#isDiscountAll" + isTab).val();
        if (kkk == 0) {
            var sumass = sumas - discountalltab;
            $("#TotalPay").val(numeral(sumass).format('0,0'));
            $("#MoneyPay").val(numeral(sumass).format('0,0'));
            $('#Money' + isTab).val(discountalltab);

            $("#ATMPay").val(""); //Tổng
            $("#TransferPay").val(""); //Tổng
            $("#ATM" + isTab).val("");
            $("#Transfer" + isTab).val("");
            $("#ChangeMoney").val("");



        } else {
            var sumass = sumas - ((discountalltab * sumas) / 100);
            $("#TotalPay").val(numeral(sumass).format('0,0'));
            $("#MoneyPay").val(numeral(sumass).format('0,0'));
            $('#Money' + isTab).val(discountalltab);

            $("#ATMPay").val(""); //Tổng
            $("#TransferPay").val(""); //Tổng
            $("#ATM" + isTab).val("");
            $("#Transfer" + isTab).val("");
            $("#ChangeMoney").val("");
        }
    });
    function getData(isTab) {
        //alert("vao day khong");
        var thisTab1Money = $("#Tab" + isTab + "Money").val();  //Tiền hàng Tab1
        var thisTab1Total = $("#Tab" + isTab + "Total").val();  // Thanh toán Tab1
        var thisTab1Discount = $("#Tab" + isTab + isTab + "Discount").val(); //Giảm Tab1
        var thisCustomerName1 = $("#CustomerName" + isTab).val();
        var thisMoney1 = $("#Money" + isTab).val();     //Tiền mặt tab1
        var thisTransfer1 = $("#Transfer" + isTab).val();   //Chuyển khoản tab1
        var thisATM1 = $("#ATM" + isTab).val();     //ATM tab1
        var DiscAll1 = $("#DiscountAll" + isTab).val(); //Tổng giảm đặc biệt
        var noteHDt1 = $("#noteHD" + isTab).val();  //ghi chú
        $("#noteHD").val(noteHDt1);
        $("#DiscountAll").val(DiscAll1);
        $("#TotalAmountPay").val(thisTab1Money);    //Tiền hàng = Tổng = xanh lá
        $("#TotalAmountTab1").val(thisTab1Money);   //            Tổng = xanh lá
        $("#DiscountTab1").val(thisTab1Discount);   //Giảm giá tab1
        $("#TotalAmount1").val(numeral(thisTab1Total).format('0,0'));   //Thanh toán trái = xanh dương
        $("#idboxsearch2").val(thisCustomerName1);
        $("#TotalPay").val(numeral(thisTab1Total).format('0,0'));       //Thanh toán phải = xanh dương
        $("#MoneyPay").val(numeral(thisMoney1).format('0,0'));
        $("#TransferPay").val(numeral(thisTransfer1).format('0,0'));
        $("#ATMPay").val(numeral(thisATM1).format('0,0'));

        var number = thisMoney1 * 1 + thisATM1 * 1 + thisTransfer1 * 1;
        var totalcus1 = number - thisTab1Total;
        $("#ChangeMoney").val(' ' + numeral(totalcus1).format('0,0'));
    }


</script>
<script src="~/Scripts/area_sale/product_invoiceNT.js?v=1.0001"></script>

<link href="/Scripts/RadCombobox_v1/RadComboBoxLite.css" rel="stylesheet" />
<script src="/Scripts/RadCombobox_v1/rabCombobox.js"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
<link href="/assets/css/bootstrap2-toggle.min.css" rel="stylesheet" />


@section Scripts {

    @Html.ScriptBottom_ValidationMvc()
    @Html.ScriptBottom_ChosenStyle()
    @Html.ScriptBottom_DatePicker("dd/MM/yyyy")
}

