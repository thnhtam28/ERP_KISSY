@using Erp.BackOffice.App_GlobalResources
@using Erp.BackOffice.Sale.Models
@using Erp.BackOffice.Helpers
@model List<Sale_BaoCaoNhapXuatTonViewModel>
@{
    Layout = null;
    int index = 1;
    var setting = Erp.BackOffice.Helpers.Common.GetSetting("hiden_solo_handung");
    var setting2 = Erp.BackOffice.Helpers.Common.GetSetting("hiden_gianhap");
}
<link href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<style>
    .display_none {
        display: none;
    }

    #cTable_wrapper {
        background-color: #eff3f8 !important;
        margin-top: 1%;
    }
</style>
<div class="width-100 margin-bottom-10" style="width:100%; margin-top: 1%;margin-left: 0.2%">
    <div class="infobox infobox-blue" style="width:15%">
        <div class="infobox-icon">
            <i class="ace-icon fa fa-dollar"></i>
        </div>
        <div class="infobox-data">
            <span class="infobox-data-number ng-binding">@(Common.PhanCachHangNgan(Model.Sum(x => x.First_Remain)))</span>
            <div class="infobox-content ng-binding">
                Tồn đầu kỳ

            </div>
        </div>
    </div>
    <div class="infobox infobox-blue" style="width:15%">
        <div class="infobox-icon">
            <i class="ace-icon fa fa-dollar"></i>
        </div>
        <div class="infobox-data">
            <span class="infobox-data-number ng-binding">@(Common.PhanCachHangNgan(Model.Sum(x => x.Last_InboundQuantity)))</span>
            <div class="infobox-content ng-binding">
                SL Nhập

            </div>
        </div>
    </div>
    <!-- ngIf: reportTypeModel.type != 4 --><div class="infobox infobox-blue ng-scope" data-ng-if="reportTypeModel.type != 4" style="width:15%">
        <div class="infobox-icon">
            <i class="ace-icon fa fa-shopping-cart"></i>
        </div>
        <div class="infobox-data">
            <span class="infobox-data-number ng-binding">@(Common.PhanCachHangNgan(Model.Sum(x => x.Last_OutboundQuantity)))</span>
            <div class="infobox-content ng-binding"> SL Xuất </div>
        </div>
    </div><!-- end ngIf: reportTypeModel.type != 4 -->
    <!-- ngIf: reportTypeModel.type == 4 -->
    <div class="infobox infobox-orange" style="width:15%">
        <div class="infobox-icon">
            <i class="ace-icon fa fa-dollar"></i>
        </div>
        <div class="infobox-data">
            <span class="infobox-data-number ng-binding">@(Common.PhanCachHangNgan(Model.Sum(x => x.Remain)))</span>
            <div class="infobox-content ng-binding">Tồn cuối kỳ</div>
        </div>
    </div>

    <!-- ngIf: reportTypeModel.type != 4 --><div class="infobox infobox-orange ng-scope" data-ng-if="reportTypeModel.type != 4" style="width:20%">
        <div class="infobox-icon">
            <i class="ace-icon fa fa-shopping-cart"></i>
        </div>
        <div class="infobox-data">
            <span class="infobox-data-number ng-binding">@(CommonSatic.ToCurrencyStr(Model.Sum(x => Math.Round(x.PriceInbound.Value * x.Remain.Value, 0)), null))</span>
            <div class="infobox-content ng-binding"> Tổng tiền tồn </div>
        </div>
    </div><!-- end ngIf: reportTypeModel.type != 4 -->
    <!-- ngIf: reportTypeModel.type == 4 -->
    <!-- ngIf: reportTypeModel.type == 5 && monthlyReport.totalDebt > 0 -->
</div>
<table id="cTable" class="table table-bordered table-striped" style="margin-top: 10px">
    <thead>
        <tr class="" style="display:none">
            <th class="" colspan="15" style="text-align:center"><h4>BÁO CÁO XUẤT KHO TỪ @ViewBag.StartDate ĐẾN @ViewBag.EndDate</h4></th>
        </tr>
        <tr>
            <th style="width:3%;text-align:center">STT</th>
            <th style="width:15%;text-align:center">Mã sản phẩm</th>
            <th style="width:15%;text-align:center">Tên sản phẩm</th>
            @*<th style="width:100px;text-align:center">Nhóm sản phẩm</th>
                <th style="width:100px;text-align:center">Nhà sản xuất</th>*@

            @if ((Common.CurrentUser.BranchId != null) && (Common.CurrentUser.BranchId > 0))
            {
                <th class="display_none" style="width:15%;text-align:center">Kho</th>
            }
            else
            {
                <th style="width:15%;text-align:center">Kho</th>
            }



            @if (setting == "true")
            {
                <th class="display_none" style="width:100px;text-align:center">Số Lô</th>
                <th class="display_none" style="width:100px;text-align:center">Hạn dùng</th>
            }
            else if (setting == "false")
            {
                <th style="width:100px;text-align:center">Số Lô</th>
                <th style="width:100px;text-align:center">Hạn dùng</th>
            }
            @if (setting2 == "true")
            {
                <th class="display_none" style="width:100px;text-align:center">Đơn giá nhập</th>
                <th class="display_none" style="width:100px;text-align:center">Đơn giá xuất</th>

            }
            else if (setting2 == "false")
            {
                <th style="width:100px;text-align:center">Đơn giá nhập</th>
                <th style="width:100px;text-align:center">Đơn giá xuất</th>
            }

            <th style="width:100px;text-align:center">Tồn đầu kỳ</th>
            <th style="width:100px;text-align:center">SL Nhập</th>
            <th style="width:100px;text-align:center">SL Xuất</th>
            <th style="width:100px;text-align:center">Tồn cuối kỳ</th>
            <th style="width:100px;text-align:center">Tổng tiền tồn</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model)
        {
            <tr class="@(index%2==0?"alert-warning":"")">
                <td>
                    <span>@(index++)</span>
                </td>
                <td>@(item.ProductCode)</td>
                <td>@(item.ProductName)</td>
                @if ((Common.CurrentUser.BranchId != null) && (Common.CurrentUser.BranchId > 0))
                {
                    <td class="display_none">@(item.WarehouseName)</td>
                }
                else
                {
                    <td>@(item.WarehouseName)</td>
                }
                @if (setting == "true")
                {
                    <td class="display_none">@(item.LoCode)</td>
                    <td class="display_none">@(item.ExpiryDate == null ? "" : item.ExpiryDate.Value.ToString("dd/MM/yyyy"))</td>

                }
                else if (setting == "false")
                {
                    <td>@(item.LoCode)</td>
                    <td>@(item.ExpiryDate == null ? "" : item.ExpiryDate.Value.ToString("dd/MM/yyyy"))</td>
                }

                @if (setting2 == "true")
                {
                    <td class="display_none" style="text-align:right">@(CommonSatic.ToCurrencyStr(item.PriceInbound, "Price"))</td>
                    <td class="display_none">@(CommonSatic.ToCurrencyStr(item.PriceOutbound, null))</td>

                }
                else if (setting2 == "false")
                {
                    <td style="text-align:right">@(CommonSatic.ToCurrencyStr(item.PriceInbound, "Price"))</td>
                    <td style="text-align:right">@(CommonSatic.ToCurrencyStr(item.PriceOutbound, null))</td>
                }

                <td style="text-align:right">@(Common.PhanCachHangNgan(item.First_Remain))</td>
                <td style="text-align:right">@(Common.PhanCachHangNgan(item.Last_InboundQuantity))</td>
                <td style="text-align:right">@(Common.PhanCachHangNgan(item.Last_OutboundQuantity))</td>
                <td style="text-align:right">@(Common.PhanCachHangNgan(item.Remain))</td>
                <td style="text-align:right">@(CommonSatic.ToCurrencyStr(Math.Round(item.PriceInbound.Value * item.Remain.Value, 0), null))</td>
            </tr>
        }
    </tbody>

</table>
@*@if(ViewBag.Print=="True")
    {
    <script>
            window.print();
    </script>
    }*@
<script src="https://code.jquery.com/jquery-3.3.1.js"></script>
<script src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>



<script src="~/Scripts/jquery.floatThead.js"></script>

<script>
    $(document).ready(function () {
        $("#cTable").floatThead({ top: 30 });
    });
</script>
<script type="text/javascript">
    $(document).ready(function () {
        $('#cTable').DataTable({
            "pagingType": "full_numbers"
        });
    });
</script>
@section Scripts {
    @Html.ScriptBottom_ValidationMvc()
    @Html.ScriptBottom_DatePicker("dd/MM/yyyy")
}
